	    /*
    CODE BY Krishna Chandhu B
    DATE 25-MAR-2021
*/
	    var BranchArr = [];
	    var collectionKendraData = [];
	    var parDisplayColData = [];
	    var RepeatCollectionData = [];
	    var isCollectionFlowEnable = true;
	    var isDateSelected = false;
	    var selectedDefaultDay = '';
	    var selectedDefaultDate = '';
	    var backSearchFunc = false;
	    var userRoleassigned = false;
	    var QRTimerSetVal = 0;
	    var QRRefreshTimer = 0;
	    var disbData = {};
	    var doneReject;
	    var BankFacScrId = 'BnkFac__BankingFacilities__';
	    var isFromKMDashboardLoan = false;
	    var RepeatCollecFlag = "";
	    var isBankDetailsUpdated=false;
	    var isConfirmCbCheck = false;
	    var isCollectionDeo = false;
	    var isCollectionCustomerDeo = false;
	    var isCollectionCustomerdataDeo = false;
	    var viewCustomerFlag = false;
	    var viewCustomerFlagKmdashboard = false;
	    var viewCustomerFlagGroupsData = false;
		var isCustomerDetailEdit = false;
	    /*window.languageCallCount = 0;
	    window.Address = "";
	    window.langArr = [];
	    window.gAppId = apz.appId;
	    window.dontPaint = true;
	    window.gDocumentTexts = '';
	    window.onApplicationLoad = true;
	    window.dontReloadRC = false;
	    window.recurringDepEnabled = 'N';
	    /**
	     * @author praisy.b
	     * @since 04.06.21
	     * Added fix for below issue
	     * No mobile number validation
	     **/
	    window.APP_VERSION = "V1.1.51.9";
	    var gPageNavHist;
	    window.isNwAvailable = true;
	    window.RpcOnHoldBacknavigation = false;
	    window.fromGlobalSearch = false;
	    window.istrueyes = true;
	    var pageInputCSSClass = ".dev-page-input input";
	    window.pageNo = '1';
	    window.CardSuccessModalTriggered = false;
	    var isdone = 1;
	    window.isLoanCreateFromCalculator=false;
	    window.isCalcToFAB = false;
		window.isCalcNewLoan = false;
		window.isBackToCalculation = false;
		window.isCalcFromCustToLoanInput = false;
	    window.isDraft = false;
	    window.isDraftFromAllLoan = false;
	    window.isDraftFromNewLoan = false;
	    window.isDraftStage1 = false;
	    window.isDraftStage2 = false;
	    window.isgetIncome = false;
	    window.isgetIncomeData = '';
	    window.isDraftBackNavigation = false;
	    window.SelectedCardThemeName = "";
	    window.LoadWidgetsForIOS = false;
	    window.PaintJointAccountForIOS = false;
		isAddLoanToKendraDtls = false;
		isKendraDtlsToAddLoan = false;
		isCustomerDtlsToKendraDtls = false;
		isKendraDtlsToCustomerDtls = false;
		selectedKendraFromMyKendra='';
		isFetchingKendraDetails = false
		isApplyingLoanFromKendraDetails = false
		isViewCustomerFromKendraDetails = false
		isKendraDtlsLaunchedFromDashboard = false
	    window.applicationResp = "";
	    var itsobject = [];
	    window.itssearchrc = false;
	    window.itscards = false;
	    window.isUpdateIncome = false;
	    window.reIncomeAssessment = false;
	    window.houseHoldDetails = '';
	    window.rejectIncome = false;
	    window.ResetLOVNAMES = false;
	    var slectedProductsArr = [];
	    window.itssearch = false;
	    var BaseDivId = 'div[id^= "';
	    var formatdate = [];
	    var collectionsRes = [];
	    var customerNames = ''
	    window.recurringDepEnabled = 'N';
	    window.firstLang = "";
	    window.loanProduct = "";
	    window.LoggedInUserDetails = "";
	    var currencyremove = [];
	    window.AmountFormatParams = "";
	    window.gDocumentTexts = '';
	    window.Transpayload = {};
	    window.langArr = [];
	    window.subRole = "";
	    window.gAppId = apz.appId;
	    window.WidgetConf = "";
	    window.createapplnworkflowConf = "";
	    window.FetchRole = [];
	    window.existingAccount = false;
	    window.changeSubProduct = false;
	    window.updateNumber = false;
	    window.allocate = false;
	    window.selectedKendraData = [];
	    window.CRTworkflow;
	    window.customerMobNum;
	    window.auditDtls = [];
	    apz.data.scrdata.CardSe__IpaintFileUpload_Res = {};
	    window.DepositSubProductCode = '';
	    window.DepositSubProductCodeName = '';
	    window.versionNum = 'V1.1.51.9';
	    window.cardsno = 0;
	    window.selectedDashboProduct = '';
            window.auditTrialData='';
	    window.PinCodeToggle = false;
	    window.KendraApp = {};
	    window.cbApproveManual;
	    window.crtRejectKM;
	    window.KendraLovs = {};
	    window.IncomeApp = {};
	    IncomeApp.isPendingTask = false;
	    window.KendraLoans = {};
	    window.KendraLoans.editRejected=false;
	    window.KendraApp.amountUpdate=false;
	    window.mobileNoUpdateAtDisbursement=false;
	    window.KendraApp.AppCreateResObj = {};
	    window.approve = false;
	    window.reject = false;
	    KendraApp.crtLoanSaveReq = {}
	    KendraApp.crtObj = {}
	    window.SelectKendraFromFabBtn = false;
	    window.loansanctionList = [];
	    window.disbursementList = [];
	    window.dashboardAppList = [];
	    window.srList = [];
	    window.custFetchLoanAppRes = [];
	    window.currentApp = {};
	    var cbResponse = '';
	    var selectedDataFromDashboardSearch = '';
	    var selectedDataFromLoanDisbursementList = '';
	    var selectedPreclosureApplyLoan = false;
	    var customselectedPreclosureApplyLoan = false;
	    var selectedPreclosureBMSanc = false;
	    var selectedPreclosureBMFinal = false;
	    var selectedCrtUpdate = false;
	    var selectAllActiveLoans = false;
	    var rpcLoanapplication = false;
	    var selectedPreclosureKMInit = false;
	    var selectSameLoanBeforeBMSanc = false;
	    var isbulkUploadDocu = false;
	    var reportName = "";
	    var viewDisbursemetCustData='';
	    var elDisbursementCustData ={};
	    window.isViewCustFromDisbursemet = false;
	    window.newLoan = false;
	    window.isSelfAssigned = false;
	    window.isSingleKendra = false;
	    window.appActivityCnt=0;
	    KendraApp.KendraList = [];
	    var selectedAppList = [];
	    KendraApp.isNetworkAvailable = true;
	    window.iseditCBsuccess=false;
	    window.isDraftStage1=false;
            window.isDraftStage2=false;
	    var WidgetInProgress = [],
	        Widget = [],
	        WidgetSubmitted = [],
	        WidgetDeleted = [],
	        WidgetRejected = [],
	        WidgetApproved = [],
	        WidgetPending = [];
	    var UpfrontCharges = [{
	        "LoanAmount": 1000,
	        "Term": "Weekly",
	        "interest_Fee": 22.1,
	        "upfrontFee": 28
	    }, {
	        "LoanAmount": 1000,
	        "Term": "Biweekly",
	        "interest_Fee": 27.1,
	        "upfrontFee": 33
	    }, {
	        "LoanAmount": 2000,
	        "Term": "Weekly",
	        "interest_Fee": 79.2,
	        "upfrontFee": 91
	    }, {
	        "LoanAmount": 2000,
	        "Term": "Biweekly",
	        "interest_Fee": 89.2,
	        "upfrontFee": 101
	    }];
	    window.isMobErr = false;
	    window.gIsMinMaxErr = false;
	    window.resendSMSFlag = false;
	    window.userSelectedDate = "";
	    window.userSelectedDay = "";
	    window.userclickback = false;
	    var userRoleIfDeoAvailable = "";
	    window.isApprovedCRT = false;
	    window.isloanOTP = true;
	    window.isSkipOTP = false;
	    window.userSkipedOTP = false;
	    window.bmApprovalLaunchTrough = 'myActivity';
	    window.LOV_LIST = {
	        'nomineeReation': [{
	            "val": "114",
	            "desc": "Spouse"
	        }, {
	            "val": "112",
	            "desc": "Son"
	        }, {
	            "val": "103",
	            "desc": "Daughter"
	        }, {
	            "val": "105",
	            "desc": "Father"
	        }, {
	            "val": "108",
	            "desc": "Mother"
	        }, {
	            "val": "106",
	            "desc": "Father-In-law"
	        }, {
	            "val": "109",
	            "desc": "Mother-in-Law"
	        }, {
	            "val": "113",
	            "desc": "Son in Law"
	        }, {
	            "val": "104",
	            "desc": "Daughter In law"
	        }, {
	            "val": "102",
	            "desc": "CHILD"
	        }, {
	            "val": "101",
	            "desc": "Brother"
	        }, {
	            "val": "111",
	            "desc": "Sister"
	        }, {
	            "val": "100",
	            "desc": "Aunt"
	        }, {
	            "val": "115",
	            "desc": "Uncle"
	        }, {
	            "val": "110",
	            "desc": "Others"
	        }]
	    };
	    window.PERIOD_LOOKUP = {
	        'D': 'Daily',
	        'W': 'Weekly',
	        'M': 'Monthly',
	        'Q': 'Quarterly',
	        'H': 'Half yearly',
	        'Y': 'Yearly'
	    };
	    window.KendraDays = {
	        'MON': 'Monday',
	        'TUE': 'Tuesday',
	        'WED': 'Wednesday',
	        'THU': 'Thrusday',
	        'FRI': 'Friday',
	        'SAT': 'Saturday',
	        'SUN': 'Sunday'
	    }
	    window.KendraDaysmap = {
	        'Monday': 1,
	        'Tuesday': 2,
	        'Wednesday': 3,
	        'Thrusday': 4,
	        'Friday': 5,
	        'Saturday': 6,
	        'Sunday': 7
	    }
	   window.StageName = [{
	        stageId: 1,
	        stageName: 'DRAFT APPLICATION'
	    }, {
	        stageId: 2,
	        stageName: 'RPC VERIFICATION PENDING'
	    }, {
	        stageId: 3,
	        stageName: 'CB PENDING'
	    }, {
	        stageId: 4,
	        stageName: 'CRT PENDING'
	    },{
	        stageId: 5,
	        stageName: 'CB PASS'
	    },{
	        stageId: 6,
	        stageName: 'REJECTED POST CB'
	    },{
	        stageId: 7,
	        stageName: 'CRT REJECTION'
	    },{
	        stageId: 8,
	        stageName: 'PENDING SANCTION'
	    },{
	        stageId: 9,
	        stageName: 'CRT APPROVED â€“ PENDING SANCTION'
	    },{
	        stageId: 10,
	        stageName: 'SANCTION REJECTED'
	    },{
	        stageId: 11,
	        stageName: 'RECOMMENDED FOR SANCTION'
	    },{
	        stageId: 12,
	        stageName: 'RECOMMENDATION REJECTED'
	    },{
	        stageId: 13,
	        stageName: 'PENDING DISBURSEMENT'
	    },{
	        stageId: 14,
	        stageName: 'DISBURSEMENT REJECTED-KM'
	    },{
	        stageId: 15,
	        stageName: 'DISBURSEMENT APPROVAL PENDING'
	    },{
	        stageId: 16,
	        stageName: 'DISBURSEMENT APPROVAL REJECTED'
	    },{
	        stageId: 17,
	        stageName: 'DISBURSED'
	    },{
	        stageId: 18,
	        stageName: 'CANCELED BY SCHEDULER'
	    },{
	        stageId: 19,
	        stageName: 'REJECTED (DRAFT)'
	    }];
	    window.businessDays = [{
	        "dayNo": 1,
	        "dayDesc": "Monday",
	        "dayShort": "MON"
	    }, {
	        "dayNo": 2,
	        "dayDesc": "Tuesday",
	        "dayShort": "TUE"
	    }, {
	        "dayNo": 3,
	        "dayDesc": "Wednesday",
	        "dayShort": "WED"
	    }, {
	        "dayNo": 4,
	        "dayDesc": "Thursday",
	        "dayShort": "THU"
	    }, {
	        "dayNo": 5,
	        "dayDesc": "Friday",
	        "dayShort": "FRI"
	    }];
	    window.PendingStatusRole = [{
	        "role1": "KM"
	    }, {
	        "role2": "BM"
	    }];
	    window.approvalMatrix=[];
	    window.approvalMatrixLocal = [{
	        "MinAmt": "0",
	        "MaxAmt": "75000",
	        "isRecommand": false,
	        "RecommandRole": "",
	        "SanctionRole": "BM"
	    }, {
	        "MinAmt": "75001",
	        "MaxAmt": "125000",
	        "isRecommand": true,
	        "RecommandRole": "BM",
	        "SanctionRole": "AM"
	    }, {
	        "MinAmt": "125001",
	        "MaxAmt": "1750000",
	        "isRecommand": true,
	        "RecommandRole": "BM~AM",
	        "SanctionRole": "RM~DM~ZM~SH"
	    }];
	    var selectedType = "";
	    var occupationType = [],
	        designation = [],
	        yrsExp = [],
	        curEmpyrs = [],
	        relations = [],
	        noOfyrs = [],
	        noOfmons = [],
	        gaction = '',
	        noOfLeaves = [],
	        addressType = [],
	        nameTitle = [],
	        tinType = [],
	        tinReason = [],
	        gender = [],
	        fileArr = [],
	        DepositProduct = [],
	        ColMeetingDate = '',
	        FetchMeetingDtRecord = '';
	    currMeetDateValues = '';
	    cashierPushBackReason = [],
	        meetingTypes = [];
	    demoMode = "",
	        workFlowConf = "";
	    var STAGES = "";
	    var kendraBackNavigationObj = {};
	    var gALLOWONLYNUM = /[^0-9]/g,
	        gALLOWDASHNUM = /[^0-9 -]/g,
	        gALPHANUMERIC = /[^a-zA-Z0-9]/g,
	        gALPHANUMERICSpace = /[^a-zA-Z0-9\d\-_\s]/g,
	        gALPHANUMERICVoter = /[^a-zA-Z0-9-/ ]/g,
	        gALLOWALPHA = /[^a-zA-Z ]/g,
	        gALLOWNUMBERDECIMALS = /^\d*\.?\d*$/,
	        gALLOWFORADDRESS = /[^a-zA-Z0-9 /#.-]/g,
	        gALLOWFORNAME = /[^a-zA-Z .]/g,
	        gALLOWFORSEARCH = /[^a-zA-Z0-9]/g,
	        gALLOWFORNAMEEMP = /[^a-zA-Z .-]/g,
	        gALLOWONLYDOORNUM = /[^0-9 /-]/g,
	        gALLOWONLYDOB = /[^0-9,"/"]/g,
	        gBaseScreenDiv = gAppId + "__BaseScreens__launchRow",
	        gMonthArr = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
	        gCountries = "",
	        gBanks = [],
	        newHeight = "",
	        pinCodeVerified = false,
	        gStates = "",
	        gCities = "",
	        gBranches = "",
	        gLovs = "",
	        fatcaDetBaseRow = 0,
	        fatcaDetSTAGENO = 0,
	        crsDetBaseRow = 0,
	        crsDetSTAGENO = 0,
	        States = [],
	        ActiveprogressBar = {
	            "width": "100%"
	        },
	        InactiveprogressBar = {
	            "width": "0%"
	        },
	        JointAccount = 'Joint Account',
	        ApplicationPDF = 'application/pdf',
	        ApplicationPDFbase64 = "data:application/pdf;base64,",
	        stateID = "BnkFac__BankingFacilities__state",
	        cityID = "BnkFac__BankingFacilities__city",
	        branchID = "BnkFac__BankingFacilities__branch",
	        Cities = [], //call ApzCOB.FetchCountries,FetchStates for assigning
	        Branches = [],
	        CommonCodes = [],
	        ConfigureScrJson = {},
	        GNUMREGEX = /[0-9]/,
	        GLOWERCASEREGEX = /[a-z]/,
	        GUPPERCASEREGEX = /[A-Z]/;
	    var isAppTokenSet = "N",
	        isAppTokenCounter = 0;
	    var NonMeetingCollectionInfoParams = {};
	    var viewCustomer = false;
	    var isexsitingApp = false;
	    window.accessType='L';
	    var collectionServerDate = '';
            var isCashierRoleAvailable = '';
	    window.KendraApp.userList=[];
	    window.KendraApp.isnotQualifyApp=false;
	    window.KendraApp.remarks='NA';
	    IncomeApp.isQuestionComplete=false;
	    window.deathIntimationInitatedRec = [];
	    var ApzCOB = function() {
	        // ApzCOB Function declaration
	    }
	    var appVersion = '';
	    ApzCOB = {
	        //set header for prelogin screens
	        moreScrsetHeader: function(litcode) {
	            $("input").attr("autocomplete", "off");
	            $("#" + gAppId + "__PreLogin_BaseScreen__moremenuheader").removeClass("sno");
	            $("#" + gAppId + "__PreLogin_BaseScreen__web_preLoginHeaderbackCol").removeClass("sno");
	            $("#" + gAppId + "__PreLogin_BaseScreen__loginheader").addClass("sno");
	            $("#" + gAppId + "__PreLogin_BaseScreen__hearderTxt").text(apz.lits[apz.currAppId][apz.language][litcode]);
	            ApzCOB.disableCutCopyPaste();
	        },
	        fnVersionCheck: function() {
	            var json = {};
	            json.id = "APP_UPDATE_ACTION";
	            json.action = "UPDATEACTION";
	            json.appId = gAppId;
	            json.callBack = ApzCOB.fnVersionCheckCallBack;
	            apz.ns.getUpdateAction(json);
	        },
	        fnVersionCheckCallBack: function(params) {
	            //console.log('params', params);
	            if (params.updateAction === "UPDATE") {
	                ApzCOB.fnDisplayMsg('Please Update the Unified App', "I", ApzCOB.ReloadApp);
	            } else {
	                //apz.startLoader();
	                ApzCOB.CommonCodeParams();
	                ApzCOB.MBbackPressedEvent();
	                apz.app.BaseScreens.contactus();
	                apz.app.BaseScreens.paintApplicatonTypes();
	                //ApzCOB.CommonCodeParams("syncPreLogin");
	            }
	        },
	        showStageNameOnHover: function(pthis) {
	            if ($('#btn_icon_icon-Menu').is(':visible')) {
	                $('#' + pthis.id).prop('title', $('#APZCBO__IpaintSideBarMenus__o__APZCBO__IpaintSideBarMenus_Res__stageName_' + (Number($(
	                    '#' + pthis.id).attr('rowno'))) + '_txtcnt').text());
	            } else {
	                $('#' + pthis.id).prop('title', '')
	            }
	            document.querySelectorAll('[role="log"]').forEach(function(e, i) {
	                document.querySelectorAll('[role="log"]')[i].classList.add("sno")
	            })
	        },
	        //set header for prelogin screens
	        moreScrsetFooterBtnText: function(litcode) {
	            $("#" + gAppId + "__PreLogin_BaseScreen__mob_footermainBtn", "#" + gAppId + "__PreLogin_BaseScreen__web_footerMainBtn").text(apz
	                .lits[apz.currAppId]
	                [apz.language][
	                    litcode
	                ]);
	        },
	        disableCutCopyPaste: function() {
	            $(document).ready(function() {
	                $('input').bind("cut copy paste", function(e) {
	                    if (e.currentTarget.id !== "APZCBO__BaseScreens__searchInp") {
	                        e.preventDefault();
	                    }
	                });
	            });
	        },
	        ddmmyyyytoyyyymmdd: function(pdate) {
	            var initial = pdate.split(/\//);
	            if (initial[1].length == 1) {
	                initial[1] = '0' + initial[1];
	            }
	            var formatted = [initial[2], initial[1], initial[0]].join('-');
	            //console.log([initial[2], initial[1], initial[0]].join('-'));
	            return formatted;
	        },
	        dateformatter: function(lDate, format, dateformat) {
	            switch (format) {
	                case "d M y": //// converts 12 Oct 18
	                    return new Date(lDate).format('d M y');
	                case "d M'y": //// converts 12 Oct'18
	                    return new Date(lDate).format("d M'y");
	                case "d-M-y": //// converts 12-Oct-18
	                    return new Date(lDate).format('d-M-y');
	                case "d/M/y": //// converts 12/Oct/18
	                    return new Date(lDate).format('d/M/y');
	                case "d M Y": //// converts 12 Oct 2018
	                    return new Date(lDate).format('d M Y');
	                case "d-M-Y": //// converts 12-Oct-2018
	                    return new Date(lDate).format('d-M-Y');
	                case "d-m-Y": //// converts 12-08-2018
	                    return new Date(lDate).format('d-m-Y');
	                case "d/m/Y": //// converts 12/08/2018
	                    return new Date(lDate).format('d/m/Y');
	                case "d/M/Y": //// converts 12/Oct/2018
	                    return new Date(lDate).format('d/M/Y');
	                case "Y-m-d": //// converts  2018-08-12
	                    return new Date(lDate).format('Y-m-d');
	                case "y-m-d": //// converts  18-08-31
	                    return new Date(lDate).format('y-m-d');
	                case "d-m-y": //// converts  31-08-18
	                    return new Date(lDate).format('d-m-y');
	                case "d M": //// converts  12 Oct
	                    return new Date(lDate).format('d M');
	                case "M Y": //// converts  Oct 2021
	                    return new Date(lDate).format('M Y');
	                case "m Y": //// converts  12 2021
	                    return new Date(lDate).format('m Y');
	                case "m": //// converts  12
	                    return new Date(lDate).format('m');
	                case "date":
	                    var pdateArr = lDate.split("  ").length > 1 ? lDate.split("  ") : lDate.split("T");
	                    var ldate = new Date(pdateArr[0]).format(dateformat);
	                    var ltime = pdateArr[1];
	                    return ldate + " " + ltime;
	                case "fullDate":
	                    window.fullDate = new Date().toLocaleDateString("en-IN", {
	                        year: "numeric",
	                        month: "short",
	                        day: "numeric",
	                        hour: "numeric",
	                        minute: "numeric",
	                        second: "numeric",
	                        hour12: false
	                    }).replace(/\s/g, ' ').replace('.', '').replace(',', ' ');
	                    return window.fullDate;
	                case "today":
	                    window.gTodayDate = new Date().toLocaleDateString("en-IN", {
	                        year: "numeric",
	                        month: "short",
	                        day: "numeric"
	                    }).replace(/\s/g, ' ').replace('.', '');
	                    return window.gTodayDate;
	                case "cardDate":
	                    var temp = lDate.split("-");
	                    var tempyear = temp[0].substr(-2);
	                    var tempmonth = temp[1];
	                    return tempmonth + " / " + tempyear;
	                default:
	                    return window.fullDate;
	            }
	        },
	        ageCalculator: function(lDOB) { //Calculate user Date.
	            var dob = new Date(Date.parse(lDOB));
	            //calculate month difference from current date in time
	            var month_diff = Date.now() - dob.getTime();
	            //convert the calculated difference in date format
	            var age_dt = new Date(month_diff);
	            var year = age_dt.getUTCFullYear();
	            return Math.abs(year - 1970);
	        },
	        getCurrentDate: function() {
	            var today = new Date();
	            var year = today.getFullYear();
	            var month = (today.getMonth() + 1).toString().padStart(2, '0'); // Month is 0-indexed
	            var day = today.getDate().toString().padStart(2, '0');
	            return `${year}${month}${day}`;
	        },
	        eligibleWeeks: function(custDob, type) {
	            // Convert YYYYMMDD to Date object
	            var currDate = ApzCOB.getCurrentDate()
	            var parseDate = (yyyymmdd) => new Date(yyyymmdd.substring(0, 4), // Year
	                yyyymmdd.substring(4, 6) - 1, // Month (0-based)
	                yyyymmdd.substring(6, 8) // Day
	            );
	            var d1 = parseDate(custDob);
	            var d2 = parseDate(currDate);
	            var diffTime = Math.abs(d2 - d1);
	            var diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
	            var daysInYear = 365.25;
	            var customerAgeinDays = '';
	            if (type === 'customer') {
	                customerAgeinDays = Math.floor(custAgeLimit * daysInYear);
	            } else {
	                customerAgeinDays = Math.floor(spouseAgeLimit * daysInYear);
	            }
	            var eligibleDays = customerAgeinDays - diffDays;
	            if (eligibleDays > 7) {
	                return eligibleDays / 7;
	            } else {
	                return 0;
	            }
	        },
	        //Validate if only Number
	        fnValidatenumbers: function(pthis) {
	            //pthis.value = ApzCOB.fn_unFormatAmount(pthis.value);
	            if (apz.isNull(pthis.value)) {
	                return;
	            }
	            /**
	             * Check if CustomAmt format enabled,
	             * If Yes, Format amount using common code configuration
	             * Else, Use default separator.
	             **/
	            if (gApzCOB.CustomAmountFormatEnabled === 'Y') {
	                var amtFormatCode = ApzCOB.GetCommonCodes("AMOUNTFORMAT").AMOUNTFORMAT;
	                /**
	                 * Check if decimal is included, and verify the index of Decimal separator,
	                 * If true, split by separator and replace values other than numbers,
	                 * Else replace all values other than numbers
	                 **/
	                if (amtFormatCode.includeDecimal === 'Y' && pthis.value.indexOf(amtFormatCode.decimalSeparator) > -1) {
	                    pthis.value = pthis.value.split(amtFormatCode.decimalSeparator)[0].replace(gALLOWONLYNUM, '');
	                } else {
	                    pthis.value = pthis.value.replace(gALLOWONLYNUM, '');
	                }
	            } else if (pthis.value.indexOf('.') > -1) {
	                pthis.value = pthis.value.split('.')[0].replace(gALLOWONLYNUM, '');
	            } else {
	                pthis.value = pthis.value.replace(gALLOWONLYNUM, '');
	            }
	        },
	        fnValidateDashnumbers: function(pthis) {
	            //pthis.value = ApzCOB.fn_unFormatAmount(pthis.value);
	            if (apz.isNull(pthis.value)) {
	                return;
	            }
	            pthis.value = pthis.value.replace(gALLOWDASHNUM, '');
	        },
	        fnValidatedecimalNum: function(pthis) {
	            var lastValid = document.getElementById(pthis.id).value;
	            if (!gALLOWNUMBERDECIMALS.test(pthis.value)) {
	                var a = lastValid.slice(0, -1);
	                console.log(a);
	                pthis.value = a;
	            }
	            var test = pthis.value.split('.');
	            if (test.length > 1) {
	                if (test[1].length >= 3) {
	                    var inValue = test[0] + '.' + test[1].substring(0, 2);
	                    pthis.value = inValue;
	                }
	            }
	        },
	        fntoUpperCase: function(pthis) {
	            if (/[a-z]/g.test(pthis.value.slice(-1))) {
	                pthis.value = pthis.value.slice(-1).replace(/[a-z]/g, pthis.value.toUpperCase())
	            }
	        },
	        //Launch the microApp
	        launchMicroApp: function(appId, screenId, currentDiv, obj) {
	            if (apz.deviceType !== 'WEB') {
	                apz.app.BaseScreens.UEdefineScreen('screenId');
	            }
	            //var AllowMicroApp = ApzCOB.getMicroAppScreensblockstatus(appId, screenId);
	            var AllowMicroApp = "Y";
	            if (AllowMicroApp === "N") {
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg(gApzCOB.blocklistmsg, "E");
	            } else {
	                var ArrKey = [],
	                    ArrVal = [];
	                /*if (screenId === "PreLogin_BaseScreen" || screenId === "PostLogin_BaseScreen") {
	                    ArrKey = ["appId", "scr", "div", "userObj"];
	                    ArrVal = [appId, screenId, currentDiv, obj];
	                } else {
	                    ArrKey = ["appId", "scr", "div", "userObj", "animation"];
	                    ArrVal = [appId, screenId, currentDiv, obj, window.gAnimationType];
	                }*/
	                ArrKey = ["appId", "scr", "div", "userObj"];
	                ArrVal = [appId, screenId, currentDiv, obj];
	                var params = ApzCOB.dynamicRequestGenerator(ArrKey, ArrVal);
	                $('#' + params.div).html('');
	                ApzCOB.commonLaunchFunction(params, "micro");
	            }
	        },
	        //Launch screen
	        launchScreen: function(screenId, obj) {
	            var ArrKey = ["scr", "userObj", "animation"],
	                ArrVal = [screenId, obj, window.gAnimationType],
	                params = ApzCOB.dynamicRequestGenerator(ArrKey, ArrVal);
	            ApzCOB.commonLaunchFunction(params, "screen");
	        },
	        //Launch subscreen
	        launchSubScreen: function(screenId, parentId, obj) {
	            var ArrKey = ["scr", "div", "userObj", "animation"],
	                ArrVal = [screenId, parentId, obj, window.gAnimationType],
	                params = ApzCOB.dynamicRequestGenerator(ArrKey, ArrVal);
	            ApzCOB.commonLaunchFunction(params, "subScreen");
	        },
	        //Common launch screen/microapp/subscreen
	        commonLaunchFunction: function(pRams, screenType) {
	            if (screenType === "micro") {
	                apz.launchApp(pRams);
	            } else if (screenType === "screen") {
	                apz.launchScreen(pRams);
	            } else if (screenType === "subScreen") {
	                apz.launchSubScreen(pRams);
	            }
	        },
	        setElementValueFunction: function(arrId, arrName) {
	            $.map(arrId, function(id, val) {
	                if ($("#" + id)[0].nodeName === "LABEL") {
	                    $("#" + id).text(arrName[val]);
	                } else {
	                    apz.setElmValue(id, arrName[val]);
	                }
	            });
	        },
	        // dynamicRequestGenerator
	        dynamicRequestGenerator: function(arrIds, arrValues) {
	            var temObj = {},
	                temp = {};
	            $.map(arrIds, function(id, val) {
	                temp[arrIds[val]] = arrValues[val];
	                $.extend(temObj, temp);
	            });
	            return temObj;
	        },
	        //auto complete - keyword search function
	        searchFunction: function(inputId, listId) {
	            var filter, ul, li, p, i;
	            filter = $(inputId).val().toUpperCase();
	            ul = $(listId + " ul");
	            li = ul[0].getElementsByTagName("li");
	            for (i = 0; i < li.length; i++) {
	                p = li[i].getElementsByTagName("p")[0];
	                if (p.innerHTML.toUpperCase().indexOf(filter) > -1) {
	                    li[i].style.display = "";
	                } else {
	                    li[i].style.display = "none";
	                }
	            }
	        },
	        formatAccountNumber: function(ac, n) {
	            var re = new RegExp("(.{" + n + "})", 'g');
	            return ac.length >= 5 ? ac.replace(/[^\dA-Z]/g, '').replace(re, '$1 ').trim() : ac;
	        },
	        formatPhoneNumber: function(ph, n) {
	            return ph.length >= n + 1 ? ph.slice(0, n) + ' ' + ph.slice(n, ph.length) : ph;
	        },
	        getNumberOfDaysInMonth: function(iMonth, iYear) {
	            return 32 - new Date(iYear, iMonth, 32).getDate();
	        },
	        formatInterval: function(maxvalue, loopVal, div) {
	            var divs = div;
	            var r = [];
	            var z = 0;
	            var i = 0;
	            if (maxvalue % 5 === 0) {
	                for (i = loopVal; i <= divs; i++) {
	                    z = maxvalue / divs * i
	                    z = Math.round(z)
	                    r.push(z)
	                }
	                return r;
	            } else {
	                var result = 100 * Math.ceil(maxvalue / 100);
	                for (i = loopVal; i <= divs; i++) {
	                    z = result / divs * i
	                    z = Math.round(z)
	                    r.push(z)
	                }
	                r[divs] = maxvalue
	                return r;
	            }
	        },
	        formatDropDown: function(inputArray, propValue, propDesc) {
	            inputArray.forEach(function(o) {
	                Object.keys(o).forEach(function(k) {
	                    if (k === propValue) {
	                        o.val = o[k];
	                        delete o[k];
	                    }
	                    if (k === propDesc) {
	                        o.desc = o[k];
	                        delete o[k];
	                    }
	                    if (k !== 'val' || k !== 'desc') {
	                        delete o[k];
	                    }
	                });
	            });
	            return inputArray;
	        },
	        formatDropDownforArray: function(inputArray) {
	            var tempArr = [];
	            inputArray.forEach(function(o) {
	                var obj = {};
	                obj.val = o;
	                obj.desc = o;
	                tempArr.push(obj);
	            });
	            return tempArr;
	        },
	        formKeyValuePair: function(inputArray) {
	            var tempArr = [];
	            inputArray.forEach(function(o) {
	                var obj = {};
	                obj.key = o;
	                obj.value = o;
	                tempArr.push(obj);
	            });
	            return tempArr;
	        },
	        filterCalendar: function(searchArr, fromDate, toDate, keyName) { //get filtered array from calendar(from date and to date)
	            var finalArr = [];
	            var fromDatee = Date.parse(ApzCOB.dateformatter(fromDate, 'd/m/Y'));
	            var toDatee = Date.parse(ApzCOB.dateformatter(toDate, 'd/m/Y'));
	            searchArr.forEach(function(e, i) {
	                if (e[keyName] >= fromDatee && e[keyName] <= toDatee) {
	                    finalArr.push(e)
	                }
	            });
	            return finalArr;
	        },
	        attachOnclickEvent: function(elementArray,
	        function_name) { //attaches function in the parameter to onclick event for the array of input elements
	            elementArray.forEach(function(e, i) {
	                $(e).attr('onclick', function_name);
	                //document.getElementById(e.id).setAttribute('onclick', function_name);
	            });
	        },
	        //hide or show
	        hideORshowFunction: function(type, arryId) {
	            if (type === "hide") {
	                $(arryId).map(function(i, v) {
	                    apz.hide(arryId[i]);
	                });
	            } else if (type === "show") {
	                $(arryId).map(function(i, v) {
	                    apz.show(arryId[i]);
	                });
	            }
	        },
	        //display message with errorcode
	        messageDisplayFunction: function(errorCode) {
	            var params = {
	                "code": errorCode
	            };
	            apz.dispMsg(params);
	        },
	        //to display msg
	        fnDisplayMsg: function(lmessage, ltype, lcallback) {
	            var msgparam = {
	                "message": lmessage,
	                "type": ltype,
	                'callBack': lcallback
	            };
	            apz.dispMsg(msgparam);
	            return lcallback;
	        },
	        /********************** Format Amount ***********************/
	        fn_FormatAmount: function(pthis) {
	            var amount = "";
	            if (!apz.isNull(pthis.id)) {
	                amount = $(pthis).val();
	            } else {
	                amount = pthis;
	            }
	            var res = "";
	            var defaultLocale = ApzCOB.GetCommonCodes("AMOUNTFORMAT")['AMOUNTFORMAT']["locale"];
	            if (!apz.isNull(defaultLocale)) {
	                res = ApzCOB.CustomizedAmountFormatting(amount);
	                $(pthis).val(res);
	                return res;
	            } else {
	                var ArrKey = ["value", "mask", "decimalPoints", "decimalSep"],
	                    ArrVal = [amount, "LAKH", 2, "."],
	                    lparams = ApzCOB.dynamicRequestGenerator(ArrKey, ArrVal);
	                return apz.formatNumber(lparams);
	            }
	            // $(pthis).val(res);
	        },
	        /******************* Unformat Amount ****************/
	        fn_unFormatAmount: function(pthis) {
	            var amount = "";
	            if (!apz.isNull(pthis.id)) {
	                amount = $(pthis).val();
	            } else {
	                amount = pthis;
	            }
	            var res = "";
	            if (gApzCOB.CustomAmountFormatEnabled === 'Y') {
	                res = ApzCOB.CustomizedAmountUnFormatting(amount);
	                $(pthis).val(res);
	                return res;
	            } else {
	                if (apz.isNull(amount.split('.')[1])) {
	                    return amount.split(".")[0].replace(/,/g, "");
	                } else {
	                    return amount.split(".")[0].replace(/,/g, "") + "." + amount.split('.')[1];
	                }
	            }
	            // $(pthis).val(res);
	        },
	        /****************Select Row Function ***************/
	        selectRow_Fun: function(pthis) {
	            return parseInt($(pthis).attr("rowno"));
	        },
	        showMainHeader: function() {
	            if (apz.childScr === "dashboard") {
	                apz.show('header');
	                apz.show(gAppId + '__PostLogin_BaseScreen__mainHeader');
	                apz.show(gAppId + '__PostLogin_BaseScreen__lastlogindetailsRow');
	                apz.hide(gAppId + '__PostLogin_BaseScreen__backWeb');
	            }
	            if (!$("#APZRMB__PostLogin_BaseScreen__gr_col_17").is(":visible")) {
	                ApzCOB.sideMenu(this);
	            }
	        },
	        showSubHeader: function(litcode, isdynamic) {
	            ApzCOB.disableCutCopyPaste();
	            if (isdynamic) {
	                $('#' + gAppId + '__BaseScreens__headerText').text(ApzCOB.getLitsDescfromServer(litcode));
	            } else {
	                if (apz.deviceType === "WEB") {
	                    $('#' + gAppId + '__BaseScreens__headerText').text(apz.lits[apz.currAppId][apz.language][litcode]);
	                    $("#" + gAppId + "backIcon").removeClass("sno");
	                    $("input").attr("autocomplete", "off");
	                } else {
	                    $('#' + gAppId + '__BaseScreens__headerText').text(apz.lits[apz.currAppId][apz.language][litcode]);
	                }
	            }
	        },
	        /*=====================================OTP FUnction==============================*/
	        /*Changes made on may 19 for sonar cube*/
	        getValueData: function(baseId) {
	            var otpString = "";
	            $(baseId).map(function(i, v) {
	                otpString = otpString + v.value;
	            });
	            return otpString;
	        },
	        /*======================================Server Call Function ========================*/
	        serverBuildParam: function(appId, interfaceId, paintRes, buildRes, req, asyn, callback) {
	            /**
	             *@author akshay.upadhya
	             *@date 22-12-2020
	             *Function to pass the encryptedAccount number as part of the request if Account Masking is enabled.
	             **/
	            //  var updtReq = ApzCOB.UpdateEncryptAccountNumber(req);
	            //  updtReq = ApzCOB.UpdateAccountTypes(updtReq);
	            var ArrKey = ["appId", "ifaceName", "paintResp", "buildReq", "req", "async", "callBack"],
	                ArrVal = [appId, interfaceId, paintRes, buildRes, req, asyn, callback];
	            var params = ApzCOB.dynamicRequestGenerator(ArrKey, ArrVal);
	            apz.server.callServer(params);
	        },
	        lbackPressedEvent: function() {
	            var json = {
	                "backButtonEvent": "on"
	            };
	            json.callBack = ApzCOB.lbackPressedEventCB;
	            json.id = "EventID";
	            apz.ns.detectEvents(json);
	        },
	        lbackPressedEventCB: function(params) {
	            if (ApzCOB.isAllowBackPressed()) {
	                if (params.event === "backButton") {
	                    var appIds = ["Login", "OTPApp", "Succes", "Dashbo"].indexOf(apz.currAppId);
	                    if ((appIds > -1) && $("#Dashbo__dashboard__gr_col_17").hasClass("menu_open")) {
	                        apz.app.dashboard.fnopenMenu();
	                    } else {
	                        //this click event is got set in each page so triggering the same
	                        ApzCOB.backPressPart();
	                        /*$('#' + gAppId + '__PreLogin_BaseScreen__mob_footerbackbtnColumn').trigger("onclick"); //prelogin screens
	                        //var lastScr = ApzCOB.getprevscrPageBC();
	                        if (apz.currAppId === "Dashbo") {
	                            $('#' + gAppId + '__PostLogin_BaseScreen__backButtonColumn').trigger("onclick", ApzCOB.logout());
	                        } //postlogin screens
	                        else if (apz.currAppId === "Login") {
	                            apz.app.Login.backpressed();
	                        } else if (apz.currAppId === "PLFeat") {
	                            apz.app.PreLogin_BaseScreen.preloginback();
	                        } else if (apz.currAppId === "Authen" && apz.isFunction(apz.app[apz.childScr].backNavigation)) {
	                            apz.app[apz.childScr].backNavigation();
	                        } else {
	                            apz.app[apz.childScr].backNavigation();
	                        }*/
	                    }
	                }
	            } else {
	                //
	            }
	        },
	        serverLogOut: function() {
	            apz.startLoader();
	            var ArrKey = ["userId", "callBack", "callBackObj"],
	                ArrVal = [gApzCOB.LoggedInUserDetails.loginResponse.userDet.id, ApzCOB.logoutCB, this],
	                params = ApzCOB.dynamicRequestGenerator(ArrKey, ArrVal);
	            apz.server.logout(params);
	        },
	        logoutCB: function(params) {
	            if (params.status) {
	                window.location.reload();
	                /*var launchAppReq = {
	                    "appId": gAppId,
	                    "scr": "PreLogin_BaseScreen",
	                    "userObj": {
	                        "showSplash": false
	                    }
	                };
	                apz.launchApp(launchAppReq);*/
	            }
	            //apz.stopLoader();
	        },
	        //session timeout call back
	        sessionTimeoutCallBack: function() {
	            var launchAppReq = {
	                "appId": "gAppId",
	                "scr": "PreLogin_BaseScreen",
	                "userObj": {
	                    "showSplash": false
	                }
	            };
	            apz.launchApp(launchAppReq);
	        },
	        //backnavigation function for post login screens
	        addscrPageBC: function(screenId) {
	            if (apz.isNull(gPageNavHist)) {
	                window.gPageNavHist = apz.currAppId + "__" + screenId;
	            } else {
	                if (screenId === "AccountsScreens") {
	                    window.gPageNavHist = window.gPageNavHist.split("|")[0] += "|" + apz.currAppId + "__" + screenId;
	                } else {
	                    window.gPageNavHist += "|" + apz.currAppId + "__" + screenId;
	                }
	            }
	        },
	        getprevscrPageBC: function() {
	            var page = '';
	            if (!apz.isNull(gPageNavHist)) {
	                page = gPageNavHist.split("|");
	                if ((apz.deviceType === "WEB") || (apz.deviceType !== "WEB" && apz.childScr !== "dashboard")) {
	                    page.pop();
	                }
	                window.gPageNavHist = page.join("|");
	                return page[page.length - 1];
	            }
	            return page;
	        },
	        chkprevscrPageBC: function(screenId) {
	            var page;
	            var screen = apz.currAppId + "__" + screenId;
	            if (!apz.isNull(gPageNavHist)) {
	                page = gPageNavHist.split("|");
	                return (screen === (page[page.length - 1]));
	            }
	            return false;
	        },
	        //post login postnavigation function ends
	        //backnavigation for pre login
	        addscrPreLoginPageBC: function(screenId) {
	            if (apz.isNull(gPreLoginPageBC)) {
	                window.gPreLoginPageBC = apz.currAppId + "__" + screenId;
	            } else {
	                window.gPreLoginPageBC += "|" + apz.currAppId + "__" + screenId;
	            }
	        },
	        getprevscrPreLoginPageBC: function() {
	            var page = '';
	            if (!apz.isNull(gPreLoginPageBC)) {
	                page = gPreLoginPageBC.split("|");
	                page.pop();
	                window.gPreLoginPageBC = page.join("|");
	                return page[page.length - 1];
	            }
	            return page;
	        },
	        chkprevscrPreLoginPageBC: function(screenId) {
	            var page;
	            var screen = apz.currAppId + "__" + screenId;
	            if (!apz.isNull(gPreLoginPageBC)) {
	                page = gPreLoginPageBC.split("|");
	                return (screen === (page[page.length - 1]));
	            }
	            return false;
	        },
	        preLoginbackNavigation: function(obj) {
	            $("#" + gAppId + "__PreLogin_BaseScreen__web_preLoginFooterWrapper").addClass(
	            "sno"); //this is to avoid jerk while backnavigation
	            $("#" + gAppId + "__PreLogin_BaseScreen__basediv").html("");
	            $("#Miscel__More_Menu__moreBaseDiv").html("");
	            var lastScr = ApzCOB.getprevscrPreLoginPageBC();
	            var temp = lastScr.split('__');
	            var curAppid = apz.currAppId;
	            var params = {
	                'div': gAppId + "__PreLogin_BaseScreen__basediv",
	                'userObj': obj,
	                'animation': window.gAnimationType
	            };
	            if (temp[0] === curAppid) {
	                params.appId = temp[0];
	                params.scr = temp[1];
	                apz.launchSubScreen(params);
	            } else {
	                params.appId = temp[0];
	                params.scr = temp[1];
	                if (params.scr === "Login") {
	                    $("#" + gAppId + "__PreLogin_BaseScreen__loginheader").removeClass("sno");
	                    $("#" + gAppId + "__PreLogin_BaseScreen__moremenuheader").addClass("sno");
	                    $("#footer").addClass("sno");
	                }
	                ApzCOB.launchMicroApp(params.appId, params.scr, params.div, params.userObj);
	            }
	        },
	        //backnavigation for prelogin ends
	        //Native share plugin invoke
	        shareAccountDetails: function(textToShare) {
	            var pjson = {
	                "textToShare": textToShare,
	                "action": "native_share",
	                "id": "NATIVE" //Android
	            };
	            pjson.callBack = ApzCOB.shareAccountDetailsCB;
	            if (apz.deviceOs === "ANDROID") {
	                apz.ns.nativeServiceExt(pjson); // android
	            } else {
	                pjson.id = "NativeShare";
	                apz.ns.nativeShare(pjson); // ios
	            }
	        },
	        shareAccountDetailsCB: function(json) {
	            //not implemented yet
	        },
	        excuteOperationRequest: function() {
	            return;
	        },
	        valid: function(element, check, ccode, ccodeword) {
	            var tempElArr = ['text', 'strict_text', 'textarea', 'password', 'tel', 'email', 'number'].indexOf(element.type);
	            if (tempElArr > -1) {
	                return check(element.value);
	            } else {
	                return check(element, ccode, ccodeword);
	            }
	        },
	        /*
Once call this function
+ fetching the id or custom attribute (only applicable for cx search) from "form"
+ After getting that particular value fetching the key from "list"
+based on the verify key validating the input values

*/
	        /*
	         * Function break into parts on 19 May
	         * For sonarqube fixes
	         * Start
	         */
	        validateInputFields: function(form, value, list, flag) {
	            // var errorCount = 0,
	            var element,
	                n, i;
	            // isValid = apz.isNull(isValid)? false :isValid;
	            // for (i = 0; i < form.length; i++) {
	            /**SelfAssisted related Changes Starts***/
	            if (apz.currAppId === "Login" || apz.currAppId === "ChgPas") {
	                var isValid = ApzCOB.validateInputFieldsBO(form, value, flag);
	                return isValid;
	                /**SelfAssisted related Changes Ends***/
	            } else {
	                element = form[value];
	                n = ApzCOB.getValueForInput(element, n);
	                if (list[n] && list[n].verify) {
	                    ApzCOB.valid(element, list[n].verify);
	                    if (!err) {
	                        ApzCOB.valid(element, list[n].dropDown);
	                    }
	                    if (err) {
	                        if ($('#' + element.id).is(':visible') && $('#' + element.id).hasClass('mand') && element.type !== 'checkbox') {
	                            if (CURRENT_STAGE_NAME === "OCCUPATIONDETAILS" && (element.id === EmpDetscrId + 'yrsOfExp' || element.id ===
	                                    EmpDetscrId + 'monOfExp')) {
	                                if (apz.app.EmploymentDetails.removeExpMand()) {
	                                    ApzCOB.noErrFn(flag, n);
	                                } else {
	                                    ApzCOB.errExistScrollFn(flag, list, n, element.id);
	                                }
	                            } else {
	                                ApzCOB.errExistScrollFn(flag, list, n, element.id);
	                            }
	                            // isValid = true
	                        }
	                    } else {
	                        if ($('#' + element.id).hasClass('err')) {
	                            ApzCOB.errExistFn(flag, list, n);
	                            window.errorCount++;
	                        } else {
	                            ApzCOB.noErrFn(flag, n);
	                        }
	                    }
	                }
	                //  }
	                if (window.errorCount > 0) {
	                    return false;
	                }
	                return true;
	            }
	        },
	        validateInputFieldsBO: function(form, list, flag) {
	            var errorCount = 0,
	                element,
	                n, i;
	            for (i = 0; i < form.length; i++) {
	                element = form[i];
	                n = ApzCOB.getValueForInput(element, n);
	                if (list[n] && list[n].verify) {
	                    ApzCOB.valid(element, list[n].verify);
	                    if (err) {
	                        ApzCOB.errExistFn(flag, list, n);
	                        errorCount++;
	                    } else {
	                        ApzCOB.noErrFn(flag, n);
	                    }
	                }
	            }
	            if (window.gIsInvalidMobNumber) {
	                errorCount++;
	            }
	            if (errorCount > 0) {
	                return false;
	            }
	            return true;
	        },
	        //function to scroll view when error exists
	        errExistScrollFn: function(flag, list, n, id) {
	            window.errorCount++;
	            ApzCOB.errExistFn(flag, list, n);
	            document.getElementById(id).scrollIntoView({
	                behavior: "smooth",
	                block: "center",
	                inline: "center"
	            })
	        },
	        errExistFn: function(flag, list, n) {
	            if (flag === 0) {
	                /* applicable other than form - i.e, list */
	                /**
	                 * @author praisy.b
	                 * @since 04.06.21
	                 * Added fix for below issue
	                 * No input field is highlighted in red when error
	                 **/
	                list[n].err = err;
	                $("#" + n).addClass('err');
	                $("#" + n).parent().next().removeClass("sno");
	                $("#" + n).parent().next().children().find("p").text(apz.lits[apz.currAppId][apz.language][list[n].message]);
	            } else {
	                list[n].err = err;
	                if ($("#" + n).parent().get(0).tagName === "DIV") { //dropdown
	                    $("#" + n).parent().addClass('err');
	                } else { //input
	                    $("#" + n).addClass('err');
	                }
	                $("#" + n).closest("ul").next().removeClass("sno");
	                $("#" + n).closest("ul").next().children().find("p").text(apz.lits[apz.currAppId][apz.language][list[n].message]);
	            }
	        },
	        noErrFn: function(flag, n) {
	            if (flag === 0) {
	                $("#" + n).parent().next().addClass("sno");
	            } else {
	                if ($("#" + n).parent().get(0).tagName === "DIV") { //dropdown
	                    $("#" + n).parent().removeClass('err');
	                } else { //input
	                    $("#" + n).removeClass('err');
	                }
	                var id = $("#" + n).closest("ul")[0]['id'];
	                for (var k = 0; k < $('#' + id).parent().children().length; k++) {
	                    var childId = $('#' + id).parent().children()[k]['id'];
	                    if ($('#' + childId).hasClass('err-msg')) {
	                        $('#' + childId).addClass('sno')
	                    }
	                }
	                //  $("#" + n).closest("ul").next().addClass("sno");
	            }
	        },
	        getValueForInput: function(element, n) {
	            var returnedVal;
	            if (!element.hasAttribute("name")) {
	                returnedVal = element.id;
	            } else if (element.hasAttribute("src")) {
	                returnedVal = element.src;
	            } else {
	                returnedVal = element.name;
	            }
	            return returnedVal;
	        },
	        /*
	         * Function break into parts on 19 May
	         * For sonarqube fixes
	         * End
	         * please note it can be used only for amount fields
	         */
	        //hide errormsg block on keyup of input field
	        hideErrmsgBlock: function(pthis) {
	            if ($(pthis).parent().get(0).tagName === "DIV") { //dropdown
	                $(pthis).parent().removeClass('err');
	            } else { //input
	                $(pthis).removeClass('err');
	            }
	            if (!apz.isNull($(pthis).val()) && !isNaN(ApzCOB.fn_unFormatAmount($(pthis).val()))) {
	                pthis.value = ApzCOB.fn_unFormatAmount(pthis.value);
	            }
	            // $(pthis).closest("ul").next().addClass("sno");
	            //Temporary fix for MB otp placeholder changing from 6 to 5
	            $(pthis).closest("ul").next().addClass("sno");
	            if (apz.deviceType !== "WEB" && apz.childScr === "OTPAuthentication") {
	                $(pthis).closest("ul").next().removeClass("sno");
	            }
	        },
	        /*
	         * added by Praisy
	         * for hiding errormsg block on keyup of input field without unformatting field
	         */
	        hideErrmsgBlockforString: function(pthis) {
	            if ($(pthis).parent().get(0).tagName === "DIV") { //dropdown
	                $(pthis).parent().removeClass('err');
	            } else if ($(pthis).get(0).tagName === "BUTTON") {
	                $(pthis).siblings().removeClass('err');
	            } else { //input
	                $(pthis).removeClass('err');
	            }
	            if ($(pthis).closest("ul").next().hasClass('err-msg')) {
	                $(pthis).closest("ul").next().addClass("sno");
	            } else {
	                $(pthis).closest("ul").next().next().addClass("sno");
	            }
	        },
	        //validate email on blur
	        validateemailid: function(pthis) {
	            if (pthis.value.length !== 0) {
	                var lemail = email(pthis.value);
	                if (lemail !== 0) {
	                    $(pthis).closest("ul").next().removeClass("sno");
	                    $(pthis).closest("ul").next().children().find("p").text(apz.lits[apz.currAppId][apz.language]["LIT_ENTER_VALID_EMAIL"]);
	                    $(pthis).addClass('err');
	                    document.getElementById(pthis.id).scrollIntoView({
	                        behavior: "smooth",
	                        block: "center",
	                        inline: "center"
	                    })
	                    return;
	                } else {
	                    $(pthis).closest("ul").next().addClass("sno");
	                    $(pthis).removeClass('err');
	                }
	            } else {
	                $(pthis).closest("ul").next().children().find("p").text(apz.lits[apz.currAppId][apz.language]["LIT_PLEASE_EMAIL"]);
	            }
	        },
	        //validate email on keyup - allow only @ _ .
	        validateEmailOnKeyUp: function(pthis) {
	            pthis.value = pthis.value.replace(/[^A-z 0-9 @-_.]/gi, '');
	        },
	        fnValidateEmail: function(pthis) {
	            var regexEmail = "^[a-zA-Z0-9+_.-]+@[a-zA-Z0-9.-]+$";
	            pthis.value = pthis.value.replace(regexEmail, '');
	        },
	        //validate email on keyup - allow only @ _ .
	        validateDOBOnKeyUp: function(pthis) {
	            pthis.value = pthis.value.replace(/[^0-9 -]/gi, '');
	        },
	        fnValidateAlphaChars: function(pthis) {
	            pthis.value = pthis.value.replace(gALLOWALPHA, '');
	        },
	        fnAccountNo: function(pthis) {
	            pthis.value = pthis.value.replace(gALLOWONLYNUM, '');
	        },
	        fnValidateIfsc: function(pthis) {
	            pthis.value = pthis.value.replace(gALPHANUMERIC, '');
	        },
	        fnValidatealphanumeric: function(pthis) {
	            pthis.value = pthis.value.replace(gALPHANUMERIC, '');
	        },
	        fnValidatealphanumericSpace: function(pthis) {
	            pthis.value = pthis.value.replace(gALPHANUMERICSpace, '');
	        },
	        fnValidatealphanumericvoter: function(pthis) {
	            pthis.value = pthis.value.replace(gALPHANUMERICVoter, '');
	        },
	        fnValidateaddress: function(pthis) {
	            pthis.value = pthis.value.replace(gALLOWFORADDRESS, '');
	        },
	        fnValidatename: function(pthis) {
	            if (apz.childScr === 'EmploymentDetails') {
	                pthis.value = pthis.value.replace(gALLOWFORNAMEEMP, '');
	            } else if (apz.childScr === 'PersonalDetails' || apz.childScr === 'AddLoanDetails' || apz.childScr === 'AddHouseHoldDetails' ||
	                apz.childScr === 'EarningMemberDetails' || apz.childScr === 'UploadKyc' || apz.childScr === 'EditLoanAndInsurance') {
	                pthis.value = pthis.value.replace(gALLOWFORNAME, '');
	            } else {
	                pthis.value = pthis.value.replace(gALLOWFORSEARCH, '');
	            }
	        },
	        limitText: function(pthis, maxChar) {
	            var ref = $(pthis),
	                val = ref.val();
	            if (val.length >= maxChar) {
	                ref.val(function() {
	                    //console.log(val.substr(0, maxChar))
	                    return val.substr(0, maxChar);
	                });
	            }
	        },
	        onBlurdob: function(pthis) {
	            var erroristrue = false;
	            if ($("#" + pthis.id).hasClass('err')) {
	                $("#" + pthis.id).val('');
	                return;
	            }
	            var diff = (new Date() - $("#" + pthis.id).datepicker('getDate')) / 1000 / 60 / 60 / 24 //difference between two date
	            if (diff < 0) {
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_FUTUREDATENOTALLOWED"), "E");
	                $("#" + pthis.id).addClass('err');
	                $("#" + pthis.id).val('');
	            }
	            var datevalue = $("#" + pthis.id).val();
	            window.doblength = datevalue.length;
	            formatdate = ($("#" + pthis.id).val()).split('/');
	            if (datevalue.length === 10) {
	                var indianformatdate = formatdate[1] + '/' + formatdate[0] + '/' + formatdate[2];
	                var date = new Date(indianformatdate);
	                if (date == 'Invalid Date') {
	                    erroristrue = true;
	                    ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_VALIDDATE"), "E");
	                    $("#" + pthis.id).addClass('err');
	                    $("#" + pthis.id).val('');
	                }
	            }
	            if (erroristrue !== true) {
	                if (formatdate[2].length === 4 && erroristrue !== true) {
	                    if (formatdate[2] > 1922) {
	                        // if (formatdate[2] == 1922) {
	                        //     var currentdate = new Date();
	                        //     var dmyformat = currentdate.format("d/m/Y");
	                        //     var formated = dmyformat.split('/');
	                        //     if (formatdate[1].length == 1) {
	                        //         datevalue = new Date($("#" + pthis.id).val()).$format('d/m/Y');
	                        //         formatdate = datevalue.split('/');
	                        //         if (formatdate[0] < formated[0]) {
	                        //             ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_DATE_RANGE"), "E");
	                        //             $("#" + pthis.id).addClass('err');
	                        //             $("#" + pthis.id).val('');
	                        //         }
	                        //     } else {
	                        //         if (formatdate[0] < formated[0]) {
	                        //             ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_DATE_RANGE"), "E");
	                        //             $("#" + pthis.id).addClass('err');
	                        //             $("#" + pthis.id).val('');
	                        //         }
	                        //     }
	                        // } else {
	                        //     ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_DATE_RANGE"), "E");
	                        //     $("#" + pthis.id).addClass('err');
	                        //     $("#" + pthis.id).val('');
	                        // }
	                    } else {
	                        ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_VALIDDATE"), "E");
	                        $("#" + pthis.id).addClass('err');
	                        $("#" + pthis.id).val('');
	                    }
	                } else {
	                    ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_VALIDDATE"), "E");
	                    $("#" + pthis.id).addClass('err');
	                    $("#" + pthis.id).val('');
	                }
	            }
	        },
	        fnDateFormat: function(pthis) {
	            if ($("#" + pthis.id).val().length >= 8) {
	                var Year = new Date($("#" + pthis.id).val()).getFullYear();
	                if (Year.toString().length === 4) {
	                    var leadingZeroDate = ApzCOB.confDateFormatter($("#" + pthis.id).datepicker('getDate'), apz.dateFormat);
	                    $("#" + pthis.id).val(leadingZeroDate);
	                }
	            }
	        },
	        // Function to return the formated date according to User preferences Date format
	        confDateFormatter: function(lDate, format) {
	            switch (format) {
	                case "dd/mm/yyyy": //// converts 12/08/2018
	                    return new Date(lDate).format('d/m/Y');
	                case "mm/dd/yyyy": //// converts 12/08/2018
	                    return new Date(lDate).format('m/d/Y');
	                case "dd/MM/yyyy": //// converts 12/08/2018
	                    return new Date(lDate).format('d/m/Y');
	                case "DD/mm/yyyy": //// converts 12/08/2018
	                    return new Date(lDate).format('d/m/Y');
	                case "DD/MM/yyyy": //// converts 12/08/2018
	                    return new Date(lDate).format('d/m/Y');
	                case "yyyy/mm/dd": //// converts 12/08/2018
	                    return new Date(lDate).format('Y/m/d');
	                case "yyyy/MM/dd": //// converts 12/08/2018
	                    return new Date(lDate).format('Y/m/d');
	                case "yyyy/mm/DD": //// converts 12/08/2018
	                    return new Date(lDate).format('Y/m/d');
	                case "yyyy/MM/DD": //// converts 12/08/2018
	                    return new Date(lDate).format('Y/m/d');
	                case "dd/mm/yy": //// converts 12/08/18
	                    return new Date(lDate).format('d/m/y');
	                default:
	                    return new Date(lDate).format('d/m/Y');
	            }
	        },
	        // dateStringToDate: function(dateString) {
	        //     try {
	        //         var year = dateString.substring(0, 4);
	        //         var month = dateString.substring(4, 6);
	        //         var day = dateString.substring(6, 8);
	        //         var monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
	        //         return day + " " + monthNames[(parseInt(month)) - 1] + " '" + year;
	        //     } catch (error) {
	        //         return null;
	        //     }
	        // },
	        dateStringToDate: function(dateString) {
	            try {
	                if (!dateString || dateString.length !== 8) {
	                    return null;
	                }
	                var year = dateString.substring(0, 4);
	                var month = dateString.substring(4, 6);
	                var day = dateString.substring(6, 8);
	                if (isNaN(year) || isNaN(month) || isNaN(day)) {
	                    return null;
	                }
	                return new Date(`${year}-${month}-${day}`);
	            } catch (error) {
	                return null;
	            }
	        },
	        convertISOToDate: function(isoString) {
	            try {
	                if (!isoString || isoString.length < 10) {
	                    return null;
	                }
	                return new Date(isoString);
	            } catch (error) {
	                return null;
	            }
	        },
	        dayCount: function(inputDate) {
	            const today = new Date();
	            const yyyy = today.getFullYear();
	            let mm = today.getMonth() + 1; // Months start at 0!
	            let dd = today.getDate();
	            if (dd < 10) dd = '0' + dd;
	            if (mm < 10) mm = '0' + mm;
	            const formattedToday = mm + '/' + dd + '/' + yyyy;
	            var date1 = new Date(formattedToday);
	            var inputDate = new Date(inputDate);
	            var diffTime = inputDate - date1;
	            var diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
	            return diffDays;
	        },
	        findMaturityWeek: function(inputDate) {
	            var maturityDateweeksFormat = ApzCOB.confDateFormatter(ApzCOB.dateStringToDate(inputDate), "mm/dd/yyyy");
	            var daysCount = ApzCOB.dayCount(maturityDateweeksFormat);
	            var wks = 0;
	            if (daysCount >= 4) {
	                wks = (daysCount / 7).toFixed(0);
	            }
	            return wks;
	        },
	        // Function added to allow only numbers for customerId field.
	        fnValidateCustId: function(pthis) {
	            pthis.value = pthis.value.replace(gALLOWONLYNUM, '');
	        },
	        fnValidateIntRates: function(pthis) { // for interest rate field
	            if (pthis.value.indexOf('.') !== 0 && pthis.value.indexOf('0') !== 0) {
	                var regex = /[^0-9.]|(?=.+)[^0-9]{2}/g;
	                pthis.value = pthis.value.replace(regex, '');
	            } else {
	                pthis.value = '';
	            }
	        },
	        fnValidateRegex: function(pthis) { // final validation to ensure the field must contain alphanumeric characters
	            var str = pthis.value;
	            if (!(apz.isNull(str)) /*&& $("#" + pthis.id).hasClass('mand')*/ ) {
	                if (!(/[a-zA-Z0-9]/.test(str))) {
	                    $("#" + pthis.id).val("");
	                    if ($("#" + pthis.id).hasClass('mand')) {
	                        $("#" + pthis.id).addClass('err');
	                        $("#" + pthis.id).closest('ul').next().removeClass('sno');
	                    }
	                }
	            }
	        },
	        //unformat amount with decimal
	        unformatAmountWithDecimal: function(amount) {
	            var pamount = amount;
	            if (!apz.isNull(pamount)) {
	                var decimalValue = pamount.split(".");
	                pamount = ApzCOB.fn_unFormatAmount(pamount);
	                pamount = pamount + "." + decimalValue[decimalValue.length - 1];
	            }
	            return pamount;
	        },
	        decimalNum: function(pthis, param) {
	            ApzCOB.hideErrmsgBlock(pthis); //hide err block
	            if (pthis.id === param) {
	                var lastValid = document.getElementById(pthis.id).value;
	                if (!gALLOWNUMBERDECIMALS.test(pthis.value)) {
	                    var a = lastValid.slice(0, -1);
	                    pthis.value = a;
	                }
	            } else {
	                pthis.value = pthis.value.replace(gALLOWONLYNUM, '');
	            }
	        },
	        PreLoginNavigate: function(pthis) {
	            var details = preLogin[$(pthis).attr("id").split("__").pop()];
	            ApzCOB.removeCss();
	            ApzCOB.launchMicroApp(details.appID, details.screen, gPreLoginBaseDiv, "");
	        },
	        removeCss: function() {
	            $('body').removeClass("ibbg");
	            $("#header").removeClass("loginheader");
	            $("#page-body").removeClass("loginpagebody");
	            $("body").removeClass("pri").addClass("sec");
	        },
	        Withoutanimation: function(screenId, parentDiv, userObj) {
	            var ArrKey = ["scr", "div", "userObj"],
	                ArrVal = [screenId, parentDiv, userObj],
	                params = ApzCOB.dynamicRequestGenerator(ArrKey, ArrVal);
	            apz.launchSubScreen(params);
	        },
	        launchMicroAppWithoutAnimation: function(appid, screenId, parentDiv, userObj) {
	            var ArrKey = ["appId", "scr", "div", "userObj"],
	                ArrVal = [appid, screenId, parentDiv, userObj],
	                params = ApzCOB.dynamicRequestGenerator(ArrKey, ArrVal);
	            apz.launchApp(params);
	        },
	        /*
Function to handle External service error messges
cbsode will be always null in internal service - so check only cbscode here (no need to check errorcode)
*/
	        externalServiceErrorHandling: function(params, resnode) {
	            if (params.status) {
	                var objData = params.res[resnode];
	                if ((apz.isNull(objData.ResponseHeader.CBSCode) || (objData.ResponseHeader.CBSCode === "0")) && !apz.isNull(objData
	                        .ResponseHeader.ErrorCode)) {
	                    ApzCOB.launchMicroApp("Succes", "Transaction_Failed", gPostLoginBaseDiv, objData.ResponseHeader);
	                }
	                /* else if ((objData.ResponseHeader.CBSCode === "0") && !apz.isNull(objData.ResponseHeader.ErrorCode)) {
	                                ApzCOB.launchMicroApp("Succes", "Transaction_Failed", gPostLoginBaseDiv, objData.ResponseHeader);
	                            }*/
	            } else {
	                ApzCOB.ServiceFailureMsg(params);
	            }
	        },
	        /*
Function to handle internal service error messges
cbsode will be always null in internal service - so check only cbscode here (no need to check errorcode)
*/
	        interServiceErrorHandling: function(params, resnode) {
	            if (params.status) {
	                var objData = params.res[resnode];
	                if (apz.isNull(objData.ResponseHeader.CBSCode) && !apz.isNull(objData.ResponseHeader.ErrorCode)) {
	                    ApzCOB.fnDisplayMsg(objData.ResponseHeader.ErrorMessage, "E", "");
	                }
	            } else {
	                ApzCOB.ServiceFailureMsg(params);
	            }
	        },
	        //new external service handling function
	        handleServiceCallBacks: function(params) {
	            try {
	                if (params.status && apz.isNull(params.errors)) {
	                    var objData = params.res[Object.keys(params.res)[0]];
	                    if (objData.apiResponse.ResponseHeader.hasOwnProperty("ResponseCode")) {
	                        //if no ResponseCode then check for errorcode - nonexternal service
	                        //if ResponseHeader is not empty check for ResponseCode
	                        if (objData.apiResponse.ResponseHeader.ResponseCode === "0") {
	                            try {
	                                if (objData.apiResponse.ResponseBody.hasOwnProperty("responseObj") && !apz.isNull(objData.apiResponse
	                                        .ResponseBody.responseObj) && JSON.parse(objData.apiResponse.ResponseBody.responseObj)
	                                    .hasOwnProperty("serviceStatusCode") && JSON.parse(objData.apiResponse.ResponseBody.responseObj)
	                                    .serviceStatusCode !== "0") {
	                                    return false;
	                                } else {
	                                    return true;
	                                }
	                            } catch (e) {
	                                return true;
	                                //ApzCOB.ServiceFailureMsg(params);
	                            }
	                        } else if (objData.apiResponse.ResponseHeader.ResponseCode === "1") {
	                            return false;
	                        } else if (objData.apiResponse.ResponseHeader.ResponseCode === 'IV112') {
	                            ApzCOB.DispMsgWithCustomButtons(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_OOPSSOMETHINGWENTWRONG"), 'E', ApzCOB
	                                .ReloadApp, ApzCOB.getDescfromLitCode("LIT_COMM_BTN_TXT_OK"));
	                            return;
	                        }
	                        if (objData.apiResponse.hasOwnProperty("responseObj")) {
	                            if (objData.apiResponse.responseObj.ResponseCode.serviceStatusCode === "0") {
	                                return true;
	                            } else if (apz.isNull(objData.apiResponse.ResponseHeader.ResponseCode) || apz.isNull(objData.apiResponse
	                                    .ResponseHeader.ResponseCode !== "0")) {
	                                return false;
	                            }
	                        }
	                    } else {
	                        return false;
	                    }
	                    //Replaced if and else with a single return as per SonarQube recommendation
	                    return apz.isNull(objData.apiResponse.ResponseHeader.ResponseCode);
	                } else {
	                    //ApzCOB.ServiceFailureMsg(params);
	                    return false;
	                }
	            } catch (e) {
	                apz.stopLoader();
	                //ApzCOB.ServiceFailureMsg(params);
	            }
	        },
	        checkAuthenticationServiceErrorCallback: function(pdata) {
	            apz.stopLoader();
	            ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	        },
	        ServiceFailureMsg: function(params) {
	            ApzCOB.checkAuthenticationServiceErrorCallback();
	        },
	        navigationNAV: function(pObj, index) {
	            apz.app.dashboard.clearAllGlobalValues();
	            var sDetails = menuToScreenNavMap[gWebmenuKEY[index]];
	            $("#" + gAppId + "__PostLogin_BaseScreen__gr_col_13").addClass('sno');
	            ApzCOB.launchMicroApp(sDetails.module, sDetails.screenName, gPostLoginBaseDiv, "");
	        },
	        //hide header and footer in success app and otp app
	        hideHeaderFooter: function() {
	            $("#header").addClass("sno");
	            $("#footer").addClass("sno");
	        },
	        //handle footer back function (MB) and header back function (IB)
	        handlePreLoginBackfunction: function(data) {
	            if (apz.deviceType !== "WEB") {
	                $("#footer").removeClass("sno");
	                $("#" + gAppId + "__PreLogin_BaseScreen__mob_footerbackbtnColumn").attr("onclick", "ApzCOB.preLoginbackNavigation(" + JSON
	                    .stringify(data) + ");");
	            } //Removed empty else block
	        },
	        //handle footer back function (MB) and header back function (IB)
	        handleBackfunction: function(data) {
	            if (apz.deviceType === "WEB") {
	                $("#" + gAppId + "__PostLogin_BaseScreen__backIconCol").removeClass("sno").attr("onclick", "ApzCOB.backNavigation(" + JSON
	                    .stringify(data) + ");");
	            }
	        },
	        /*On click of + icon to add photo*/
	        takePicture: function(pthis) {
	            var lparams = {
	                "zoomLevel": "20",
	                "targetWidth": "200",
	                "targetHeight": "200",
	                "crop": "Y",
	                "flash": "N",
	                "action": "base64",
	                "fileName": "userPic",
	                "quality": "75",
	                "encodingType": "JPG",
	                "sourceType": "camera",
	                "id": pthis.id,
	                "callBack": ApzCOB.lcameraCallback
	            };
	            apz.ns.openCamera(lparams);
	        },
	        lcameraCallback: function(resp) {
	            if (resp.status) {
	                ApzCOB.takePictureCB(resp);
	            }
	        },
	        focusnextInput: function(pthis, event, arrayId, validationFun) {
	            //on delete of last otp val - get the focus to previous input field
	            var key = event.keyCode || event.charCode;
	            if (key === 8 || key === 46) {
	                var indexNum = $('.otpInput').index(pthis);
	                if (indexNum !== 0) {
	                    $(pthis).removeClass("otpshow");
	                    $(pthis).closest("ul").parent().prev().children().find("input").val("");
	                    $(pthis).closest("ul").parent().prev().children().find("input").removeClass("otpshow");
	                    $(pthis).closest("ul").parent().prev().children().find("input").focus();
	                }
	            } else if (key >= 48 && key <= 57) {
	                if (gALLOWONLYNUM.test(pthis.value)) {
	                    ApzCOB.fnValidatenumbers(pthis);
	                } else if (pthis.id === arrayId) { //"OTPApp__OTP_MainPage__el_inp_6"||OTPApp__OTP_MainPage__el_inp_6
	                    $('#' + arrayId).blur();
	                    validationFun();
	                } else {
	                    $(pthis).closest("ul").parent().next().children().find("input").addClass("otpshow");
	                    $(pthis).closest("ul").parent().next().children().find("input").focus();
	                }
	            } else {
	                ApzCOB.fnValidatenumbers(pthis);
	                //removing return statement
	            }
	        },
	        scheduleCommon: function(datefieldId) {
	            var currtdate = new Date(),
	                month = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
	                monthIndex = parseInt(currtdate.getMonth() + 1),
	                monthFo = month[monthIndex - 1],
	                lmaxyear = currtdate.getFullYear() + 5,
	                ldate = currtdate.getDate() + "-" + monthFo + "-" + currtdate.getFullYear(),
	                lmaxdate = currtdate.getDate() + "-" + monthFo + "-" + lmaxyear,
	                formatdateobj = {
	                    "id": datefieldId,
	                    "dataType": "DATETIME",
	                    "lookAndFeel": "GENERIC",
	                    "parentDisplay": "BUBBLE",
	                    "style": "MATERIAL",
	                    "parentPreset": "CALENDAR_DATETIME",
	                    "parentMinDate": ldate,
	                    "parentMaxDate": lmaxdate,
	                    "closeOnSel": "N",
	                    "multiSel": "N",
	                    "parentStartYear": "",
	                    "parentEndYear": "",
	                    "parentRangePick": "N",
	                    "secInputId": "",
	                    "parentMultiInput": "N",
	                    "dateType": "GENERIC"
	                };
	            apz.initAppzillonDates(formatdateobj);
	        },
	        ReloadApp: function() {
	            window.location.reload();
	        },
	        // Login Common functionality
	        login: function(customerId, password) {
	            var params = {
	                "userId": customerId,
	                "pwd": password,
	                "callBack": ApzCOB.loginCallBack,
	                "scrsAccessType": 'A',
	                "ifacesAccessType": 'A',
	                "controlsAccessType": 'A'
	            };
	            // ApzCOB.fetchKendraDetails();
	            /*if (apz.deviceType !== "WEB" && !apz.isNull(gApzCOB.Prelogin.BioMetric)) {
	                if (gApzCOB.Prelogin.BioMetric === "Y" && gApzCOB.Prelogin.PassClick === true) {
	                    gApzCOB.Prelogin.PassClick = false;
	                } else {
	                    params.isBiometric = gApzCOB.Prelogin.BioMetric;
	                }
	            }*/
	            apz.startLoader();
	            /*window.LoggedInUserDetails = loginRes;
	            window.LoggedInUserDetails.kmId = customerId;
	            ApzCOB.setPref('LoggedInUserDetails', window.LoggedInUserDetails);
	            gApzCOB.LoggedInUserDetails = window.LoggedInUserDetails;
	            window.LoggedInUserDetails.kmId = 'GK15661';
	            if (window.isNwAvailable) {
	                ApzCOB.fetchKendraDetails(window.LoggedInUserDetails.kmId);
	                //ApzCOB.dashboardAppListAPI();
	            } else {
	                ApzCOB.getPref('KendraResponse');
	            }
	            window.kmBmRole = "";*/
	            //  ApzCOB.launchMicroApp('Dashbo', 'dashboard', gAppId + '__BaseScreens__BaseDIV', '');
	            /**SelfAssisted related Changes Starts***/
	            //  ApzCOB.customlogincallback();
	            ApzCOB.isNetworkAvailable();
	            setTimeout(function() {
	                if (window.isNwAvailable) {
	                    apz.server.login(params);
	                } else {
	                    apz.stopLoader();
	                }
	            }, 200);
	        },
	        // Login Call back functionality
	        loginCallBack: function(params) {
	            try {
	                if (!apz.isNull(params.res.loginResponse)) {
	                    if (params.res.loginResponse.status) {
	                        window.LoggedInUserDetails = params.res;
	                        ApzCOB.setPref('LoggedInUserDetails', window.LoggedInUserDetails);
	                        //  ApzCOB.fetchKendraDetails(window.LoggedInUserDetails.userID);
	                        gApzCOB.LoggedInUserDetails = window.LoggedInUserDetails;
	                        //window.LoggedInUserDetails = loginRes;
	                        //window.LoggedInUserDetails.kmId = customerId;
	                        //gApzCOB.LoggedInUserDetails = window.LoggedInUserDetails;
	                        // window.LoggedInUserDetails.kmId = 'GK15661';
	                        window.LoggedInUserDetails.userID = gApzCOB.LoggedInUserDetails.loginResponse.userDet.id
	                        window.kmBmRole = gApzCOB.LoggedInUserDetails.loginResponse.addInfo1;
	                        window.userRole = gApzCOB.LoggedInUserDetails.loginResponse.addInfo1;
	                        window.currentUserRole = gApzCOB.LoggedInUserDetails.loginResponse.addInfo1;
	                        userRoleIfDeoAvailable = gApzCOB.LoggedInUserDetails.loginResponse.userDet.privs.roles;
	                        window.userName = LoggedInUserDetails.loginResponse.userDet.name;
	                        window.userBranchID = gApzCOB.LoggedInUserDetails.loginResponse.addInfo2;
	                        window.userBranchName = gApzCOB.LoggedInUserDetails.loginResponse.addInfo3;
	                        userRoleIfDeoAvailable = gApzCOB.LoggedInUserDetails.loginResponse.userDet.privs.roles;
	                        isCashierRoleAvailable = userRoleIfDeoAvailable;
	                        apz.setElmValue("APZCBO__BaseScreens__el_txt_80", LoggedInUserDetails.loginResponse.userDet.name);
	                        apz.setElmValue("APZCBO__BaseScreens__el_txt_81", LoggedInUserDetails.loginResponse.userDet.id);
	                        apz.setElmValue("APZCBO__BaseScreens__el_txt_89", LoggedInUserDetails.loginResponse.userDet.name.substring(0, 1));
	                        if (userRole !== 'CASHIER') {
	                            userRoleassigned = true;
	                            ApzCOB.FetchLov('USERROLECASHIER')
	                            window.kmBmRole = userRole;
	                        }
	                        if (window.isNwAvailable) {
	                            if (apz.deviceType === 'WEB') {
	                                //added for UNAP-1504 to change userRole for KM in WEB login if Cashier role is present based on Bank confirmation
	                                ApzCOB.assignUserRoleAsCashier();
	                                if (userRole === "CRT") {
	                                    //ApzCOB.FetchApplicationList();
	                                    ApzCOB.launchMicroApp('Dashbo', 'dashboard', gAppId + '__BaseScreens__BaseDIV', '');
	                                } else if (window.userRole == 'AM' || window.userRole == 'RM' | window.userRole == 'ZM' || window.userRole == 'DM' || window.userRole == 'SH') {
	                                    if (['AM', 'RM', 'DM', 'ZM', 'SH'].includes(userRole) && apz.deviceType !== 'WEB') {
	                                        apz.stopLoader();
	                                        ApzCOB.fnDisplayMsg('User is not allowed for Phone', "E", ApzCOB.ReloadApp);
	                                        return;
	                                    }else{
	                                     ApzCOB.dashboardAppListAPI();   
	                                    }
	                                }else if (userRole === "RPC") {
	                                    ApzCOB.FetchIncomeApplicationList();
	                                    //ApzCOB.launchMicroApp("Kendra", "UserDetails", 'APZCBO__BaseScreens__BaseDIV', '');
	                                } else if (userRole == "IT_HELPDESK" || userRole == "HELPDESK" || userRole == "ROIT") {
	                                    ApzCOB.launchMicroApp('Dashbo', 'dashboard', gAppId + '__BaseScreens__BaseDIV', '');
	                                    //ApzCOB.launchMicroApp("Kendra", "UserDetails", 'APZCBO__BaseScreens__BaseDIV', '');
	                                } else {
	                                    if (window.userRole.toUpperCase() === "CASHIER") {
	                                        window.userRole = window.userRole.toUpperCase()
	                                        $('#APZCBO__BaseScreens__userRole').addClass('sno');
	                                    }
	                                    ApzCOB.fetchUserRoles();
	                                    // ApzCOB.dashboardAppListAPI();
	                                    ApzCOB.fetchKendraDetails(window.LoggedInUserDetails.userID);
	                                }
	                            } else {
	                                if (window.userRole === "CASHIER") {
	                                    $('#APZCBO__BaseScreens__userRole').addClass('sno');
	                                }
	                                ApzCOB.fetchUserRoles();
	                                ApzCOB.fetchKendraDetails(window.LoggedInUserDetails.userID);
	                            }
	                            if (window.userRole === "BM" && window.userRole === "KM") {
	                                window.KendraApp.userList=[];
	                                $('#APZCBO__BaseScreens__userRole').removeClass('sno');
	                                $('#APZCBO__BaseScreens__userRole').val('BM');
	                                 ApzCOB.FetchUserList();
	                            }
	                            //ApzCOB.dashboardAppListAPI();
	                        } else {
	                            ApzCOB.getPref('KendraResponse');
	                        }
	                        if (apz.deviceType !== 'WEB') {
	                            apz.app.BaseScreens.UESetUserInfo(window.LoggedInUserDetails.userID);
	                            apz.app.BaseScreens.UESetUserProp(window.userName, window.userRole, window.userBranchID, window.userBranchName,
	                                "");
	                        }
	                        /**SelfAssisted related Changes Starts***/
	                        //  ApzCOB.customlogincallback();
	                        /**SelfAssisted related Changes Ends***/
	                    } else {
	                        apz.stopLoader();
	                        $("#Login__Login__userName").val("");
	                        $("#Login__Login__password").val("");
	                        /*if (params.res.loginResponse.attemptsLeft > 0) {
	                            ApzCOB.fnDisplayMsg("Please enter correct password. " + (params.res.loginResponse.attemptsLeft).toString() +
	                                " attempts left", "E", apz.app.Login.CancelCaptchalogin);
	                        } else {
	                            ApzCOB.fnDisplayMsg(
	                                "User is either Locked or Inactive. Please use forgot password option to unclock or contact Administrator.",
	                                "E", apz.app.Login.CancelCaptchalogin);
	                        }*/
	                        if (params.res.loginResponse.attemptsLeft > 0) {
	                            ApzCOB.fnDisplayMsg("Please enter correct password. " + (params.res.loginResponse.attemptsLeft + 1).toString() +
	                                " attempts left", "E", apz.app.Login.CancelCaptchalogin);
	                        } else if (params.res.loginResponse.attemptsLeft === 0) {
	                            ApzCOB.fnDisplayMsg("Your account gets locked out if you make one more wrong attempt", "E", apz.app.Login
	                                .CancelCaptchalogin);
	                        } else {
	                            ApzCOB.fnDisplayMsg(
	                                "User is either Locked or Inactive. Please use forgot password option to unclock or contact Administrator.",
	                                "E", apz.app.Login.CancelCaptchalogin);
	                        }
	                    }
	                } else if (!apz.isNull(params.errors)) {
	                    apz.stopLoader();
	                    $("#Login__Login__userName").val("");
	                    $("#Login__Login__password").val("");
	                    $("#Login__Login__LoginCaptchaInput").val("");
	                    if (params.resFull.appzillonErrors[0].errorCode === "APZ-SMS-EX-016") {
	                        apz.app.Login.CancelCaptchalogin();
	                        ApzCOB.fnDisplayMsg(params.errors[0].errorMessage.split("-")[0], "E");
	                    } else if (params.resFull.appzillonErrors[0].errorCode === "APZ-DM-040") {
	                        ApzCOB.fnDisplayMsg("Please enter a valid registered User Name", "E", apz.app.Login.RefreshImageCaptcha);
	                    } else if (params.resFull.appzillonErrors[0].errorCode === "APZ-DM-031") {
	                        ApzCOB.fnDisplayMsg("Password has expired. Please set your password again.", "E", apz.app.Login.Setpassword);
	                    } else if (params.resFull.appzillonErrors[0].errorCode === "APZ-DM-013" || params.resFull.appzillonErrors[0]
	                        .errorCode === "APZ-SMS-EX-005") {
	                        ApzCOB.fnDisplayMsg(
	                            "User is either Locked or Inactive. Please use forgot password option to unclock or contact Administrator.",
	                            "E", apz.app.Login.CancelCaptchalogin);
	                    } else {
	                        if (params.errors[0].errorMessage === 'User does not exist in database') {
	                            ApzCOB.fnDisplayMsg("User doesn't exists", "E");
	                        } else {
	                            ApzCOB.fnDisplayMsg(params.errors[0].errorMessage, "E");
	                        }
	                    }
	                }
	            } catch (e) {
	                apz.stopLoader();
	                try {
	                    if (!apz.isNull(params.errors)) {
	                        ApzCOB.fnDisplayMsg(params.errors[0].errorMessage, "E");
	                    } else {
	                        if (apz.isNull(params.resFull.appzillonErrors[0].errorMessage)) {
	                            ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                        } else {
	                            if (params.resFull.appzillonErrors[0].errorCode === "APZ-CNT-231" || params.resFull.appzillonErrors[0]
	                                .errorCode === "APZ-CNT-232") {
	                                //
	                            } else {
	                                ApzCOB.fnDisplayMsg(params.resFull.appzillonErrors[0].errorMessage, "E");
	                            }
	                        }
	                    }
	                } catch (e) {
	                    ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                }
	            }
	        },
	        customlogincallback: function(params) {
	            try {
	                if ($('body').hasClass('modal-open')) {
	                    $('body').removeClass('modal-open')
	                }
	                if (!apz.isObjectEmpty(gApzCOB.LoggedInUserDetails.loginResponse)) {
	                    //if (gApzCOB.LoggedInUserDetails.DashboardObj.apiResponse.APZCBO__FetchRole.apiResponse.ResponseHeader.ResponseCode === "0") {
	                    /*var roleresp = JSON.parse(gApzCOB.LoggedInUserDetails.DashboardObj.apiResponse.APZCBO__FetchRole.apiResponse.ResponseBody
	                        .responseObj);*/
	                    // window.FetchRole = roleresp.map.roleAccessMap;
	                    //gApzCOB.FetchRole = window.FetchRole;
	                    //window.currentRole = roleresp.map.roleAccessMap.roleId;
	                    //gApzCOB.workflow.currentRole = window.currentRole;
	                    // window.Widget = roleresp.map.appMasterData.myArrayList;
	                    //gApzCOB.Widget = window.Widget;
	                    var branchName = '';
	                    if (LoggedInUserDetails.loginResponse.addInfo3.length <= 13) {
	                        branchName = LoggedInUserDetails.loginResponse.addInfo3;
	                    } else {
	                        branchName = LoggedInUserDetails.loginResponse.addInfo3.substring(0, 11) + '...';
	                    }
	                    $('#APZCBO__BaseScreens__el_txt_75_txtcnt').text(branchName);
	                    //window.approvalMatrix = ApzCOB.GetCommonCodes("APPROVALMATRIX");
	                    window.approvalMatrix.APPROVALMATRIX = window.approvalMatrixLocal;
	                    window.approvalMatrix.APPROVALMATRIX = window.approvalMatrix.APPROVALMATRIX.map(obj => ({
	                        ...obj, // Spread existing properties
	                        SanctionRoleList: obj.SanctionRole.split("~"),
	                        RecommandRoleList: obj.RecommandRole ? obj.RecommandRole.split("~") : []
	                    }));
	                    ApzCOB.launchMicroApp('Dashbo', 'dashboard', gAppId + '__BaseScreens__BaseDIV', '');
	                    // ApzCOB.LaunchRoleDashboard(roleresp);
	                    /*} else {
	                        apz.stopLoader();
	                        ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                    }*/
	                } else {
	                    apz.stopLoader();
	                    ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                }
	            } catch (e) {
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	            }
	        },
	        LaunchRoleDashboard: function(roleresp) {
	            window.WidgetInProgress = [];
	            window.WidgetSubmitted = [];
	            window.WidgetApproved = [];
	            window.WidgetPending = [];
	            window.WidgetRejected = [];
	            window.WidgetDeleted = [];
	            gApzCOB.WidgetInProgress = [];
	            gApzCOB.WidgetApproved = [];
	            gApzCOB.WidgetPending = [];
	            gApzCOB.WidgetRejected = [];
	            gApzCOB.WidgetDeleted = [];
	            try {
	                /* window.WidgetInProgress = roleresp.map['inprogress'];
	                 gApzCOB.WidgetInProgress = window.WidgetInProgress;
	                 window.WidgetApproved = roleresp.map['completed'];
	                 gApzCOB.WidgetApproved = window.WidgetApproved;
	                 window.WidgetPending = roleresp.map['pending'];
	                 gApzCOB.WidgetPending = window.WidgetPending;
	                 window.WidgetRejected = roleresp.map['rejected'];
	                 gApzCOB.WidgetRejected = window.WidgetRejected;
	                 window.WidgetDeleted = roleresp.map['deleted'];
	                 gApzCOB.WidgetDeleted = window.WidgetDeleted;*/
	                roleresp.map['inprogress']['myArrayList'].filter(function(el) {
	                    window.WidgetInProgress.push(el.map);
	                    gApzCOB.WidgetInProgress = window.WidgetInProgress;
	                })
	                roleresp.map['completed']['myArrayList'].filter(function(el) {
	                    window.WidgetApproved.push(el.map);
	                    gApzCOB.WidgetApproved = window.WidgetApproved;
	                })
	                roleresp.map['pending']['myArrayList'].filter(function(el) {
	                    window.WidgetPending.push(el.map);
	                    gApzCOB.WidgetPending = window.WidgetPending;
	                })
	                roleresp.map['rejected']['myArrayList'].filter(function(el) {
	                    window.WidgetRejected.push(el.map);
	                    gApzCOB.WidgetRejected = window.WidgetRejected;
	                })
	                roleresp.map['deleted']['myArrayList'].filter(function(el) {
	                    window.WidgetDeleted.push(el.map);
	                    gApzCOB.WidgetDeleted = window.WidgetDeleted;
	                })
	                /*  gApzCOB.Widget.forEach(function(Wid) {
	                                  if (Wid.map.applicationStatus === "INPROGRESS") {
	                                      window.WidgetInProgress.push(Wid.map);
	                                      gApzCOB.WidgetInProgress = window.WidgetInProgress;
	                                  }
	                                  /* else if (Wid.map.applicationStatus === "APPROVED") {
	                                                      window.WidgetSubmitted.push(Wid.map);
	                                                      gApzCOB.WidgetSubmitted = window.WidgetSubmitted;
	                                                  } */
	                /*  else if (Wid.map.applicationStatus === "APPROVED") {
	                                window.WidgetApproved.push(Wid.map);
	                                gApzCOB.WidgetApproved = window.WidgetApproved;
	                            } else if (Wid.map.applicationStatus === "PENDING") {
	                                window.WidgetPending.push(Wid.map);
	                                gApzCOB.WidgetPending = window.WidgetPending;
	                            } else if (Wid.map.applicationStatus === "REJECTED") {
	                                window.WidgetRejected.push(Wid.map);
	                                gApzCOB.WidgetRejected = window.WidgetRejected;
	                            } else if (Wid.map.applicationStatus === "DELETED") {
	                                window.WidgetDeleted.push(Wid.map);
	                                gApzCOB.WidgetDeleted = window.WidgetDeleted;
	                            }
	                        });*/
	                if (gApzCOB.FetchRole.accessPermission === "B") {
	                    //Showing maker checker only for Both role
	                    apz.stopLoader();
	                    $("#" + LoginScrId + "MakerCheckDIV").removeClass("sno");
	                    $("#" + LoginScrId + "LoginBody").addClass("sno");
	                } else {
	                    //Hiding maker checker div for other roles
	                    if (apz.currAppId === 'Login') {
	                        apz.app.Login.OnClickMakerChecker();
	                    }
	                }
	            } catch (e) {
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	            }
	        },
	        GetCommonCodes: function(paramname, codetype) {
	            //paramname - CM_CODE
	            //codetype - CODE_TYPE
	            //KrishnaChanges
	            if (apz.isNull(codetype)) {
	                codetype = "COMM";
	            }
	            var GetCommonCodes = "";
	            for (var i = 0; i < gApzCOB.CommonCodes.length; i++) {
	                if (paramname === gApzCOB.CommonCodes[i].paramName && gApzCOB.CommonCodes[i].codeType === codetype) {
	                    try {
	                        GetCommonCodes = JSON.parse(gApzCOB.CommonCodes[i].paramValue);
	                    } catch (e) {
	                        GetCommonCodes = gApzCOB.CommonCodes[i].paramValue;
	                    }
	                }
	            }
	            return GetCommonCodes;
	        },
	        toggleModal: function(modalID) {
	            var params = {
	                "targetId": modalID,
	                "callBack": "",
	                "callBackObj": ""
	            };
	            apz.toggleModal(params);
	            //$('div').removeClass('modal-backdrop fade show');
	        },
	        executeFunByName: function(functionName, paramres1, paramres2) {
	            var namespaces = [window].concat(functionName.split('.')).reduce(function(prev, curr) {
	                return prev[curr];
	            });
	            namespaces(paramres1, paramres2);
	        },
	        CommonCodeParams: function() {
	            var req = {
	                "apiRequest": {
	                    "interfaceName": "",
	                    "appId": gAppId,
	                    "userId": "",
	                    "requestObj": {
	                        "accessType": "",
	                        "code": ""
	                    }
	                }
	            }
	            ApzCOB.serverBuildParam(gAppId, 'CommonCodeParams', "N", "N", req, false, ApzCOB.CommonCodeParamssCB);
	        },
	        CommonCodeParamssCB: function(params) {
	            // apz.stopLoader();
	            if (ApzCOB.handleServiceCallBacks(params)) {
	                if (!apz.isNull(params.res.APZCBO__CommonCodeParams_Res.apiResponse.ResponseBody.responseObj)) {
	                    //var tempArr = [];
	                    window.CommonCodes = JSON.parse(params.res.APZCBO__CommonCodeParams_Res.apiResponse.ResponseBody.responseObj);
	                    gApzCOB.CommonCodes = window.CommonCodes;
	                    ApzCOB.setPref('CommonCodes', gApzCOB.CommonCodes);
	                    appStage = 'preCommomCode';
	                    // window.workFlowConf = ApzCOB.GetCommonCodes("SCREENTOWORKFLOWID1").SCREENTOWORKFLOWID;
	                    // gApzCOB.workFlowConf = window.workFlowConf
	                    /*gApzCOB.CommonCodes.forEach(function(e,
	                    i) { //Convert all keys to uppercase since keys from common code are in upper case, keys from property file are in lower case
	                        e.paramName = e.paramName.toUpperCase();
	                    })
	                    window.demoMode = ApzCOB.GetCommonCodes("DEMOMODE");
	                    window.createapplnworkflowConf = ApzCOB.GetCommonCodes("WORKFLOWDEFINITIONMAPPER");
	                    gApzCOB.demoMode = window.demoMode;
	                    gApzCOB.CobCallCBS = ApzCOB.GetCommonCodes("COBCALLCBSFLAG");
	                    gApzCOB.DepCallCBS = ApzCOB.GetCommonCodes("DEPCALLCBSFLAG");
	                    gApzCOB.fundAccount = ApzCOB.GetCommonCodes("FUNDACCOUNT");
	                    window.WidgetConf = ApzCOB.GetCommonCodes("WIDGETSBO").WIDGETSBO;
	                    window.Ocr_Required = ApzCOB.GetCommonCodes("KYCVERIFICATION")["KYCVERIFICATION"]["OCR_Required"] === "Y" ? true : false;
	                    window.inSessionStoreMasterEnabled = ApzCOB.GetCommonCodes("APPCONTROL")["LOCALSAVE"][0].split('~')[1] === 'Y' ? true :
	                    false; 
	                    apz.app.BaseScreens.getCommomCodeBasedOnProduct();*/
	                    ApzCOB.prepareCommonCode();
	                    ApzCOB.fetchLoanProduct();
	                    //apz.app.BaseScreens.sideBarMenu();
	                    //ApzCOB.getDefaultNationalId();
	                    // ApzCOB.changeLanguage();
	                    //ApzCOB.LaunchConfiguredScreens();
	                    /**SelfAssisted related Changes Ends***/
	                } else {
	                    apz.stopLoader();
	                    ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E", "");
	                }
	            } else {
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E", "");
	            }
	            if (apz.isNull(gApzCOB.blocklistmsg)) {
	                apz.stopLoader();
	                gApzCOB.blocklistmsg = "Currently the service is unavailable. Please try after sometime.";
	            }
	        },
	        getDefaultNationalId: function(params) {
	            var Data = ApzCOB.GetCommonCodes("KYCVERIFICATION")["KYCVERIFICATION"];
	            Data["DOCS"].forEach(function(el) {
	                Object.getOwnPropertyNames(el).forEach(function(l, k) {
	                    if (Object.getOwnPropertyNames(el)[k].split('~')[1] === 'Y') {
	                        window.selectedNationalID = Object.getOwnPropertyNames(el)[k].split('~')[0];
	                    }
	                })
	            })
	        },
	        getDescfromLitCode: function(litcode) {
	            var littext = "";
	            if (litcode === "LIT_TECHNICALDIFF") {
	                littext = apz.lits[apz.appId][litcode];
	                return littext;
	            } else {
	                if (apz.isNull(apz.lits[apz.currAppId][apz.language])) {
	                    littext = apz.lits[apz.appId][litcode];
	                } else if (!apz.isNull(apz.lits[apz.currAppId][apz.language][litcode])) {
	                    littext = apz.lits[apz.currAppId][apz.language][litcode];
	                } else {
	                    littext = apz.lits[apz.appId][litcode];
	                }
	                return littext;
	            }
	        },
	        validatePinCombinations: function(pval) {
	            var d = ("" + pval).split("").map(function(t) {
	                return parseInt(t)
	            });
	            if ((d[1] === ((d[0] + 1) % 10)) && (d[2] === ((d[1] + 1) % 10))) {
	                /* Validation for Continuos series in ascending order Ex:- 1234, 2345 etc*/
	                return false;
	            } else if ((d[1] === d[0]) && (d[1] === d[2]) && (d[2] === d[3])) {
	                /* Validation for all equal Ex:- 1111, 9999 etc*/
	                return false;
	            } else if ((d[1] === d[0]) && (d[3] === d[2])) {
	                /* Validation for consecutive equal Ex:- 1122, 9988 etc*/
	                return false;
	            } else if ((d[1] === ((d[0] - 1) % 10)) && (d[2] === ((d[1] - 1) % 10))) {
	                /* Validation for Continuos series in ascending order Ex:- 1234, 2345 etc*/
	                return false;
	            } else if ((d[2] === ((d[1] + 1) % 10)) && (d[3] === ((d[2] + 1) % 10))) {
	                /* Validation for Continuos series in ascending order Ex:- 5234, 3567 etc*/
	                return false;
	            }
	            /* else if ((d[1] === ((d[0] - 1) % 10)) && (d[2] === ((d[1] - 1) % 10))) {
	                // Validation for Continuos series in descending order Ex:- 9876, 5432, 5431 etc
	                return false;
	            } */
	            else if ((d[2] === ((d[1] - 1) % 10)) && (d[3] === ((d[2] - 1) % 10))) {
	                /* Validation for Continuos series in descending order Ex:- 1987, 6432 etc*/
	                return false;
	            } else if ((d[1] === d[0]) || (d[3] === d[2]) || (d[1] === d[2])) {
	                /* Validation for Continuos eqaul series Ex:- 1588, 1158 etc*/
	                return false;
	            } else {
	                return true;
	            }
	        },
	        changeLanguage: function(pthis) {
	            /**SelfAssisted related Changes Starts***/
	            /* if (window.languageCallCount === 1) {
	                 window.languageCallCount = 0;
	             } else {
	                 var json = {};
	                 $.each(window.langArr, function(i, k) {
	                     if (k.desc === $('#' + pthis.id).val()) {
	                         apz.language = k.val;
	                         window.gSelLang = k.val;
	                     }
	                 })*/
	            // apz.changeLanguage(apz.language, apz.appId);
	            var json = {};
	            apz.changeLanguage(apz.language, apz.appId);
	            if (CURRENT_STAGE_NO > 0) {
	                var languages = ApzCOB.GetCommonCodes('APPCONTROL', "COMM")['LANGUAGE'];
	                languages.forEach(function(e, i) {
	                    if (e.value === apz.language) {
	                        var apLang = e
	                        languages.splice(i, 1)
	                        languages.unshift(apLang)
	                    }
	                })
	                $.each(languages, function(i, k) {
	                    if (ApzCOB.getDescfromLitCode(k.desc) === $('#' + pthis.id).val()) {
	                        apz.language = k.value;
	                        window.gSelLangDesc = ApzCOB.getDescfromLitCode(k.desc);
	                    }
	                })
	            }
	            json.userPrefs = {
	                "LANGUAGE": apz.language
	            };
	            json.id = "setUserPrefs";
	            json.callBack = ApzCOB.changeLanguageCB;
	            apz.ns.setUserPrefs(json);
	            /**SelfAssisted related Changes Ends***/
	        },
	        changeLanguageCB: function() {
	            window.languageCallCount = 1;
	            var req = {
	                "apiRequest": {
	                    "interfaceName": "FetchLanguageLIT",
	                    "requestObj": {
	                        "languageCode": apz.language.toUpperCase()
	                    }
	                }
	            }
	            ApzCOB.serverBuildParam(gAppId, 'FetchLanguageLIT', 'N', 'N', req, false, ApzCOB.FetchLanguageLITCB);
	        },
	        FetchLanguageLITCB: function(params) {
	            apz.stopLoader();
	            try {
	                var shouldAppLoad = "";
	                //var shouldAppLoad = apz.isNull(window.gDocumentTexts) ? false : true;
	                shouldAppLoad = (firstLang === apz.language) ? false : true;
	                if (ApzCOB.handleServiceCallBacks(params)) {
	                    var ifaceName = ApzCOB.GetInterfaceResMap(params);
	                    window.gDocumentTexts = JSON.parse(params.res[ifaceName].apiResponse.ResponseBody.responseObj);
	                    window.gDocumentTexts = JSON.parse(gDocumentTexts[0].paramValue);
	                    if (apz.currAppId === "KYCVer") {
	                        apz.app.KYCVerification.alterOnShown();
	                    }
	                }
	                if (apz.language.toUpperCase() === "AR") {
	                    $('body').addClass('arabic')
	                } else {
	                    $('body').removeClass('arabic')
	                }
	                window.ResetLOVNAMES = false;
	                ApzCOB.FetchLovmsater();
	                if (shouldAppLoad) {
	                    ConfigureScrJson.filter(function(e, i) {
	                        if (!apz.isNull(e.confParamName) && !apz.isNull(STAGES[CURRENT_STAGE_NO - 1]) && e.confParamName === STAGES[
	                                CURRENT_STAGE_NO - 1].split('~')[0]) {
	                            ApzCOB.launchMicroApp(e.MicroAppID, e.ScreenID, "APZCBO__BaseScreens__STAGE1", "");
	                            return;
	                        }
	                    })
	                    if (apz.currAppId === "KYCVer") {
	                        apz.app.KYCVerification.alterOnShown();
	                    }
	                }
	            } catch (e) {
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	            }
	        },
	        addAccScr: function(accScrId, subHeaderId) {
	            if (!apz.isNull(accScr) && !apz.isNull(accScrId)) {
	                if (!window.accScr.split('|').length <= 1) {
	                    window.accScr = accScr.concat("|") + accScrId
	                }
	            } else {
	                window.accScr = accScrId
	            }
	            if (!apz.isNull(subHeader)) {
	                if (!window.subHeader.split('|').length <= 1) {
	                    window.subHeader = subHeader.concat("|") + subHeaderId
	                }
	            } else {
	                window.subHeader = subHeaderId
	            }
	        },
	        keypadchangesforIos: function() { // for hidding footer while showing keypad for IOS
	            var inputtextarea = 'input,textarea';
	            $(inputtextarea).on('focus', function(event) {
	                if (!$(inputtextarea).hasClass('sub-elt') && apz.deviceOs === "iOS") {
	                    apz.readjustHeight();
	                    if (apz.deviceType !== 'WIN8.1PHONE') {
	                        newHeight = $(window).height();
	                        $('body').addClass('keypadopen');
	                        apz.readjustHeight();
	                    }
	                }
	            });
	            $(inputtextarea).on('blur', function(event) {
	                if (!$(inputtextarea).hasClass('sub-elt') && apz.deviceOs === "iOS") {
	                    $('body').removeClass('keypadopen');
	                    apz.readjustHeight();
	                }
	            });
	        },
	        checkModalOpen: function() {
	            var amodalscreen = false;
	            var amodalwindow = false;
	            if (!$("#APZRMB__PostLogin_BaseScreen__MBSubMenu").is(":visible")) {
	                $(".modalscreen").each(function() {
	                    if ($(this).css("display") === "block") {
	                        amodalscreen = true;
	                    }
	                });
	                $(".modalwindow").each(function() {
	                    if ($(this).css("display") === "block") {
	                        amodalwindow = true;
	                    }
	                });
	                $(".modal").each(function() {
	                    if ($(this).css("display") === "block") {
	                        amodalwindow = true;
	                    }
	                });
	            }
	            if (amodalscreen || amodalwindow) {
	                return true;
	            } else {
	                return false;
	            }
	        },
	        checkCalendarOpen: function() {
	            var acalendaropen = false;
	            $(".ui-datepicker").each(function() {
	                if ($(this).css("display") === "block") {
	                    acalendaropen = true;
	                }
	            });
	            return acalendaropen;
	        },
	        isAllowBackPressed: function() {
	            if ((ApzCOB.checkModalOpen()) || ($('#apzloader').css('display') === 'block') || ApzCOB.checkCalendarOpen()) {
	                return false;
	            }
	            return true;
	        },
	        getLitDescFrCommonCode: function(arrVal, arrName) {
	            if (!apz.isNull(arrVal)) {
	                window.DescArr = [];
	                $.each(arrVal, function(i, k) {
	                    var Obj = {};
	                    if (k.desc !== undefined) {
	                        Obj.value = k.value
	                        Obj.desc = apz.lits[apz.currAppId][apz.language][k.value];
	                    } else {
	                        Obj.value = apz.lits[apz.currAppId][apz.language][k.value];
	                    }
	                    DescArr.push(Obj)
	                })
	            }
	            return DescArr;
	        },
	        changePostLoginLanguage: function(userLanguage) {
	            if (!apz.isNull(userLanguage)) {
	                apz.changeLanguage(userLanguage, gAppId);
	            } else {
	                apz.changeLanguage(window.gSelLang, gAppId);
	            }
	        },
	        getLitFrDesc: function(objVal, language) {
	            var obj = apz.lits["SerReq"][apz.language];
	            var value = objVal;
	            var keyValue = Object.keys(obj).filter(function(k) {
	                if (obj[k] === value) {
	                    return apz.lits["SerReq"][language][k];
	                }
	            })[0];
	            return apz.lits["SerReq"][language][keyValue];
	        },
	        EnterKeyPress: function(inputId, funcName, modalId) {
	            $(inputId).keypress(function(e) {
	                if (e.which === 13 && apz.deviceType === "WEB") {
	                    funcName: funcName();
	                }
	            });
	        },
	        FormatAmt: function(pele, params) {
	            for (var i = 0; i < params.length; i++) {
	                pele.forEach(function(e) {
	                    var ele = e.id;
	                    if (params[i][ele] !== undefined) {
	                        params[i][ele] = ApzCOB.fn_unFormatAmount(params[i][ele]);
	                        params[i][ele] = ApzCOB.fn_FormatAmount(params[i][ele], params[i].currency);
	                    } else {
	                        for (var m = 0; m < params[i].dynamicScrData.length; m++) {
	                            if (ApzCOB.getDescfromLitCode(params[i].dynamicScrData[m].labelName) === ele || params[i].dynamicScrData[
	                                    m].labelName === ele) {
	                                if (params[i].dynamicScrData[m].value.split(" ").length === 1) {
	                                    var Amt = ApzCOB.fn_unFormatAmount(params[i].dynamicScrData[m].value.split(" ")[0]);
	                                    params[i].dynamicScrData[m].value = params[i].currency + " " + ApzCOB.fn_unFormatAmount(Amt);
	                                    params[i].dynamicScrData[m].value = params[i].currency + " " + ApzCOB.fn_FormatAmount(Amt,
	                                        params[i].currency);
	                                } else {
	                                    var Amt1 = ApzCOB.fn_unFormatAmount(params[i].dynamicScrData[m].value.split(" ")[1]);
	                                    params[i].dynamicScrData[m].value = params[i].dynamicScrData[m].value.split(" ")[0] + " " +
	                                        ApzCOB.fn_unFormatAmount(Amt1);
	                                    params[i].dynamicScrData[m].value = params[i].dynamicScrData[m].value.split(" ")[0] + " " +
	                                        ApzCOB.fn_FormatAmount(Amt1, params[i].currency);
	                                }
	                            }
	                        }
	                    }
	                })
	            }
	        },
	        GenerateDynamicData: function(responseObj, commonCodeFilterData) {
	            var responseArray = [];
	            responseObj.forEach(function(obj) {
	                var newObj = {};
	                var dynamicDataArr = [];
	                Object.entries(obj).forEach(function(key) {
	                    if (key[0].includes('~')) {
	                        var litCode = key[0].split('~')[1];
	                        var label = key[0].split('~')[2];
	                        var obj = {};
	                        obj.labelName = label; //ApzCOB.getDescfromLitCode(label);
	                        obj.litCode = litCode;
	                        obj.value = key[1];
	                        obj.order = (1 + dynamicDataArr.length);
	                        dynamicDataArr.push(obj);
	                        key[0] = key[0].split('~')[0];
	                    }
	                    newObj[key[0]] = key[1];
	                });
	                var obj1 = newObj;
	                var filteredArr = ApzCOB.SortDynamicScrData(dynamicDataArr, commonCodeFilterData);
	                obj1.dynamicScrData = filteredArr;
	                responseArray.push(obj1);
	            });
	            return responseArray;
	        },
	        SortDynamicScrData: function(dynamicData, filterData) {
	            var dynamicDataArray = [];
	            filterData.forEach(function(i) {
	                var key = i.key;
	                var flag = i.flag;
	                dynamicData.forEach(function(obj) {
	                    // Check if matching litCode
	                    if (obj.litCode === key && flag === "Y") {
	                        dynamicDataArray.push(obj);
	                    }
	                });
	            });
	            return dynamicDataArray;
	        },
	        FilterDynamicScrData: function(dynamicData, filterData) {
	            var dynamicDataArray = [];
	            dynamicData.forEach(function(obj) {
	                var isObjectFound = false;
	                filterData.forEach(function(i) {
	                    var key = i.key;
	                    if (!obj.labelName.startsWith("LIT")) {
	                        key = ApzCOB.getDescfromLitCode(key);
	                        if (key === obj.labelName && i.flag === "Y") {
	                            isObjectFound = true;
	                            return;
	                        }
	                    } else {
	                        if (i.flag === "Y" && key === obj.labelName) {
	                            isObjectFound = true;
	                            return;
	                        }
	                    }
	                });
	                if (isObjectFound) {
	                    dynamicDataArray.push(obj);
	                }
	            });
	            if (dynamicDataArray.length === 0) {
	                dynamicDataArray = dynamicData;
	            }
	            return dynamicDataArray;
	        },
	        setHeaderHeight: function() {
	            if (apz.deviceType !== "WEB") {
	                $("body").removeClass("dashboard");
	                $("body").removeClass("success-row");
	                $("#" + gPostLoginScreenId + "dashboardHeader").addClass("sno");
	            }
	        },
	        setSuccessScrHeaderHeight: function() {
	            if (apz.deviceType !== "WEB") {
	                $("body").addClass("success-row");
	                $("body").removeClass("otp-image");
	            }
	        },
	        shareContentText: function(context) {
	            var json = {};
	            json.textToShare = context; //"filePath": filePath
	            json.callBack = '';
	            json.action = "text"; //"action": "file"
	            apz.ns.nativeShare(json);
	        },
	        convertBase64ToFile: function(b64Data, fileName) {
	            var json = {};
	            json.id = "BASE64TOFILE";
	            json.callBack = ApzCOB.convertBase64ToFileCB;
	            json.base64 = b64Data;
	            json.fileName = fileName + '.pdf';
	            json.filePath = "docs";
	            apz.ns.base64ToFile(json);
	        },
	        convertBase64ToFileCB: function(params) {
	            var json = {};
	            json.filePath = params.filePath; //"filePath": filePath
	            json.callBack = '';
	            json.action = "file"; //"action": "file"
	            apz.ns.nativeShare(json);
	        },
	        // Function to Format customized Amounts.
	        CustomizedAmountFormatting: function(amount, currency) {
	            var isCurrencyListed = false;
	            var finalAmount;
	            if (gApzCOB.CustomAmountFormatEnabled === 'Y') {
	                window.AmountFormatParams = ApzCOB.GetCommonCodes("AMOUNTFORMAT", "COMM").AMOUNTFORMAT;
	                gApzCOB.AmountFormatParams = window.AmountFormatParams;
	                if (apz.isNull(amount)) {
	                    return;
	                }
	                var unFormattedAmt = ApzCOB.CustomizedAmountUnFormatting(amount.toString());
	                var amt, dec = '';
	                if (gApzCOB.AmountFormatParams.includeDecimal === 'Y') {
	                    var decimalAmount = parseFloat(unFormattedAmt).toFixed(gApzCOB.AmountFormatParams.numberOfDecimals);
	                    amt = decimalAmount.split('.')[0];
	                    dec = decimalAmount.split('.')[1];
	                } else {
	                    amt = parseFloat(unFormattedAmt).toFixed();
	                }
	                //finalAmount = ApzCOB.checkForSeparator(Number(parseInt(amt)).toLocaleString(gApzCOB.AmountFormatParams.locale), dec);
	                if (gApzCOB.AmountFormatParams.includeCurrency === 'Y') {
	                    for (var i = 0; i < gApzCOB.AmountFormatParams.currencyLocale.length; i++) {
	                        var currencyLocaleKey = gApzCOB.AmountFormatParams.currencyLocale[i].key,
	                            currencyLocaleValue = gApzCOB.AmountFormatParams.currencyLocale[i].value;
	                        if (currencyLocaleKey === ApzCOB.GetCommonCodes("PRIMARYCURRENCY", "COMM")) {
	                            finalAmount = ApzCOB.checkForSeparator(new Number(parseInt(amt)).toLocaleString(currencyLocaleValue), dec);
	                            isCurrencyListed = true;
	                            break;
	                        }
	                    }
	                    if (!isCurrencyListed) {
	                        finalAmount = ApzCOB.checkForSeparator(Number(parseInt(amt)).toLocaleString(gApzCOB.AmountFormatParams.locale), dec);
	                    }
	                } else {
	                    finalAmount = ApzCOB.checkForSeparator(Number(parseInt(amt)).toLocaleString(gApzCOB.AmountFormatParams.locale), dec);
	                }
	            } else {
	                finalAmount = amount;
	            }
	            return finalAmount;
	        },
	        // Function to check for amount spearators and included along with decimal separator.
	        checkForSeparator: function(amount, dec) {
	            var updtAmount = amount.replace(/,/g, gApzCOB.AmountFormatParams.amountSeparator);
	            if (gApzCOB.AmountFormatParams.includeDecimal === 'Y') {
	                updtAmount = updtAmount + gApzCOB.AmountFormatParams.decimalSeparator + dec;
	            }
	            return updtAmount;
	        },
	        // Function to Un-Format customized Amounts.
	        CustomizedAmountUnFormatting: function(amount) {
	            var finalAmount = '';
	            var paramAmount = amount;
	            if (!apz.isNull(paramAmount)) {
	                window.AmountFormatParams = ApzCOB.GetCommonCodes("AMOUNTFORMAT", "COMM").AMOUNTFORMAT;
	                gApzCOB.AmountFormatParams = window.AmountFormatParams;
	                if (gApzCOB.AmountFormatParams.includeDecimal === 'Y') {
	                    var splitAmount = paramAmount.split(gApzCOB.AmountFormatParams.decimalSeparator);
	                    var amt = splitAmount[0],
	                        decAmt = splitAmount[1];
	                    var updatedAmount = amt.split(gApzCOB.AmountFormatParams.amountSeparator).join('');
	                    if (apz.isNull(decAmt)) {
	                        paramAmount = parseInt(updatedAmount);
	                    } else {
	                        paramAmount = parseInt(updatedAmount + '.' + decAmt);
	                    }
	                } else {
	                    paramAmount = parseInt(paramAmount.split(gApzCOB.AmountFormatParams.amountSeparator).join(''));
	                }
	                finalAmount = paramAmount.toString();
	            }
	            return finalAmount;
	        },
	        //Set Min and Max values for an element from common codes
	        setMinMaxLength: function(fieldMapArray) {
	            var LENGTHCODE = ApzCOB.GetCommonCodes("FIELDLENGTH", "COMM")["FIELDLENGTH"];
	            fieldMapArray.forEach(function(e, i) {
	                LENGTHCODE.forEach(function(elm, ind) {
	                    if (e.fieldName === elm.split('~')[0]) {
	                        document.getElementById(e.fieldId).setAttribute('minlength', elm.split('~')[1]);
	                        document.getElementById(e.fieldId).setAttribute('maxlength', elm.split('~')[2]);
	                    }
	                })
	            })
	        },
	        // Function to display a message with custom button names
	        DispMsgWithCustomButtons: function(message, MessageType, callback, buttonNameOne, buttonNameTwo) {
	            var params = {};
	            var bO = buttonNameOne;
	            var bT = buttonNameTwo;
	            params.message = message;
	            if (!bO) {
	                bO = "Ok";
	            }
	            if (!bT) {
	                bT = "Cancel";
	            }
	            params.labels = [bO, bT];
	            params.callBack = callback;
	            params.type = MessageType;
	            apz.dispMsg(params);
	        },
	        monthNumToName: function(monthnum) { // to display month by name (MMM)
	            var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
	            return months[monthnum - 1] || '';
	        },
	        fnSortArray: function(sortType, pFilter, interfaceNode,
	        listIdToSort) { //this below function is to sort the list of records in ascending and descending order
	            var lInterface = interfaceNode.split('__').pop().split('_')[0];
	            var lAppId = interfaceNode.split('__')[0];
	            var lSortType = sortType;
	            var screenId = apz.currAppId + "__" + apz.childScr + "__";
	            if (!apz.isObjectEmpty(apz.data.scrdata[interfaceNode]) || interfaceNode === 'Dashbo__PaintData_Res.SearchApp' && apz.data
	                .scrdata['Dashbo__PaintData_Res']['SearchApp'].length >= 2) {
	                var lScreenData = [];
	                if (interfaceNode === 'Dashbo__PaintData_Res.SearchApp') {
	                    lScreenData = apz.data.scrdata['Dashbo__PaintData_Res']['SearchApp']
	                } else {
	                    lScreenData = apz.data.scrdata[interfaceNode];
	                    if (!apz.isObjectEmpty(apz.data.scrdata[interfaceNode]["messageBody"])) {
	                        lScreenData = apz.data.scrdata[interfaceNode]["messageBody"];
	                    }
	                }
	                if (lSortType === "dsort") { //for ascending order
	                    $("#" + screenId + "dsort" + pFilter).addClass('sno');
	                    $("#" + screenId + "asort" + pFilter).removeClass('sno');
	                    lScreenData.sort(function(a, b) {
	                        return apz.app[apz.childScr].genericSort(pFilter, a, b);
	                    });
	                } else if (lSortType === "asort") { //for descending order
	                    $("#" + screenId + "dsort" + pFilter).removeClass('sno');
	                    $("#" + screenId + "asort" + pFilter).addClass('sno');
	                    lScreenData.sort(function(a, b) {
	                        return apz.app[apz.childScr].genericSort(pFilter, b, a);
	                    });
	                }
	                if (lScreenData.length > 0) {
	                    apz.data.loadData(lInterface, lAppId);
	                    if (apz.childScr === 'ManagePayee') {
	                        apz.app.ManagePayee.paintPayeeImageText(apz.data.scrdata.Manage__IPaintBeneficiaryList_Res);
	                    }
	                    $('#' + screenId + listIdToSort).removeClass('sno');
	                }
	            }
	        },
	        //////////////////////////////////////////////////////////////////////////////////   
	        getLocation: function() {
	            ApzCOB.setMapData(locationDetails[0].latitude, locationDetails[0].longitude)
	        },
	        setMapData: function(latitude, longitude) {
	            var req = {
	                "apiRequest": {
	                    "interfaceName": "CobFetchBranches",
	                    "appId": gAppId,
	                    "requestObj": {
	                        "latitude": latitude,
	                        "longitude": longitude
	                    }
	                }
	            };
	            apz.startLoader();
	            ApzCOB.serverBuildParam(gAppId, "FetchBranches", "N", "N", req, true, ApzCOB.branchLocationDetailsCB);
	        },
	        branchLocationDetailsCB: function(params) { //Handels success/failure of branch location service
	            apz.stopLoader();
	            if (params.status) {
	                var plannedResultSet = JSON.parse(params.res.APZCBO__FetchBranches_Res.apiResponse.ResponseBody.responseObj);
	                plannedResultSet.filter(function(item) {
	                    if (item.bankType === "BRANCH") {
	                        BranchArr.push(item);
	                        return;
	                    }
	                });
	                $.each(BranchArr, function(i, k) {
	                    if (BranchArr[i].location === $('#' + BankFacScrId + "branch").val()) {
	                        window.Address = BranchArr[i].address
	                        return;
	                    }
	                })
	            } else {
	                //ApzCOB.fnDisplayMsg("Error", "E", apz.app.BranchPickup.fMapCallBack);
	            }
	        },
	        /////////////////////////////////////////////////////////////////////////////////////////////
	        FetchLovmsater: function() {
	            var req = {
	                "apiRequest": {
	                    "appId": "ALL",
	                    "interfaceName": "",
	                    "userId": ""
	                }
	            };
	            apz.startLoader();
	            ApzCOB.serverBuildParam(gAppId, "FetchLovmaster", "N", "N", req, false, ApzCOB.FetchLovmsaterCB);
	        },
	        FetchLovmsaterCB: function(params) {
	            apz.stopLoader();
	            if (ApzCOB.handleServiceCallBacks(params)) {
	                var iFaceName = ApzCOB.GetInterfaceResMap(params);
	                var response = JSON.parse(params.res[iFaceName].apiResponse.ResponseBody.responseObj);
	                window.LOVNames = response;
	                for (var i = 0; i < window.LOVNames.length; i++) {
	                    ApzCOB.FetchLov(i);
	                }
	            }
	        },
	        //Fetch all dropdown values with respect to that particular stage
	        FetchLov: function(LOVNAME) {
	            var req = {
	                "apiRequest": {
	                    "appId": gAppId,
	                    "requestObj": {
	                        "language": apz.language.toUpperCase(),
	                        "lovName": LOVNAME,
	                        "lovId": ""
	                    }
	                }
	            };
	            if (!userRoleassigned) {
	                apz.startLoader();
	            }
	            ApzCOB.serverBuildParam(gAppId, "FetchLovs", "N", "N", req, false, ApzCOB.FetchLovCB);
	        },
	        //Fetch lovs Service Callback
	        FetchLovCB: function(params) {
	            if (!userRoleassigned) {
	                apz.stopLoader();
	            } else {
	                userRoleassigned = false;
	            }
	            if (ApzCOB.handleServiceCallBacks(params)) {
	                var ifaceName = ApzCOB.GetInterfaceResMap(params);
	                var response = JSON.parse(params.res[ifaceName].apiResponse.ResponseBody.responseObj);
	                gLovs = response
	                /*if (!window.ResetLOVNAMES) {
	                    occupationType = [],
	                        designation = [],
	                        yrsExp = [],
	                        curEmpyrs = [],
	                        relations = [],
	                        noOfyrs = [],
	                        noOfmons = [],
	                        addressType = [],
	                        nameTitle = [],
	                        gender = [],
	                        tinType = [],
	                        tinReason = [],
	                        noOfLeaves = [];
	                }
	                if (response.lovName === "OCCUPATION") {
	                    $.each(JSON.parse(response.lovDtls), function(a, b) {
	                        occupationType.push(b.value)
	                    })
	                    occupationType.unshift(ApzCOB.getDescfromLitCode("LIT_COMM_MSG_PLEASE_SELECT"));
	                }
	                if (response.lovName === "DESIGNATION") {
	                    $.each(JSON.parse(response.lovDtls), function(a, b) {
	                        designation.push(b.value)
	                    })
	                    designation.unshift(ApzCOB.getDescfromLitCode("LIT_COMM_MSG_PLEASE_SELECT"));
	                }
	                if (response.lovName === "RELATIONSHIP") {
	                    $.each(JSON.parse(response.lovDtls), function(a, b) {
	                        relations.push(b.value)
	                    })
	                    relations.unshift(ApzCOB.getDescfromLitCode("LIT_COMM_MSG_PLEASE_SELECT"));
	                }
	                if (response.lovName === "SERVICES") {
	                    $.each(JSON.parse(response.lovDtls), function(a, b) {
	                        noOfLeaves.push(b.value)
	                    })
	                }
	                if (response.lovName === "ADDRESSTYPE") {
	                    $.each(JSON.parse(response.lovDtls), function(a, b) {
	                        addressType.push(b.value)
	                    })
	                }
	                if (response.lovName === "NAMETITLE") {
	                    $.each(JSON.parse(response.lovDtls), function(a, b) {
	                        nameTitle.push(b.value)
	                    })
	                }
	                if (response.lovName === "GENDER") {
	                    $.each(JSON.parse(response.lovDtls), function(a, b) {
	                        gender.push(b.value)
	                    })
	                    gender.unshift(ApzCOB.getDescfromLitCode("LIT_COMM_MSG_PLEASE_SELECT"));
	                }
	                if (response.lovName === "TINTYPE") {
	                    $.each(JSON.parse(response.lovDtls), function(a, b) {
	                        tinType.push(b.value)
	                    })
	                }
	                if (response.lovName === "REASONTIN") {
	                    $.each(JSON.parse(response.lovDtls), function(a, b) {
	                        tinReason.push(b.value)
	                    })
	                }*/
	                if (response.lovName === "DEATHINTIMATIONSTATUS") {
	                    window.deathIntimationStatusLov = JSON.parse(response.lovDtls);
	                }
	                if (response.lovName === "MEETINGDATE") {
	                    // if (JSON.parse(response.lovDtls).length > 0) {
	                    if (JSON.parse(response.lovDtls).MEETINGENABLED.value === 'Y') {
	                        ColMeetingDate = JSON.parse(response.lovDtls).MEETINGENABLED.value;
	                        currMeetDateValues = JSON.parse(response.lovDtls).MEETINGDATE;
	                        let currMeetDate = '';
	                        currMeetDate = isDateSelected ? selectedDay : new Date().toDateString().split(' ')[0].toUpperCase();
	                        if (new Date().getDay() === 6 || new Date().getDay() === 0) {
	                            currMeetDate = businessDays[0].dayShort;
	                        }
	                        for (i = 0; i < currMeetDateValues.length; i++) {
	                            if (currMeetDate === currMeetDateValues[i].key) {
	                                selectedDay = currMeetDateValues[i].key;
	                                FetchMeetingDtRecord = currMeetDateValues[i].value;
	                            }
	                        }
	                    } else {
	                        // FetchMeetingDtRecord = new Date().$format('Y-m-d');
	                        if (JSON.parse(response.lovDtls).DEFAULTMEETINGFLG === 'Y') {
	                            if (new Date().getDay() !== 6 && new Date().getDay() !== 0) {
	                                selectedDefaultDay = new Date().toDateString().split(' ')[0].toUpperCase();
	                            } else {
	                                selectedDefaultDay = businessDays[0].dayShort;
	                            }
	                            FetchMeetingDtRecord = JSON.parse(response.lovDtls).DEFAULTMEETINGDT
	                            selectedDefaultDate = FetchMeetingDtRecord;
	                        } else if (!apz.isNull(collectionServerDate)) {
	                            FetchMeetingDtRecord = collectionServerDate;
	                        } else {
	                            if (new Date().getDay() === 6 || new Date().getDay() === 0) {
	                                currMeetDate = businessDays[0].dayShort;
	                                const today = new Date();
	                                let dayOfWeek = today.getDay();
	                                today.setDate(today.getDate() + (dayOfWeek === 0 ? 1 : dayOfWeek === 6 ? 2 : 0));
	                                FetchMeetingDtRecord = today.$format('Y-m-d')
	                            } else {
	                                FetchMeetingDtRecord = new Date().$format('Y-m-d');
	                            }
	                        }
	                    }
	                    //  }
	                }
	                if (response.lovName === "MEETINGTYPES") {
	                    meetingTypes = [];
	                    $.each(JSON.parse(response.lovDtls), function(a, b) {
	                        meetingTypes.push({
	                            types: b.types
	                        })
	                    })
	                }
	                if (response.lovName === "REPEATCOLLECTION") {
	                    RepeatCollecFlag = '';
	                    RepeatCollecFlag = JSON.parse(response.lovDtls).ENABLED;
	                }
	                if (response.lovName === "DEPOSITPOINTS") {
	                    DepositProduct = [];
	                    $.each(JSON.parse(response.lovDtls), function(a, b) {
	                        DepositProduct.push({
	                            val: b.value
	                        })
	                    })
	                }
	                if (response.lovName === "CASHIERPUSHBACK") {
	                    cashierPushBackReason = [];
	                    $.each(JSON.parse(response.lovDtls), function(a, b) {
	                        cashierPushBackReason.push({
	                            val: b.value
	                        })
	                    })
	                }
	                if (response.lovName === "PARREASONS") {
	                    parReasonsArr = [];
	                    $.each(JSON.parse(response.lovDtls), function(a, b) {
	                        parReasonsArr.push({
	                            reason: b.value
	                        })
	                    })
	                }
	                if (response.lovName === "USERROLECASHIER") {
	                    if (JSON.parse(response.lovDtls).length > 0) {
	                        let curUser = JSON.parse(response.lovDtls);
	                        for (i = 0; i < curUser.length; i++) {
	                            if (curUser[i].value === LoggedInUserDetails.userID) {
	                                userRole = 'CASHIER';
	                            }
	                        }
	                    }
	                }
	                if (response.lovName === "QRTIMER") {
	                    let QRTimerVal = JSON.parse(response.lovDtls);
	                    QRTimerSetVal = QRTimerVal.value;
	                }
	                if (response.lovName === "QRREFRESHTIME") {
	                    let QRRefreshTimerVal = JSON.parse(response.lovDtls);
	                    QRRefreshTimer = QRRefreshTimerVal.value;
	                }
	                // window.ResetLOVNAMES = true;
	            }
	        },
	        showCountrycodeFlag: function(screenId, fieldId) {
	            $('#' + screenId + fieldId).intlTelInput({
	                autoHideDialCode: false,
	                autoPlaceholder: "off",
	                nationalMode: false,
	                preferredCountries: [ApzCOB.GetCommonCodes("COUNTRYCODE", "COMM").COUNTRYCODE[0]
	                    .preferredCountries] /*prefcountries*/ ,
	                utilsScript: "utils.js"
	            });
	            if (ApzCOB.GetCommonCodes("COUNTRYCODE", "COMM").COUNTRYCODE[0].enabled !== "Y") {
	                $('#' + screenId + fieldId).prop('readonly', true)
	            }
	        },
	        //to format the amount onblur
	        formatamount: function(pthis) {
	            var x = $('#' + pthis.id).val();
	            x = x.toString();
	            var lastThree = x.substring(x.length - 3);
	            var otherNumbers = x.substring(0, x.length - 3);
	            if (otherNumbers !== '') {
	                lastThree = ',' + lastThree;
	                var res = otherNumbers.replace(/\B(?=(\d{2})+(?!\d))/g, ",") + lastThree;
	                $('#' + pthis.id).val(res);
	            }
	        },
	        // to unformat the amount on focus
	        unformatamount: function(pthis) {
	            var x = $('#' + pthis.id).val();
	            x = x.replaceAll(",", "");
	            $('#' + pthis.id).val(x);
	        },
	        //on click of edit icon in review & confirm screen will redirect to the particular screen
	        editlaunch: function(param, scrBaseRow, dashRevConf) {
	            apz.startLoader();
	            window.revAndConf = true;
	            window.dashRevConf = dashRevConf;
	            try {
	                /*var totaldivs = $('div[id^= "' + BaseScrId + '' + "STAGE" + '"]').length
	                if (totaldivs > 0) {
	                    for (i = 1; i < totaldivs; i++) {
	                        $("#" + BaseScrId + "STAGE" + i).addClass('sno');
	                        return;
	                    }
	                }*/
	                $('div[id^=' + "'" + BaseScrId + "STAGE" + "'" + ']').addClass('sno')
	                $.each(ConfigureScrJson, function(i, k) {
	                    if (k.confParamName === param) {
	                        if (dashRevConf) {
	                            $('#' + BaseScrId + 'BaseDIV').addClass('sno');
	                            $("#" + BaseScrId + "footerbtnRow").removeClass('sno');
	                            $("#" + BaseScrId + "applnStatus").addClass('sno');
	                            if (apz.isNull(gStates)) {
	                                ApzCOB.FetchStates();
	                            }
	                            if (apz.isNull(gLovs)) {
	                                ApzCOB.FetchLovmsater();
	                            }
	                        }
	                        gApzCOB.userDetails.currentScreen = k.confParamName.concat("~N");
	                        STAGES.filter(function(el) {
	                            if (el.split('~')[0] === param) {
	                                window.CURRENT_STAGE_NAME = param;
	                                window.STAGE_NO = parseInt(el.split('~')[1]) + 1;
	                                window.CURRENT_STAGE_NO = STAGE_NO - 1;
	                                window.PREV_STAGE_NO = CURRENT_STAGE_NO - 1;
	                                window.baseRow = parseInt(el.split('~')[1]) + 1;
	                                window.currRow = baseRow - 1;
	                                window.prevRow = currRow - 1;
	                                $("#" + BaseScrId + "STAGE" + currRow).removeClass('sno')
	                                if (gApzCOB.mainProductGroupCode === 'DEPOSIT') {
	                                    apz.app.BaseScreens.launchMicroApp(k);
	                                } else {
	                                    ApzCOB.launchMicroApp(k.MicroAppID, k.ScreenID, BaseScrId + "STAGE" + currRow, "");
	                                }
	                                // ApzCOB.launchSubScreen(k.ScreenID, BaseScrId + "STAGE" + currRow, "");
	                            }
	                        })
	                        $.each(apz.data.scrdata.APZCBO__IpaintSideBarMenus_Res, function(a, b) {
	                            if (parseInt(b.stageNo) === CURRENT_STAGE_NO) {
	                                $('#' + BaseScrId + 'headerText').text(b.stageName);
	                            }
	                        })
	                    }
	                })
	                // apz.stopLoader()
	            } catch (e) {
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	            }
	        },
	        //Default Mobile Back function with callBack
	        MBbackPressedEvent: function() {
	            if (apz.deviceType !== "WEB") {
	                var json = {
	                    "backButtonEvent": "on"
	                };
	                json.callBack = ApzCOB.MBbackPressedEventCB;
	                json.id = "EventID";
	                apz.ns.detectEvents(json);
	            }
	        },
	        MBbackPressedEventCB: function(params) {
	            if (params.event === "backButton") {
	                if ($('body').hasClass('mdl-opn')) {
	                   return;
	                }
	                if ($('body').hasClass('ajs-no-overflow')) {
	                   return;
	                }
	                //added below check for UNAP-1506
	                if ($('body').hasClass('modal-open')) {
	                   // $('body').removeClass('modal-open')
	                   //ApzCOB.toggleModal($('.modal.in.show').attr('id'));
	                   return;
	                }
	                if ($('#apzloader').is(':visible') && apz.currAppId === 'Widget') {
	                    apz.app.BaseScreens.logout("logout");
	                    apz.stopLoader();
	                } else if ($('#apzloader').is(':visible') && apz.currAppId !== 'Widget') {
	                    ApzCOB.fnDisplayMsg("Do you want to cancel?", "C", apz.app.BaseScreens.backNav);
	                    apz.stopLoader();
	                } else if ($('#Dashbo__dashboard__MBsearchRow').is(':visible')) {
	                    apz.app.BaseScreens.logout("logout");
	                } else if ($('#NEWLOA__NewLoanApplication__memberWiseTab_li').is(':visible')) {
	                    apz.app.NewLoanApplication.onClickBackNavigation();
	                } else if ($('#NEWLOA__AddLoanDetails__stage1').is(':visible')) {
	                    apz.app.AddLoanDetails.edit('stage1');
	                } else if ($('#NEWLOA__AddLoanDetails__stage2').is(':visible')) {
	                    apz.app.AddLoanDetails.edit('stage2');
	                } else if ($('#Income__AddEarningFamilyMem__eariningMembersMainRow').is(':visible')) {
	                    apz.app.AddEarningFamilyMem.backNavigateIncomeDtls(this);
	                } else if ($('#Income__IncomeAssessment__selfDeclareIncRow').is(':visible')) {
	                    apz.app.IncomeAssessment.backNavigateIncomeDtls(this);
	                } else if ($('#Income__MonthlyHouseHoldExp__monthlyExpRow').is(':visible')) {
	                    apz.app.MonthlyHouseHoldExp.backNavigateIncomeDtls(this);
	                } else if ($('#Income__MonthlyHouseHoldExp__inComeSuc').is(':visible')) {
	                    apz.app.CommonScript.closeApp();
	                } else if ($('#NEWLOA__AddLoanDetails__stage3').is(':visible')) {
	                    apz.app.AddLoanDetails.edit('stage3');
	                } else if ($('#NEWLOA__AddLoanDetails__stage4').is(':visible')) {
	                    apz.app.AddLoanDetails.closeApp();
	                } else if ($('#LoanDi__LoanDisbursementList__stage1').is(':visible')) {
	                    apz.app.LoanDisbursementList.backNavStage1();
	                } else if ($('#LoanDi__LoanDisbursementList__stage2').is(':visible')) {
	                    apz.app.LoanDisbursementList.backNavStage2()
	                } else if ($('#LoanDi__LoanDisbursementList__stage3').is(':visible')) {
	                    apz.app.LoanDisbursementList.backNavStage3()
	                } else if ($('#LoanDi__LoanDisbursementList__successDiv').is(':visible') || $('#LoanDi__LoanDisbursementList__searchDiv').is(
	                        ':visible') || $('#LoanDi__LoanDisbursementList__failureDiv').is(':visible')) {
	                    apz.app.LoanDisbursementList.closeApp();
	                } else if ($('#LoanSa__DetailedScreen__loanAppDetRow').is(':visible')) {
	                    apz.app.DetailedScreen.backNavigate();
	                } else if ($('#Income__PendingTask__Stage1').is(':visible')) {
	                    apz.app.PendingTask.backNavigate();
	                } else if ($('#Income__PendingTask__Stage2').is(':visible')) {
	                    apz.app.PendingTask.backNavigateStage2();
	                } else if ($('#Income__RpcPending__MainRow').is(':visible')) {
	                    apz.app.RpcPending.backNavigation();
	                } else if ($('#LoanSa__SuccessScreen__successRow').is(':visible')) {
	                    apz.app.SuccessScreen.closeApp();
	                } else if (apz.currAppId === 'Login') {
	                    ApzCOB.fnDisplayMsg("Do you want to close the App?", "C", apz.app.AddLoanDetails.closeApplication);
	                } else if (apz.currAppId === "KenMet") {
	                    CollectionsCommon.handledeviceBackForCollectionsFlow();
	                } else if (apz.childScr === "Calculator") {
	                    apz.app.Calculator.backNavigation();
	                }
	                /*var index = apz.app.BaseScreens.getStageNofrFirstStage();
	                if (apz.currAppId === "Widget") {
	                    apz.app.BaseScreens.logout("logout");
	                } else {
	                    ApzCOB.backNavigation();
	                }*/
	            }
	        },
	        backNavigationCallBack: function(params) {
	            if (!apz.isNull(params) && params.choice === true) {
	                window.dontPaint = false;
	                window.inSessionStoreEnabled = true; //if yes -> inSessionStoreEnabled = true;
	            } else {
	                window.dontPaint = true;
	                if (inSessionStoreMasterEnabled) {
	                    window.inSessionStore = JSON.parse(JSON.stringify(beforeBack));
	                }
	                window.inSessionStoreEnabled = false; //if no -> inSessionStoreEnabled = false;
	            }
	            var isvalid = false;
	            var stageBreak = false;
	            window.backNav = true;
	            window.revAndConf = false;
	            $("#" + BaseScrId + "applnStatus").addClass('sno');
	            for (var m = STAGES.length - 1; m >= 0; m--) {
	                stageBreak = false;
	                if (!stageBreak) {
	                    ConfigureScrJson.filter(function(i, k) {
	                        if (Number(PREV_STAGE_NO) === parseInt(STAGES[m].split('~')[1].toUpperCase()) && i.confParamName === STAGES[
	                                m].split('~')[0].toUpperCase()) {
	                            $('#' + BaseScrId + 'baseScroll').removeClass('product-screen');
	                            isvalid = apz.app.BaseScreens.checkScreenInMicroapp(i);
	                            if (isvalid) {
	                                if ((window.inSessionStoreEnabled && !apz.isNull(ConfigureScrJson[CURRENT_STAGE_NO - 1]
	                                    .requestFunc))) {
	                                    apz.app.BaseScreens.storeUnsaved(ConfigureScrJson[CURRENT_STAGE_NO - 1].requestFunc)
	                                } //Store unsaved data based on flag and if create request function is present
	                                gApzCOB.userDetails.currentScreen = i.confParamName.concat("~N");
	                                $('#' + BaseScrId + 'STAGE' + currRow).addClass('sno');
	                                $('#' + BaseScrId + 'STAGE' + prevRow).removeClass('sno');
	                                $('#' + BaseScrId + 'headerRow').addClass('sno');
	                                $('#' + BaseScrId + 'footerbtnRow').addClass('sno');
	                                $('#' + BaseScrId + 'headerText').addClass('sno');
	                                if (i.confParamName === "OCCUPATIONDETAILS" && gApzCOB.product !== "CARDS" && gApzCOB.product !==
	                                    "LOAN") {
	                                    if (addNomineeDetails === 'N') {
	                                        window.STAGE_NO = STAGE_NO - 1;
	                                        stageBreak = true;
	                                    }
	                                }
	                                if (i.confParamName === "NOMINEEDETAILS") {
	                                    if (addNomineeDetails === 'N') {
	                                        window.PREV_STAGE_NO = PREV_STAGE_NO - 1;
	                                        stageBreak = true;
	                                        return;
	                                    }
	                                }
	                                /*if (i.ScreenID === 'FixedDeposit' || i.ScreenID === 'RecDeposit') {
	                                    $('#' + BaseScrId + 'viewIntHpl').removeClass('sno');
	                                    $('#' + BaseScrId + 'viewProdHpl').removeClass('sno');
	                                } else {
	                                    $('#' + BaseScrId + 'viewIntHpl').addClass('sno');
	                                    $('#' + BaseScrId + 'viewProdHpl').addClass('sno');
	                                }*/
	                                /*apz.app.BaseScreens.hideNshowbackIcon(PREV_STAGE_NO, i.confParamName);
	                                if (gApzCOB.newCustomerFirstStage === i.confParamName) {
	                                    if (gApzCOB.product === "CARDS") {
	                                        $('#' + BaseScrId + 'backIcon').addClass('sno');
	                                    } else {
	                                        $('#' + BaseScrId + 'backIcon').addClass('sno');
	                                    }
	                                } else {
	                                    $('#' + BaseScrId + 'backIcon').removeClass('sno')
	                                }*/
	                                $('#' + BaseScrId + "continue").removeClass('sno');
	                                $('#' + BaseScrId + "Agree").addClass('sno');
	                                $('#' + BaseScrId + 'backIcon').addClass('sno');
	                                //  $("#" + BaseScrId + "footerbtnRow").removeClass('sno');
	                                if ((otpVerified && (i.confParamName === "CUSTVERIFICATION" || i.confParamName ===
	                                        "CUSTVERIFICATIONDP")) || (pinCodeVerified && i.confParamName === "VALIDATEPINCODE")) {
	                                    window.STAGE_NO = STAGE_NO - 1;
	                                    window.CURRENT_STAGE_NO = STAGE_NO - 1;
	                                    window.PREV_STAGE_NO = CURRENT_STAGE_NO - 1;
	                                    window.baseRow = baseRow - 1;
	                                    window.currRow = baseRow - 1;
	                                    window.prevRow = currRow - 1;
	                                }
	                                /* else if (otpVerified && ) {
	                                                                window.STAGE_NO = STAGE_NO - 1;
	                                                                window.CURRENT_STAGE_NO = STAGE_NO - 1;
	                                                                window.PREV_STAGE_NO = CURRENT_STAGE_NO - 1;
	                                                                window.baseRow = baseRow - 1;
	                                                                window.currRow = baseRow - 1;
	                                                                window.prevRow = currRow - 1;
	                                                            } else if (pinCodeVerified && i.confParamName === "VALIDATEPINCODE") {
	                                                                window.STAGE_NO = STAGE_NO - 1;
	                                                                window.CURRENT_STAGE_NO = STAGE_NO - 1;
	                                                                window.PREV_STAGE_NO = CURRENT_STAGE_NO - 1;
	                                                                window.baseRow = baseRow - 1;
	                                                                window.currRow = baseRow - 1;
	                                                                window.prevRow = currRow - 1;
	                                                            }*/
	                                else if (otpVerified && i.confParamName === "ELIGIBLECARDSLIST") {
	                                    $('#' + BaseScrId + 'STAGE1').html("");
	                                    $('#' + BaseScrId + 'baseRow').removeClass('sno')
	                                    if (CURRENT_STAGE_NO !== 5) {
	                                        ApzCOB.hideDivsOnConfStages();
	                                        ApzCOB.CompletedAndInprogress();
	                                    }
	                                    $.each(apz.data.scrdata.APZCOB__IpaintSideBarMenus_Res, function(a, b) {
	                                        if (parseInt(b.stageNo) === STAGE_NO) {
	                                            $('#' + BaseScrId + 'headerText').text(ApzCOB.getDescfromLitCode(b
	                                            .stageNameLit));
	                                            $('#' + BaseScrId + 'headerText').text(ApzCOB.getDescfromLitCode(
	                                                "LIT_COMM_GREETING_TXT_CONGRATULATIONSFORCARD"));
	                                        }
	                                    })
	                                    $('#' + BaseScrId + 'headerText').removeClass('sno');
	                                    $('#' + BaseScrId + 'footerbtnRow').addClass('sno');
	                                    apz.app.BaseScreens.getDepositRequest(i);
	                                    ApzCOB.launchMicroApp(i.MicroAppID, i.ScreenID, BaseScrId + "STAGE" + prevRow, "");
	                                    apz.app.BaseScreens.configureFirstStage(PREV_STAGE_NO, i.confParamName, i.MicroAppID, i.ScreenID,
	                                        i.Service);
	                                    window.baseRow = baseRow - 1
	                                    window.currRow = baseRow - 1
	                                    window.prevRow = currRow - 1 === 0 ? 1 : currRow - 1
	                                } else {
	                                    if (otpVerified && i.confParamName === "KYCVERIFICATION") {
	                                        $("#Select__SelectProduct__subProducts").addClass("sno");
	                                    }
	                                    //ApzCOB.launchMicroApp(i.MicroAppID, i.ScreenID, BaseScrId + "STAGE" + prevRow, ""); before joint
	                                    $.each(i.Divs, function(a, b) {
	                                        $('#' + i.MicroAppID + '__' + i.ScreenID + '__' + b).removeClass('sno');
	                                    })
	                                    $.each(apz.data.scrdata.APZCBO__IpaintSideBarMenus_Res, function(a, b) {
	                                        if (parseInt(b.stageNo) === Number(PREV_STAGE_NO)) {
	                                            $('#' + BaseScrId + 'headerText').text(ApzCOB.getDescfromLitCode(b
	                                            .stageNameLit));
	                                        }
	                                    })
	                                    ApzCOB.launchMicroApp(i.MicroAppID, i.ScreenID, BaseScrId + "STAGE" + prevRow, "");
	                                    apz.app.BaseScreens.configureFirstStage(PREV_STAGE_NO, i.confParamName, i.MicroAppID, i.ScreenID,
	                                        i.Service);
	                                    window.baseRow = baseRow - 1
	                                    window.currRow = baseRow - 1
	                                    window.prevRow = currRow - 1 === 0 ? 1 : currRow - 1
	                                }
	                                if (i.confParamName === "SELECTPRODUCT") {
	                                    $('#' + BaseScrId + 'footerbtnRow').addClass('sno');
	                                    $('#' + BaseScrId + 'headerRow').addClass('sno');
	                                    $('#' + BaseScrId + 'sidebarCol').addClass('sno');
	                                    $('body').addClass('ProductBase');
	                                }
	                                /*else {
	                                                           $('#' + BaseScrId + 'footerbtnRow').removeClass('sno');
	                                                           $('#' + BaseScrId + 'headerRow').removeClass('sno');
	                                                           $('#' + BaseScrId + 'sidebarCol').removeClass('sno');
	                                                       }*/
	                                if (i.ScreenID === 'FixedDeposit' || i.ScreenID === 'RecDeposit') {
	                                    $('#' + BaseScrId + 'headerViewProdCol').removeClass('sno');
	                                    //$('#' + BaseScrId + 'headerViewIntCol').removeClass('sno');
	                                } else {
	                                    $('#' + BaseScrId + 'headerViewProdCol').addClass('sno');
	                                    // $('#' + BaseScrId + 'headerViewIntCol').addClass('sno');
	                                }
	                                return;
	                            }
	                        }
	                    })
	                }
	            }
	            window.STAGE_NO = STAGE_NO - 1
	            window.CURRENT_STAGE_NO = STAGE_NO - 1
	            window.PREV_STAGE_NO = PREV_STAGE_NO - 1
	            /**SelfAssisted related Changes Starts***/
	            if (!window.dashRevConf && STAGES[0].split('~')[0] === CURRENT_STAGE_NAME) {
	                if (CURRENT_STAGE_NO <= 0) {
	                    apz.app.BaseScreens.createLeadfirstScreenBackLaunch();
	                } else {
	                    window.CURRENT_STAGE_NAME = STAGES[CURRENT_STAGE_NO - 1].split('~')[0];
	                }
	            } else {
	                window.CURRENT_STAGE_NAME = STAGES[CURRENT_STAGE_NO - 1].split('~')[0];
	            }
	            /**SelfAssisted related Changes Ends***/
	        },
	        downloadApplicationAsperFlow: function() {
	            if (selectedType === 'DEPOSIT' && gApzCOB.ExistingCustomer) {
	                ApzCOB.downloadApplicationDeposit();
	            } else {
	                ApzCOB.downloadApplication();
	            }
	        },
	        //back navigation function
	        backNavigation: function(params) {
	            if (apz.isNull(params) || params.choice === true) {
	                if ($('.country-list').is(':visible')) {
	                    return;
	                }
	                if ($('#' + BaseScrId + 'faqmodel').is(':visible')) {
	                    ApzCOB.toggleModal(BaseScrId + 'faqmodel')
	                    return;
	                } //dont navigate back if country dropdown is open
	                if (CURRENT_STAGE_NO > 0 && !apz.isNull(ConfigureScrJson[CURRENT_STAGE_NO - 1].requestFunc) && window
	                    .inSessionStoreMasterEnabled && window.allowedUnSave.indexOf(apz.currAppId) !== -1 && ApzCOB.isUnsaved()) {
	                    ApzCOB.DispMsgWithCustomButtons(ApzCOB.getDescfromLitCode("LIT_UNSAVED_CONFIRM"), 'C', ApzCOB.backNavigationCallBack,
	                            ApzCOB.getDescfromLitCode('LIT_COMM_BTN_TXT_YES'), ApzCOB.getDescfromLitCode('LIT_COMM_BTN_TXT_NO')
	                            ) //ask to save            
	                } else {
	                    if (apz.currAppId === "Dashbo") {
	                        if (apz.childScr === "ReviewConfirm") {
	                            if (window.viewAllClicked) {
	                                if (window.currentApplication === "InProgress") {
	                                    apz.app.InProgress.viewAllInProgress();
	                                } else if (window.currentApplication === "Rejected") {
	                                    apz.app.Rejected.viewAllInProgress();
	                                } else if (window.currentApplication === "AssignLead") {
	                                    apz.app.AssignedLeads.viewAllInProgress();
	                                } else if (window.currentApplication === "Approvals") {
	                                    apz.app.Approvals.viewAllInProgress();
	                                } else if (window.currentApplication === "Completed") {
	                                    apz.app.Completed.viewAllInProgress();
	                                }
	                            } else {
	                                if (window.currentApplication === "Rejected") {
	                                    if ($("#" + rvwScrId + 'RejectHistoryRow').is(':visible')) {
	                                        $("#" + rvwScrId + "RejectHistoryRow").addClass("sno");
	                                        $("#" + rvwScrId + "RejectReasonRow").removeClass("sno");
	                                    } else {
	                                        ApzCOB.launchMicroApp('Dashbo', 'dashboard', gAppId + '__BaseScreens__BaseDIV', '');
	                                    }
	                                } else {
	                                    if (window.itssearchrc) {
	                                        window.itssearchrc = false;
	                                        ApzCOB.launchMicroApp('Dashbo', 'SearchApplication', 'APZCBO__BaseScreens__BaseDIV', '');
	                                    } else {
	                                        ApzCOB.launchMicroApp('Dashbo', 'dashboard', gAppId + '__BaseScreens__BaseDIV', '');
	                                    }
	                                }
	                            }
	                        } else if (apz.childScr === "viewallapplication") {
	                            ApzCOB.launchMicroApp('Dashbo', 'dashboard', gAppId + '__BaseScreens__BaseDIV', '');
	                        } else if (apz.childScr === "SearchApplication") {
	                            ApzCOB.launchMicroApp('Dashbo', 'dashboard', gAppId + '__BaseScreens__BaseDIV', '');
	                        }
	                        // apz.app.BaseScreens.fetchRole();
	                    } else if (apz.currAppId === "NEWLOA") {
	                        if (window.SelectKendraFromFabBtn) {
	                            ApzCOB.launchMicroApp('NEWLOA', 'FabNewLoanApplication', gAppId + '__BaseScreens__BaseDIV', '');
	                            window.SelectKendraFromFabBtn = false;
	                        } else if(window.isCalcToFAB){
								window.isCalcToFAB=false;
								window.isBackToCalculation = true;
								ApzCOB.launchMicroApp('Calcu', 'LoanEmiCalculator', 'APZCBO__BaseScreens__BaseDIV', 'Dashboard');
							} else {
								if(window.isCalcNewLoan){
									window.isCalcNewLoan=false;
									KendraApp.LoanCalculatorObj={};
								}
	                            window.userclickback = true;
	                            ApzCOB.launchMicroApp('Dashbo', 'dashboard', gAppId + '__BaseScreens__BaseDIV', '');
	                        }
	                    } else if (apz.currAppId === 'Kendra') {
	                        if (apz.deviceType === 'WEB' && userRole === 'BM') {
	                            window.selectedKendraData = [];
	                            ApzCOB.FetchApplicationList();
	                            return;
	                        } else if (apz.deviceType === 'ANDROID' && userRole === 'BM') {
	                            window.selectedKendraData = [];
	                        }
	                        ApzCOB.launchMicroApp('Dashbo', 'dashboard', gAppId + '__BaseScreens__BaseDIV', '');
	                        let refData = {}
	                        refData.id = 'APZCBO__BaseScreens__myKendra';
	                        $("#APZCBO__BaseScreens__sc_col_201").removeClass('active')
	                        $("#APZCBO__BaseScreens__sc_col_199").addClass('active');
	                        $('#footer').removeClass('sno');
	                        if (window.bmApprovalLaunchTrough === 'myKendra') {
	                            $("#" + DashboardScrId + "myActivityDashbordDiv").addClass('sno');
	                            setTimeout(function() {
	                                apz.app.BaseScreens.OnclickMyActivity(refData)
	                            }, 100);
	                        }
	                    } else if (apz.currAppId === "Login") {
	                        if (apz.childScr == "Registration") ApzCOB.launchMicroApp('Login', 'Login', gAppId + '__BaseScreens__BaseDIV', '');
	                    } else if (apz.currAppId === "ChgPas") {
	                        if (apz.childScr == "AppSettings") {
	                            ApzCOB.launchMicroApp('Dashbo', 'dashboard', gAppId + '__BaseScreens__BaseDIV', '');
	                            apz.show("header");
	                            apz.show("footer");
	                        }
	                        if (apz.childScr == "ForgotPassword") ApzCOB.launchMicroApp('Login', 'Login', gAppId + '__BaseScreens__BaseDIV', '');
	                        if (apz.childScr == "ChangePassword") ApzCOB.launchMicroApp('ChgPas', 'AppSettings', gAppId +
	                            '__BaseScreens__BaseDIV', '');
	                    } else {
	                        ApzCOB.launchMicroApp('Dashbo', 'dashboard', gAppId + '__BaseScreens__BaseDIV', '');
	                        // ApzCOB.backNavigationCallBack();
	                    }
	                    //apz.app.BaseScreens.fetchRole();
	                }
	            }
	        },
	        isUnsaved: function() { //Check if there is any unsaved data
	            var isModified = false;
	            var curFuncToExe = ConfigureScrJson.filter(function(e, i) {
	                return e.MicroAppID === apz.currAppId && window.allowedUnSave.indexOf(apz.currAppId) !== -1
	            })[0].requestFunc.split('.');
	            window.afterBack = window[curFuncToExe[0]][curFuncToExe[1]][curFuncToExe[2]][curFuncToExe[3]]('captureAfter');
	            if (!apz.isObjectEmpty(beforeBack) && beforeBack[appReqNodeMapping[apz.currAppId][0]] !== undefined) {
	                appReqNodeMapping[apz.currAppId].filter(function(e, i) {
	                    if (e === 'addressDetailsWrapperList') {
	                        if (JSON.stringify(afterBack[e][0].addressDetailsList[0].payload) !== JSON.stringify(beforeBack[e][0]
	                                .addressDetailsList[0].payload)) {
	                            isModified = true;
	                            return
	                        }
	                    }
	                })
	                appReqNodeMapping[apz.currAppId].filter(function(e, i) {
	                    if (e === 'customerDetailsList') {
	                        if (afterBack[e][0].customerName !== beforeBack[e][0].customerName || afterBack[e][0].mobileNumber !==
	                            beforeBack[e][0].mobileNumber) {
	                            isModified = true;
	                        }
	                        if (JSON.stringify(afterBack[e][0].payload) !== JSON.stringify(beforeBack[e][0].payload)) {
	                            isModified = true;
	                            return
	                        }
	                    } else if (e === 'occupationDetailsWrapperList') {
	                        if (JSON.stringify(afterBack[e][0].occupationDetails.payload) !== JSON.stringify(beforeBack[e][0]
	                                .occupationDetails.payload)) {
	                            isModified = true;
	                            return
	                        }
	                    } else if (e === 'bankingFacilityList') {
	                        if (JSON.stringify(afterBack[e][0].payload) !== JSON.stringify(beforeBack[e][0].payload)) {
	                            isModified = true;
	                            return
	                        }
	                    }
	                })
	            } else {
	                isModified = true;
	            }
	            return isModified;
	        },
	        //function to generate random based on timestamp
	        generateRandomNumber: function() {
	            var randomNum = Math.floor(Math.random() * 90000) + 10000
	            var result = randomNum.toString() + new Date().getTime().toString();
	            return result;
	        },
	        //function to get the mandatory fields that are required to pass for check application service
	        MandatoryFieldsVerifyAppln: function() {
	            window.mobileNode = false;
	            window.nidInpNode = false;
	            window.panNode = false;
	            window.emailNode = false;
	            if (CURRENT_STAGE_NAME === "CUSTVERIFICATION") {
	                ApzCOB.GetCommonCodes("CUSTVERIFICATION", "CASA")["CUSTVERIFICATION"].forEach(function(el) {
	                    if (el.split('~')[0] === 'MobileNo' && el.split('~')[1] === 'Y' && el.split('~')[2] === "M") {
	                        window.mobileNode = true;
	                    } else if (el.split('~')[0] === "NIDInput" && el.split('~')[1] === 'Y' && el.split('~')[2] === "M") {
	                        window.nidInpNode = true;
	                    } else if (el.split('~')[0] === "PANInput" && el.split('~')[1] === 'Y' && el.split('~')[2] === "M") {
	                        window.panNode = true;
	                    } else if (el.split('~')[0] === "Email" && el.split('~')[1] === 'Y' && el.split('~')[2] === "M") {
	                        window.emailNode = true;
	                    }
	                })
	            } else if (CURRENT_STAGE_NAME === "KYCVERIFICATION") {
	                //do nothing
	            } else if (CURRENT_STAGE_NAME === "CUSTOMERDETAILS") {
	                ApzCOB.GetCommonCodes("CUSTOMERDETAILS", "COMM")["CUSTOMERDETAILS"].forEach(function(el) {
	                    if (el.split('~')[0] === 'MobileNo' && el.split('~')[1] === 'Y' && el.split('~')[2] === "M") {
	                        window.mobileNode = true;
	                    } else if (el.split('~')[0] === 'PanNo' && el.split('~')[1] === 'Y' && el.split('~')[2] === "M") {
	                        window.panNode = true;
	                    } else if (el.split('~')[0] === 'Email' && el.split('~')[1] === 'Y' && el.split('~')[2] === "M") {
	                        window.emailNode = true;
	                    }
	                })
	            }
	        },
	        //To get generic litcode desc from thee
	        getLitsDescfromServer: function(litCode) {
	            var litDesc = "";
	            window.gDocumentTexts.forEach(function(m) {
	                if (m.split('~')[0] === litCode) {
	                    litDesc = m.split('~')[1]
	                }
	            })
	            return litDesc;
	        },
	        //pendingApplication launch
	        pendingApplicationLaunch: function() {
	            var stageBreak = false;
	            window.backNav = false;
	            window.revAndConf = false;
	            var totalDivs = $(BaseDivId + BaseScrId + '' + "STAGE" + '"]').length;
	            window.PREV_STAGE_NO = STAGE_NO - 1;
	            if (!apz.isNull(STAGES)) {
	                STAGES.filter(function(m, n) {
	                    stageBreak = false;
	                    ConfigureScrJson.filter(function(i, k) {
	                        if (!stageBreak) {
	                            if (STAGE_NO === parseInt(m.split('~')[1].toUpperCase()) && baseRow <= totalDivs && i
	                                .confParamName === m.split('~')[0].toUpperCase()) {
	                                gApzCOB.userDetails.currentScreen = i.confParamName.concat("~N");
	                                if (!$('#' + BaseScrId + 'STAGE' + baseRow).is(':visible')) {
	                                    if (i.confParamName === "CUSTVERIFICATION") {
	                                        $('body').addClass('LoginBase')
	                                    } else {
	                                        /*if (i.confParamName !== "KYCVERIFICATION") {
	                                            $('#' + BaseScrId + "baseRow").removeClass("start-menu");
	                                        }*/
	                                        $('body').removeClass('LoginBase');
	                                    }
	                                    if (i.confParamName === "NOMINEEDETAILS") {
	                                        if (addNomineeDetails === 'N') {
	                                            window.PREV_STAGE_NO = STAGE_NO - 1;
	                                            window.STAGE_NO = STAGE_NO + 1;
	                                            stageBreak = true;
	                                            return;
	                                        }
	                                    }
	                                    if (STAGE_NO === 1) {
	                                        $('#' + BaseScrId + 'backIcon').addClass('sno');
	                                    } else {
	                                        $('#' + BaseScrId + 'backIcon').removeClass('sno');
	                                    }
	                                    $('#' + BaseScrId + "continue").removeClass('sno');
	                                    $('#' + BaseScrId + "Agree").addClass('sno');
	                                    $("#" + BaseScrId + "footerbtnRow").removeClass('sno');
	                                    $('#' + BaseScrId + 'STAGE' + baseRow).removeClass('sno');
	                                    $('#' + BaseScrId + 'STAGE' + prevRow).addClass('sno');
	                                    ApzCOB.launchMicroApp(i.MicroAppID, i.ScreenID, BaseScrId + "STAGE" + baseRow, "");
	                                    ApzCOB.hideDivsOnConfStages();
	                                    ApzCOB.CompletedAndInprogress();
	                                    $.each(apz.data.scrdata.APZCBO__IpaintSideBarMenus_Res, function(a, b) {
	                                        if (parseInt(b.stageNo) === STAGE_NO) {
	                                            $('#' + BaseScrId + 'headerText').text(ApzCOB.getDescfromLitCode(b
	                                                .stageNameLit));
	                                        }
	                                    })
	                                    window.baseRow = baseRow + 1;
	                                    window.currRow = baseRow - 1;
	                                    window.prevRow = currRow - 1 === -1 ? 0 : currRow - 1;
	                                    UPDATED_STAGES.push(m);
	                                }
	                                return;
	                            }
	                        }
	                    })
	                    return;
	                })
	                //   PREV_STAGE_NO = PREV_STAGE_NO - 1;
	                window.CURRENT_STAGE_NO = STAGE_NO;
	                window.STAGE_NO = STAGE_NO + 1;
	            }
	        },
	        verifyPan: function(pthis, panfieldId) {
	            var panNo = $('#' + apz.currAppId + '__' + apz.childScr + '__' + panfieldId).val().toUpperCase();
	            if (!apz.isNull(panNo)) {
	                var regpan = pan(panNo);
	                if (regpan) { // if the pan format is correct it will go inside this condition
	                    if (panVerifybutton === "Y") {
	                        if ($(pthis).text() === ApzCOB.getDescfromLitCode("LIT_PERDTLS_PANDTLS_BTN_TXT_VERIFY") || $(pthis).text() === ApzCOB
	                            .getDescfromLitCode("LIT_PERDTLS_PANDTLS_BTN_TXT_RETRY")) {
	                            apz.app.BaseScreens.verifyPan(panNo, "PAN");
	                        }
	                    } else {
	                        window.panWithoutService = true
	                    }
	                } else {
	                    window.panVerified = false;
	                    window.panWithoutService = false;
	                    if ($(pthis).text() === ApzCOB.getDescfromLitCode("LIT_PERDTLS_PANDTLS_BTN_TXT_VERIFY") || $(pthis).text() === ApzCOB
	                        .getDescfromLitCode("LIT_PERDTLS_PANDTLS_BTN_TXT_RETRY")) {
	                        $('#' + apz.currAppId + '__' + apz.childScr + '__' + 'success').addClass('sno');
	                        if ($('#' + apz.currAppId + '__' + apz.childScr + '__' + 'verify').is(':visible')) {
	                            $('#' + apz.currAppId + '__' + apz.childScr + '__' + 'retry').removeClass('sno');
	                            $('#' + apz.currAppId + '__' + apz.childScr + '__' + 'verify').addClass('sno')
	                        }
	                    } else {
	                        $('#' + apz.currAppId + '__' + apz.childScr + '__' + 'success').addClass('sno');
	                        //$('#' + apz.currAppId + '__' + apz.childScr + '__' + 'retry').addClass('sno');
	                        if ($('#' + apz.currAppId + '__' + apz.childScr + '__' + 'retry').is(':visible')) {
	                            $('#' + apz.currAppId + '__' + apz.childScr + '__' + 'retry').removeClass('sno');
	                            $('#' + apz.currAppId + '__' + apz.childScr + '__' + 'verify').addClass('sno')
	                        } else {
	                            $('#' + apz.currAppId + '__' + apz.childScr + '__' + 'retry').addClass('sno');
	                            $('#' + apz.currAppId + '__' + apz.childScr + '__' + 'verify').removeClass('sno');
	                        }
	                    }
	                    ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_INVALIDPAN"), "E");
	                }
	            } else if (panVerifybutton === "Y" && apz.isNull(panNo)) {
	                //ApzCOB.fnDisplayMsg("Please enter the PAN Number to Verify", "E");
	                //ApzCOB.validateConfFields();
	                $('#' + apz.currAppId + '__' + apz.childScr + '__' + 'panError').removeClass('sno');
	            }
	        },
	        /**
	         * @author praisy.b
	         * @since 04.06.21
	         * Added fix for below issue
	         * No mobile number validation
	         **/
	        fnValidateMobileNumber: function(pId, ccode, ccodeword) {
	            if (!apz.isNull($('#' + pId).val())) {
	                ApzCOB.valid($('#' + pId).val(), tel, ccode, ccodeword);
	                if (err) {
	                    $("#" + pId).addClass('err');
	                    $('#' + pId + '_ul').next().removeClass("sno");
	                    window.isMobErr = true;
	                } else {
	                    $("#" + pId).removeClass('err');
	                    $('#' + pId + '_ul').next().addClass("sno");
	                }
	            }
	        },
	        /**
	         * @author praisy.b
	         * @since 05.06.21
	         * Added fix for below issue
	         * No min max length validation
	         **/
	        fnCheckMaxMinLengthOnBlur: function(pthis) {
	            var minlength = pthis.minLength;
	            var maxlength = pthis.maxlength;
	            if (!apz.isNull(pthis.value) && (pthis.value.length < minlength || pthis.value.length > maxlength)) {
	                window.gIsMinMaxErr = true;
	                $("#" + pthis.id).addClass('err');
	                $("#" + pthis.id + '_ul').next().removeClass("sno");
	            } else {
	                window.gIsMinMaxErr = false;
	            }
	        },
	        //fileUpload
	        fileUpload: function(fileObj) {
	            gApzCOB.userDetails.filename = fileObj.filename;
	            apz.startLoader();
	            var applnId = ((gApzCOB.mainProductGroupCode === 'DEPOSIT' || gApzCOB.mainProductGroupCode === 'LOAN') && !gApzCOB
	                .ExistingCustomer) ? gApzCOB.relatedApplicationId : gApzCOB.userDetails.applicationId;
	            var req = {
	                "apiRequest": {
	                    "interfaceName": "",
	                    "appId": gAppId,
	                    "requestObj": {
	                        // "appDocId": tempFileArr[0]["appDocId"],
	                        "versionNum": gApzCOB.userDetails.versionNum,
	                        "applicationId": applnId,
	                        "appId": gApzCOB.userDetails.appId,
	                        "srcScreen": CURRENT_STAGE_NAME === "KYCVERIFICATION" ? 'KYC' : CURRENT_STAGE_NAME === "UPLOADDOCUMENTS" ?
	                            "UPLOADDOCS" : 'KYC',
	                        "filePath": !apz.isNull(gApzCOB.userDetails.applicationId) ? ("/").concat(gApzCOB.userDetails.appId).concat("/")
	                            .concat(gApzCOB.product).concat("/").concat(applnId).concat("/") : "",
	                        "fileName": fileObj.filename,
	                        "base64Value": fileObj.imgSrc,
	                        "productGroupCode": gApzCOB.product,
	                        "isExistingCustomer": apz.isNull(gApzCOB.ExistingCustomer) ? "N" : gApzCOB.ExistingCustomer ? 'Y' : 'N'
	                        //"fileLocation": "/home/jboss711/jboss-eap-7.3_OnboardingBase/fileUpload/".concat(tempFileArr[0]["filelocation"]),
	                    }
	                }
	            }
	            ApzCOB.serverBuildParam(gAppId, "UploadFile", "N", "N", req, false, ApzCOB.fileUploadCB);
	        },
	        //fileUpload callback
	        fileUploadCB: function(params) {
	            apz.stopLoader();
	            try {
	                if (ApzCOB.handleServiceCallBacks(params)) {
	                    if (apz.childScr === "KYCVerification") {
	                        window.docsEdited = true;
	                        apz.app.KYCVerification.getFiles();
	                        apz.app.KYCVerification.displayFileName();
	                    } else if (apz.childScr === "UploadDocuments") {
	                        // apz.app.UploadDocuments.getFileArr();
	                        apz.app.UploadDocuments.displayFileName();
	                    } else if (apz.childScr === "CardService") {
	                        // apz.app.UploadDocuments.getFileArr();
	                        apz.app.CardService.loadImage();
	                    }
	                } else {
	                    if (gApzCOB.demoMode !== "Y") {
	                        window.ocrVerified = false;
	                        if (apz.childScr === "UploadDocuments") {
	                            apz.app.UploadDocuments.resetFileArr();
	                            apz.app.UploadDocuments.paintFiles();
	                            //ApzCOB.fnDisplayMsg('Please upload proper Image', 'E');
	                        }
	                        return;
	                    } else {
	                        apz.app.UploadDocuments.displayFileName();
	                    }
	                }
	            } catch (e) {
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	            }
	        },
	        /**
	         * @author praisy.b
	         * @since 07.06.21
	         * Added fix for below issue
	         * image text length fixed to 20
	         **/
	        fnShortenFileName: function(temp) {
	            if (!temp.includes("......")) {
	                var lFilename, lFileExtention;
	                lFilename = temp.split(".")[0];
	                lFileExtention = temp.split(".")[1]; //removed .toLocaleLowerCase() since it affects while comparing
	                if (lFilename.length > 20) {
	                    lFilename = lFilename.substring(0, 20) + "......" + lFileExtention;
	                } else {
	                    lFilename = lFilename + "." + lFileExtention;
	                }
	                return lFilename;
	            } else {
	                return temp;
	            }
	        },
	        getFileExtension: function(str) { //Get extension of the file name input as parameter
	            var m;
	            m = str.match(/([^/]+)\.([^.]+)$/)
	            return (m) && m.slice(1, 3)[1].toLowerCase();
	        },
	        //function to check weather the nodes of an array has array or not
	        fnNodeshasValue: function(data) {
	            var dataExists = false;
	            Object.getOwnPropertyNames(data).forEach(function(el) {
	                if (el !== "addressType") {
	                    if (!apz.isNull(data[el])) {
	                        dataExists = true;
	                    }
	                }
	            })
	            return dataExists;
	        },
	        //function to display allowed file names based on commoncode Configuration
	        fnDisplayAllowedFiles: function(data, headerText) {
	            var tempArr = data.filter(function(el) {
	                if (el.split('~')[1] === "Y") {
	                    return el.split('~')[0]
	                }
	            })
	            for (var p = 0; p < tempArr.length; p++) {
	                if (p === 0) {
	                    headerText = headerText.concat("(allowed format is " + tempArr[p].split('~')[0]);
	                } else if (p === tempArr.length - 1) {
	                    headerText = headerText.concat(" and " + tempArr[p].split('~')[0] + ")")
	                } else {
	                    headerText = headerText.concat(", " + tempArr[p].split('~')[0]);
	                }
	            }
	            return headerText;
	        },
	        showLanguageSelect: function() { //Show language selection if first stage
	            window.firstLang = apz.language;
	            $('#APZCBO__BaseScreens__seLangDropdown').attr('onchange', 'ApzCOB.changeLanguage(this);');
	            var languages = ApzCOB.GetCommonCodes('APPCONTROL', "COMM")['LANGUAGE'];
	            languages.forEach(function(e, i) {
	                if (e.value === apz.language) {
	                    var apLang = e
	                    languages.splice(i, 1)
	                    languages.unshift(apLang)
	                }
	            })
	            window.langArr = [];
	            $.each(languages, function(i, k) {
	                var langObj = {};
	                langObj.val = k.value
	                langObj.desc = apz.lits[apz.currAppId][apz.language][k.desc];
	                window.langArr.push(langObj)
	            })
	            if (Number(CURRENT_STAGE_NO) === 1) {
	                apz.populateDropdown(document.getElementById(BaseScrId + 'seLangDropdown'), window.langArr);
	                if (apz.isNull(window.gDocumentTexts)) {
	                    ApzCOB.changeLanguageCB()
	                };
	                if (apz.currAppId === 'KYCVer') {
	                    $('#' + BaseScrId + 'selectLangRow').addClass('sno');
	                } else {
	                    $('#' + BaseScrId + 'selectLangRow').removeClass('sno');
	                }
	            } else {
	                $('#' + BaseScrId + 'selectLangRow').addClass('sno');
	                /* if (apz.currAppId === 'KYCVer') {
	                     apz.app.KYCVerification.alterOnShown();
	                 }*/
	            }
	        },
	        //validate aadhaar
	        validateaadhaar: function(pthis) {
	            var number = pthis.value;
	            if (number) {
	                var aadhar = aadhaar(number);
	                if (aadhar) {
	                    $(pthis).closest("ul").next().addClass("sno");
	                    $(pthis).removeClass('err');
	                    return;
	                } else {
	                    $(pthis).closest("ul").next().removeClass("sno");
	                    $(pthis).addClass('err');
	                }
	            }
	        },
	        arraySearchUnique: function(arrayToSearch, searchKeys, uniqueKey, searchTerm, interfacePaint, RespBody) {
	            var searchFinal = [];
	            var searchUnique = [];
	            arrayToSearch.forEach(function(o) {
	                searchKeys.forEach(function(p) {
	                    o[p] = apz.isNull(o[p]) ? '' : o[p];
	                    if (o[p].toLocaleLowerCase().indexOf(searchTerm.toLocaleLowerCase()) !== -1 && searchUnique.indexOf(o[
	                            uniqueKey]) === -1) {
	                        searchFinal.push(o);
	                        searchUnique.push(o[uniqueKey]);
	                    }
	                })
	            });
	            if (!apz.isNull(interfacePaint)) {
	                if (apz.isNull(RespBody)) {
	                    apz.data.scrdata[interfacePaint] = JSON.parse(JSON.stringify(searchFinal));
	                } else {
	                    apz.data.scrdata[interfacePaint][RespBody] = JSON.parse(JSON.stringify(searchFinal));
	                }
	                apz.data.loadData(interfacePaint.split('__')[1].split('_')[0], interfacePaint.split('__')[0]);
	            }
	            return searchFinal;
	        },
	        arraySearch: function(searchTerm, arrayToSearch, searchKeys, interfacePaint) { //search through an array of objects
	            var searchFinal = [];
	            arrayToSearch.forEach(function(o) {
	                var searchflag = false;
	                searchKeys.forEach(function(p) {
	                    if (!searchflag) {
	                        o[p] = apz.isNull(o[p]) ? '' : o[p];
	                        if (o[p].toLocaleLowerCase().indexOf(searchTerm.toLocaleLowerCase()) !== -1) {
	                            searchflag = true;
	                            searchFinal.push(o);
	                            return;
	                        }
	                    }
	                })
	            });
	            apz.data.scrdata[interfacePaint] = JSON.parse(JSON.stringify(searchFinal));
	            /* if (!apz.isNull(interfacePaint)) {
	                if (apz.isNull(RespBody)) {
	                    apz.data.scrdata[interfacePaint] = JSON.parse(JSON.stringify(searchFinal));
	                } else {
	                    apz.data.scrdata[interfacePaint][RespBody] = JSON.parse(JSON.stringify(searchFinal));
	                }
	            }*/
	            return searchFinal;
	        },
	        // Function to generate Interface Response Mapper
	        GetInterfaceResMap: function(params) { // Func
	            var iFaceResStr = params.apzIfaceName + "_Res";
	            /*if (params.status && apz.isNull(params.errors)) {
	                iFaceResStr = params.apzIfaceName + "_Res";
	            }*/
	            return iFaceResStr;
	        },
	        //Paint Address Details
	        paintAddreDetails: function() {
	            //var curAddressDetails = gApzCOB.requestNodes['addressDetailsWrapperList'];
	            if (!apz.isNull(window.inSessionStore.addressDetailsWrapperList)) {
	                /*var isEmp = apz.currAppId === 'EmpDet' && window.inSessionStore.addressDetailsWrapperList[0]['custDtlId'] === gApzCOB.userDetails
	                    .custDtlId && window.inSessionStore.addressDetailsWrapperList[0].addressDetailsList[0].payload.addressList.some(function(e,
	                    i) {
	                        return (e.addressType.indexOf('Occupation') !== -1) //Check if the address array has occupation details
	                    });
	                var isPer = apz.currAppId === 'PerDet' && window.inSessionStore.addressDetailsWrapperList[0]['custDtlId'] === gApzCOB.userDetails
	                    .custDtlId && window.inSessionStore.addressDetailsWrapperList[0].addressDetailsList[0].payload.addressList.some(function(e,
	                    i) {
	                        return (e.addressType.indexOf('Permanent') !== -1) //Check if the address array has permanent details
	                    })*/
	                /* if (isEmp || isPer) {
	                     curAddressDetails = window.inSessionStore
	                         .addressDetailsWrapperList //If it has anyone of these details then paint from local save
	                 } else {
	                     curAddressDetails = gApzCOB.requestNodes['addressDetailsWrapperList'] //If it doesn't then paint from reponse
	                 }*/
	            }
	        },
	        //PAN Verify Status
	        panVerifyButtonStatus: function() {
	            var ArraytoLoop = [];
	            if (apz.currAppId === 'CusVer') {
	                ArraytoLoop = ApzCOB.GetCommonCodes("CUSTVERIFICATION", "CASA").CUSTVERIFICATION
	            } else {
	                ArraytoLoop = ApzCOB.GetCommonCodes("CUSTOMERDETAILS", "COMM").CUSTOMERDETAILS
	            }
	            ArraytoLoop.forEach(function(k) {
	                if (k.split('~')[0] === "PanVerify") {
	                    window.panVerifybutton = k.split('~')[1];
	                    if (panVerifybutton === 'N') {
	                        window.panWithoutService = false;
	                    } else if (panVerifybutton === 'Y') {
	                        window.panWithoutService = true;
	                    }
	                }
	                if ((k.split('~')[0] === "PANInput") || (k.split('~')[0] === "PanNo")) {
	                    window.panEnabledorDisabled = k.split('~')[1];
	                    window.panMandatory = k.split('~')[2];
	                }
	            })
	        },
	        jointflowlaunch: function() {
	            window.JointFlow = true;
	            if (gApzCOB.requestNodes.applicationMaster.versionNum > 1) {
	                window.editappln = true;
	            }
	            var toLaunchNext = STAGES.filter(function(e, j) {
	                return STAGES[j].split('~')[0] !== 'SELECTPRODUCT' && STAGES[j].split('~')[0] !== 'VALIDATEPINCODE' && STAGES[j]
	                    .split('~')[0] !== 'CUSTVERIFICATION' && STAGES[j].split('~')[0] !== 'LOANDETAILS' && STAGES[j].split('~')[0] !==
	                    'DEPOSITDETAILS' && STAGES[j].split('~')[0] !== 'EMIDETAILS' && STAGES[j].split('~')[0] !== 'CREDITDETAILS'
	            })[0].split('~')[0]
	            var restartStageNo = Number(STAGES.filter(function(e, j1) {
	                return STAGES[j1].split('~')[0] !== 'SELECTPRODUCT' && STAGES[j1].split('~')[0] !== 'VALIDATEPINCODE' && STAGES[
	                        j1].split('~')[0] !== 'CUSTVERIFICATION' && STAGES[j1].split('~')[0] !== 'LOANDETAILS' && STAGES[j1]
	                    .split('~')[0] !== 'DEPOSITDETAILS' && STAGES[j1].split('~')[0] !== 'EMIDETAILS' && STAGES[j1].split('~')[
	                    0] !== 'CREDITDETAILS'
	            })[0].split('~')[1]);
	            for (var l = restartStageNo; l < STAGES.length; l++) {
	                $('#' + BaseScrId + 'menulist_row_' + l).removeClass('completed');
	                $('#' + BaseScrId + 'menulist_row_' + l).removeClass('progress');
	            }
	            /*var nextStageDetails = ConfigureScrJson.filter(function(x, y) {
	                return x.confParamName === toLaunchNext
	            });*/
	            if (window.revAndConf) {
	                window.STAGE_NO = revConfSTAGENO;
	                window.CURRENT_STAGE_NO = STAGE_NO - 1;
	                window.PREV_STAGE_NO = CURRENT_STAGE_NO - 1;
	                window.baseRow = revConfBaseRow;
	                window.currRow = baseRow - 1;
	                window.prevRow = currRow - 1
	            }
	            var totaldivs = $(BaseDivId + BaseScrId + '' + "STAGE" + '"]').length
	            if (totaldivs > 0) {
	                for (var i = 1; i < $(BaseDivId + BaseScrId + '' + "STAGE" + '"]').length; i++) {
	                    $("#" + BaseScrId + "STAGE" + i).addClass('sno')
	                }
	            }
	            $.each(ConfigureScrJson, function(i3, k) {
	                if (k.confParamName === toLaunchNext) {
	                    gApzCOB.userDetails.currentScreen = k.confParamName.concat("~Y");
	                    STAGES.filter(function(el) {
	                        if (el.split('~')[0] === toLaunchNext) {
	                            window.CURRENT_STAGE_NAME = toLaunchNext;
	                            window.STAGE_NO = parseInt(el.split('~')[1]) + 1;
	                            window.CURRENT_STAGE_NO = STAGE_NO - 1;
	                            window.PREV_STAGE_NO = CURRENT_STAGE_NO - 1;
	                            window.baseRow = parseInt(el.split('~')[1]) + 1;
	                            window.currRow = baseRow - 1;
	                            window.prevRow = currRow - 1;
	                            $("#" + BaseScrId + "STAGE" + currRow).removeClass('sno')
	                            ApzCOB.launchMicroApp(k.MicroAppID, k.ScreenID, BaseScrId + "STAGE" + currRow, "");
	                            // ApzCOB.launchSubScreen(k.ScreenID, BaseScrId + "STAGE" + currRow, "");
	                        }
	                    })
	                    $.each(apz.data.scrdata.APZCBO__IpaintSideBarMenus_Res, function(a, b) {
	                        if (parseInt(b.stageNo) === Number(CURRENT_STAGE_NO)) {
	                            $('#' + BaseScrId + 'headerText').text(b.stageName);
	                        }
	                    })
	                }
	            })
	        },
	        latestCustIdFetch: function() {
	            if ((!apz.isNull(gApzCOB.requestNodes.customerDetailsList)) && gApzCOB.requestNodes.customerDetailsList.length > 0) {
	                for (var i = 0; i < gApzCOB.requestNodes.customerDetailsList.length; i++) {
	                    if (gApzCOB.requestNodes.customerDetailsList[i]["seqNumber"] === gApzCOB.requestNodes.customerDetailsList.length) {
	                        window.latestApplicantPosition = i;
	                    }
	                }
	            }
	        },
	        scrollToTop: function() {
	            window.scrollTo({
	                top: 0,
	                behavior: 'smooth'
	            });
	        },
	        //Fetch Banks Service
	        FetchBanks: function() {
	            var req = {
	                "apiRequest": {
	                    "interfaceName": "FetchBanks"
	                }
	            }
	            ApzCOB.serverBuildParam(gAppId, "FetchBanks", "N", "N", req, false, ApzCOB.FetchBanksCB);
	        },
	        //FetchBanks Service Callback
	        FetchBanksCB: function(params) {
	            apz.stopLoader();
	            var tempArr = [];
	            try {
	                if (ApzCOB.handleServiceCallBacks(params)) {
	                    var ifaceName = ApzCOB.GetInterfaceResMap(params);
	                    gBanks = JSON.parse(params.res[ifaceName].apiResponse.ResponseBody.responseObj)["banksList"];
	                    gBanks.filter(function(p) {
	                        var obj = {};
	                        obj.val = p.bankCode;
	                        obj.desc = p.bankName;
	                        tempArr.push(obj);
	                    })
	                    gBanks = tempArr;
	                    gBanks.unshift({
	                        "val": '-1',
	                        "desc": ApzCOB.getDescfromLitCode("LIT_COMM_MSG_PLEASE_SELECT")
	                    });
	                    if (!apz.isNull(window.populatedropdownScrID) && apz.currAppId === 'FundAC') {
	                        apz.populateDropdown(document.getElementById(window.populatedropdownScrID + 'InternetBanking1'), gBanks);
	                    }
	                }
	            } catch (e) {
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	            }
	        },
	        fnroundWithAbbreviator: function(n) {
	            var d = 2;
	            var p = '';
	            var x = ('' + n).length - 1;
	            p = Math.pow;
	            d = p(10, d);
	            x -= x % 3;
	            return Math.round(n * d / p(10, x)) / d + " kMGTPE" [x / 3]
	        },
	        //Fetch CustomerDetails Service for cards
	        FetchCustomerDetailsForcards: function() {
	            var req = {
	                "apiRequest": {
	                    "interfaceName": "fetchcustomerdetailsforcards",
	                    "appId": gAppId,
	                    "requestObj": {
	                        "customerId": apz.isNull(window.CURRENT_STAGE_NAME) ? gApzCOB.userDetails.customerId : $('#' + CustVerfScrId +
	                            'customerID').val()
	                    }
	                }
	            }
	            ApzCOB.serverBuildParam(gAppId, "fetchcustomerdetailsforcards", "N", "N", req, false, ApzCOB.FetchCustomerDetailsCB);
	        },
	        //disable text selection on mouse drag
	        disableTextSelection: function() {
	            $('#' + BaseScrId + 'baseScroll').on('mousedown touchstart', function(event) {
	                if (apz.isNull(event.target.type)) {
	                    event.preventDefault();
	                }
	                // mouseDown = true;
	            })
	        },
	        fnValidateDoorNumber: function(pthis) {
	            if (apz.isNull(pthis.value)) {
	                return;
	            }
	            if (gApzCOB.CustomAmountFormatEnabled === 'Y') {
	                var amtFormatCode = ApzCOB.GetCommonCodes("AMOUNTFORMAT", "COMM").AMOUNTFORMAT;
	                /**
	                 * Check if decimal is included, and verify the index of Decimal separator,
	                 * If true, split by separator and replace values other than numbers,
	                 * Else replace all values other than numbers
	                 **/
	                if (amtFormatCode.includeDecimal === 'Y' && pthis.value.indexOf(amtFormatCode.decimalSeparator) > -1) {
	                    pthis.value = pthis.value.split(amtFormatCode.decimalSeparator)[0].replace(gALLOWONLYNUM, '');
	                } else {
	                    pthis.value = pthis.value.replace(gALLOWONLYDOORNUM, '');
	                }
	            } else if (pthis.value.indexOf('.') > -1) {
	                pthis.value = pthis.value.split('.')[0].replace(gALLOWONLYDOORNUM, '');
	            } else {
	                pthis.value = pthis.value.replace(gALLOWONLYDOORNUM, '');
	            }
	        },
	        fnValidateCardExp: function(pthis, event) { // for card expiry date - onkeyup automate adding "/" and replace
	            // check if the pressed key is backspace
	            $('#ui-datepicker-div').hide();
	            if ((pthis.value || "").length <= 10) {
	                var backspacePressed = event && event.key === 'Backspace';
	                // regex for 0-9 and '/'
	                pthis.value = pthis.value.replace(/[^0-9\/]/g, '').replace(/^([0-1]{1}[0-9]{1})([0-9]{1,4}).*/g, '$1/$2');
	                var testdate = [];
	                testdate = ($("#" + pthis.id).val()).split('');
	                if (testdate[4] !== '/' || testdate[2] !== '/') {
	                    if (apz.dateFormat === 'yyyy/MM/dd' || apz.dateFormat === 'yyyy/mm/dd' || apz.dateFormat === 'yyyy/MM/DD' || apz
	                        .dateFormat === 'yyyy/mm/DD') {
	                        if ((((pthis.value || "").length === 4) || (pthis.value || "").length === 5) && (((pthis.value).indexOf("/") === -
	                                1) || (pthis.value).indexOf("/") === 4) && !backspacePressed) {
	                            pthis.value = pthis.value + "/";
	                        }
	                        // Add '/' if more than 2 digits are pressed/pasted and pressed key is not a backspace
	                        if ((((pthis.value || "").length === 4) || (pthis.value || "").length === 7) && (((pthis.value).indexOf("/") === -
	                                1) || (pthis.value).indexOf("/") === 4) && !backspacePressed) {
	                            pthis.value = (pthis.value.slice(0, 7) + '/' + pthis.value.slice(7)).substring(0, 9);
	                        }
	                    } else {
	                        // Add '/' if 2 digits are pressed and pressed key is not a backspace
	                        if ((((pthis.value || "").length === 2) || (pthis.value || "").length === 5) && (((pthis.value).indexOf("/") === -
	                                1) || (pthis.value).indexOf("/") === 2) && !backspacePressed) {
	                            pthis.value = pthis.value + "/";
	                        }
	                        // Add '/' if more than 2 digits are pressed/pasted and pressed key is not a backspace
	                        if ((((pthis.value || "").length === 2) || (pthis.value || "").length === 5) && (((pthis.value).indexOf("/") === -
	                                1) || (pthis.value).indexOf("/") === 2) && !backspacePressed) {
	                            pthis.value = (pthis.value.slice(0, 2) + "/" + pthis.value.slice(2)).substring(0, 7);
	                        }
	                    }
	                }
	            }
	        },
	        fnValidateDOB: function(pthis) {
	            if (apz.isNull(pthis.value)) {
	                return;
	            }
	            if (gApzCOB.CustomAmountFormatEnabled === 'Y') {
	                var amtFormatCode = ApzCOB.GetCommonCodes("AMOUNTFORMAT", "COMM").AMOUNTFORMAT;
	                /**
	                 * Check if decimal is included, and verify the index of Decimal separator,
	                 * If true, split by separator and replace values other than numbers,
	                 * Else replace all values other than numbers
	                 **/
	                if (amtFormatCode.includeDecimal === 'Y' && pthis.value.indexOf(amtFormatCode.decimalSeparator) > -1) {
	                    pthis.value = pthis.value.split(amtFormatCode.decimalSeparator)[0].replace(gALLOWONLYNUM, '');
	                } else {
	                    pthis.value = pthis.value.replace(gALLOWONLYDOB, '');
	                }
	            } else if (pthis.value.indexOf('.') > -1) {
	                pthis.value = pthis.value.split('.')[0].replace(gALLOWONLYDOB, '');
	            } else {
	                pthis.value = pthis.value.replace(gALLOWONLYDOB, '');
	            }
	        },
	        getFullDate: function(ldata, year, month, day, hour, minute, second) {
	            var ldate;
	            if (typeof ldata === 'object') {
	                var dateStr = "" + year + "/" + month + "/" + day;
	                var timeStr = "" + hour + ":" + minute + ":" + second;
	                ldate = new Date(dateStr + " " + timeStr).$format('d M Y H:m:s')
	            }
	            return ldate;
	        },
	        fnValidateAppSecToken: function(pCallBack) {
	            var jsonobj = {
	                "id": "PLGN_GET_APPTOKEN",
	                "callBack": pCallBack
	            };
	            //apz.startLoader();
	            apz.ns.isAppTokenSet(jsonobj);
	        },
	        appSecTokenCB: function(params) {
	            // console.log(JSON.stringify(params));
	            //apz.stopLoader();
	            if (params.hasOwnProperty("appTokenStatus") && params.appTokenStatus === "Y") {
	                window.isAppTokenSet = "Y"
	                ApzCOB.fnVersionCheck();
	            } else {
	                setTimeout(function() {
	                    ++isAppTokenCounter;
	                    ApzCOB.fnValidateAppSecToken(ApzCOB.appSecTokenCB);
	                }, 200);
	            }
	        },
	        downloadFileFromserverforcards: function() {
	            var filepth = "";
	            var json = {
	                "destinationPath": "",
	                "filePath": (gAppId).concat("/").concat(gApzCOB.userDetails.applicationId),
	                "sessionReq": "N" //Y or N
	            };
	            if (gApzCOB.requestNodes.cardDetails.theme === "N") {
	                filepth = ('APZCOB').concat("/").concat(gApzCOB.product).concat("/").concat("DefaultImages");
	            } else {
	                filepth = (gAppId).concat("/").concat(gApzCOB.product).concat("/").concat(gApzCOB.userDetails.applicationId);
	            }
	            json.destinationPath = "image";
	            json.fileName = gApzCOB.requestNodes.cardDetails.customTheme;
	            json.base64 = "Y";
	            json.filePath = filepth;
	            json.id = "";
	            json.callBack = (!window.CardSuccessModalTriggered && apz.childScr === 'ReviewConfirm') ? apz.app.ReviewConfirm
	                .downloadFileFromserverCBforcards : ApzCOB.downloadFileFromserverCBforcards;;
	            apz.ns.downloadFile(json);
	        },
	        /**** Callback function will be called only if bsae64 image is requested *********/
	        downloadFileFromserverCBforcards: function(params) {
	            //finalimgdataforc = []
	            if (!apz.isNull(params.base64)) {
	                var obj = {
	                    "image": params.base64,
	                    // "docname": allDocTypes[docCallBackCounter]
	                };
	                apz.data.scrdata.CardSe__IpaintFileUpload_Res = {};
	                apz.data.scrdata.CardSe__IpaintFileUpload_Res.fileDetails = []
	                var obj12 = {
	                    "fieldID": "",
	                    "filename": gApzCOB.requestNodes.cardDetails.customTheme,
	                    "filetype": "image/png",
	                    "fname": gApzCOB.requestNodes.cardDetails.customTheme,
	                    "imgSrc": params.base64
	                }
	                apz.data.scrdata.CardSe__IpaintFileUpload_Res.fileDetails.push(obj12);
	                apz.data.loadData("IpaintFileUpload", "CardSe");
	                var imageData = apz.data.scrdata.CardSe__IpaintFileUpload_Res.fileDetails;
	                apz.data.scrdata.APZCBO__IPaintSuccImage_Res = [];
	                if (!apz.isNull(imageData)) {
	                    var obj2 = {};
	                    obj2.image = imageData[0].imgSrc
	                    apz.data.scrdata.APZCBO__IPaintSuccImage_Res.push(obj2);
	                    apz.data.loadData("IPaintSuccImage", gAppId);
	                } else {
	                    var obj1 = {};
	                    obj1.image = SelectedCardThemeName
	                    apz.data.scrdata.APZCBO__IPaintSuccImage_Res.push(obj1);
	                    apz.data.loadData("IPaintSuccImage", gAppId);
	                }
	                $('#APZCBO__BaseScreens__personname').text(gApzCOB.requestNodes.cardDetails.nameOnCard);
	                $('#APZCBO__BaseScreens__cardname').text(gApzCOB.requestNodes.cardDetails.cardName);
	                apz.setElmValue(BaseScrId + "SelectedCreditCard", gApzCOB.requestNodes.cardDetails.cardName);
	                apz.setElmValue(BaseScrId + "refNo", gApzCOB.userDetails.applicationId);
	            } else {
	                //do nothing
	            }
	        },
	        backPressPart: function() {
	            $('#' + gAppId + '__PreLogin_BaseScreen__mob_footerbackbtnColumn').trigger("onclick"); //prelogin screens
	            //var lastScr = ApzCOB.getprevscrPageBC();
	            if (apz.currAppId === "Dashbo") {
	                $('#' + gAppId + '__PostLogin_BaseScreen__backButtonColumn').trigger("onclick", ApzCOB.logout());
	            } //postlogin screens
	            else if (apz.currAppId === "Login") {
	                apz.app.Login.backpressed();
	            } else if (apz.currAppId === "PLFeat") {
	                apz.app.PreLogin_BaseScreen.preloginback();
	            } else if (apz.currAppId === "Authen" && apz.isFunction(apz.app[apz.childScr].backNavigation)) {
	                apz.app[apz.childScr].backNavigation();
	            } else {
	                apz.app[apz.childScr].backNavigation();
	            }
	        },
	        sameCommonAddr: function() {
	            if (window.sameCommAddress) {
	                if ($('#' + PerDetScrId + "city").is(':visible')) {
	                    apz.setElmValue(PerDetScrId + "city", apz.getElmValue(PerDetScrId + 'pCity'))
	                    $('#' + PerDetScrId + "city").val(pCity);
	                    $('#' + PerDetScrId + "AddPermanentToggle").prop('checked', true);
	                }
	            }
	        },
	        loadCityDropDown: function() {
	            var a = gApzCOB.requestNodes['addressDetailsWrapperList'][0].addressDetailsList[0].payload.addressList[0];
	            apz.app.PersonalDetails.getStateCityValueforDropdown();
	            if (a.city !== '') {
	                apz.setElmValue(PerDetScrId + "pCity", cityVal[cityDesc.indexOf(a.city)]);
	            }
	        },
	        loadMenuList: function() {
	            for (var i = 0; i < $('#' + BaseScrId + 'menulist ul').children().length; i++) {
	                if (!$('#' + BaseScrId + 'menulist_row_' + i).hasClass('completed')) {
	                    if (i <= CURRENT_STAGE_NO) {
	                        $('#' + BaseScrId + 'menulist_row_' + i).addClass('completed');
	                        $('#' + BaseScrId + 'menulist_row_' + i).removeClass('progress');
	                    }
	                    if (STAGE_NO === parseInt($('#APZCBO__IpaintSideBarMenus__o__APZCBO__IpaintSideBarMenus_Res__stageNo_' + i).text())) {
	                        $('#' + BaseScrId + 'menulist_row_' + i).addClass('progress');
	                        $('#' + BaseScrId + 'menulist_row_' + i).removeClass('completed');
	                    }
	                }
	            }
	        },
	        loadCreatLoanPart: function() {
	            if (gApzCOB.CobCallCBS === 'Y') {
	                $('#' + BaseScrId + 'DepositAccount').removeClass('sno');
	            } else {
	                $('#' + BaseScrId + 'DepositAccount').addClass('sno');
	            }
	            $('#' + BaseScrId + 'sucText').text(gApzCOB.CobCallCBS === 'N' ? ApzCOB.getDescfromLitCode(
	                "LIT_COMM_SUCCESS_TXT_APPSUBSUCCESSBANKPROCESS") : ApzCOB.getDescfromLitCode("LIT_APPLN_SUC_MSG"));
	            return;
	        },
	        FuncPaginationNext: function() {
	            $(".J-paginationjs-next").trigger("click");
	            $(pageInputCSSClass).val(window.pageNo);
	        },
	        FuncPaginationPrev: function() {
	            $(".J-paginationjs-previous").trigger("click");
	            $(pageInputCSSClass).val(window.pageNo);
	        },
	        SetPaginationConfig: function(params) { //func to set pagination based on configuration
	            window.pageNo = '1';
	            window.currentPageNumber = '0';
	            //window.customizedPagination = false;
	            window.defaultPagination = false;
	            window.noPagination = false;
	            var PaginationVar = ApzCOB.GetCommonCodes("PAGINATION");
	            for (let i = 0; i < PaginationVar.length; i++) {
	                if (PaginationVar[i].feature == params) {
	                    window.PageLimit = PaginationVar[i].limit;
	                    window.customizedPagination = PaginationVar[i].flag;
	                }
	            }
	            //window.PageLimit = ApzCOB.GetCommonCodes("PAGINATION").ViewAll.limit;
	            //window.customizedPagination = ApzCOB.GetCommonCodes("PAGINATION").ViewAll.flag
	        },
	        JointFlowForLoanDeposit: function() {
	            if (apz.childScr === 'CustomerVerification') {
	                if ($('#' + BaseScrId + 'newCustomerModal').is(':visible')) {
	                    //ApzCOB.toggleModal(BaseScrId + 'newCustomerModal');
	                    $('#' + BaseScrId + 'newCustomerModal_close').trigger('click');
	                }
	                var JointSupported = '';
	                var AccountHolderForLoan = '';
	                for (var i = 0; i < gApzCOB.CommonCodes.length; i++) {
	                    if (gApzCOB.CommonCodes[i].paramName === 'LOANCASAJTACC') {
	                        JointSupported = gApzCOB.CommonCodes[i].paramValue.split('~')[0]
	                        AccountHolderForLoan = gApzCOB.CommonCodes[i].paramValue.split('~')[1]
	                    }
	                    if (gApzCOB.CommonCodes[i].paramName === 'DEFAULTCASAPRODUCTCODELN') {
	                        gApzCOB.productCode = gApzCOB.CommonCodes[i].paramValue
	                    }
	                }
	                if (JointSupported === 'Y') {
	                    gApzCOB.NoOfJointHolder = AccountHolderForLoan;
	                    apz.app.BaseScreens.defaultApplicationType();
	                    //apz.app.BaseScreens.paintApplicatonTypes()
	                    ApzCOB.toggleModal(BaseScrId + 'applicationTypeModal');
	                    $('#' + BaseScrId + 'continueBtn').attr("onclick", "").unbind("click");
	                    $('#' + BaseScrId + 'continueBtn').attr("onclick", "ApzCOB.UpdateApplicantscount()");
	                    apz.stopLoader();
	                    return;
	                } else {
	                    gApzCOB.currentApplicant = 1;
	                    gApzCOB.noOfApplicants = 1;
	                    ApzCOB.LaunchConfiguredScreens();
	                }
	            } else {
	                ApzCOB.LaunchConfiguredScreens();
	            }
	        },
	        loadDataFile: function(fileName, appID) {
	            var filePath = apz.getDataFilesPath(appID) + "/" + fileName + ".json";
	            var content = apz.getFile(filePath);
	            var data = JSON.parse(content);
	            return data;
	        },
	        calGSTAmount: function(amt, gstValue, feeCharge) {
	            /*var calculateGST = ((feeCharge / 100) * amt).toFixed(2);
	            calculateGST = parseFloat(calculateGST);
	            var GSTValue = ((gstValue / 100) * calculateGST).toFixed(2);
	            return GSTValue;*/
	            /*var GSTValue = ((window.ProcessingFee * gstValue / 100)).toFixed(2)
	            return GSTValue;*/
	            var processingFeeValue = ApzCOB.calProcessingFeesNew(amt, feeCharge);
	            /*var calculateGST = ((feeCharge / 100) * amt).toFixed(2); 
	            calculateGST = parseFloat(calculateGST); */
	            var GSTValue = parseFloat((processingFeeValue * 18 / 100)).toFixed(2)
	            return GSTValue;
	        },
	        calProcessingFeesNew: function(amt, feeCharge) {
	            var ProcessingFee;
	            var ProcesFee = ((1.5 / 100) * amt);
	            if (feeCharge === 0) {
	                window.ProcessingFee = "0.00"
	                ProcessingFee = "0.00"
	            } else {
	                ProcessingFee = (ProcesFee / feeCharge);
	                window.ProcessingFee = ProcessingFee;
	            }
	            return ProcessingFee;
	        },
	        calProcessingFees: function(amt, feeCharge) {
	            /*var ProcessingFees = ((feeCharge / 100) * amt).toFixed(2);
	            window.ProcessingFee = ProcessingFees;
	            return ProcessingFees;*/
	            var ProcessingFee;
	            var ProcesFee = ((1.5 / 100) * amt).toFixed(2);
	            if (feeCharge === 0) {
	                window.ProcessingFee = "0.00"
	                ProcessingFee = "0.00"
	            } else {
	                ProcessingFee = (ProcesFee / feeCharge).toFixed(2);
	                window.ProcessingFee = ProcessingFee;
	            }
	            return ProcessingFee;
	        },
	        calAmtInPercentage: function(percent, amt) {
	            return ((percent / 100) * amt).toFixed(0);
	        },
	        calApproxWeekInstallment: function(percent, amt, tenure) {
	            return (((percent / 100) * amt) + amt / tenure).toFixed(0);
	        },
	        otpAuthFn: function() {
	            if (apz.deviceType !== 'WEB') {
	                //TimerHTMLInjection();
	                pwdMaximumLength = 6;
	                apz.startLoader();
	                $('#' + BaseScrId + 'otp_1').attr('type', 'text');
	                var wrapper = $('#' + BaseScrId + "otp_1_ul").parent();
	                for (var i = 1; i < pwdMaximumLength; i++) {
	                    $(wrapper).append('<ul id="APZCBO__BaseScreens__otp_' + (i + 1) +
	                        '_ul" class="eoc srb wrapped mpindefault"><li class="etw-0"><label id="APZCBO__BaseScreens__otp_' + (i + 1) +
	                        '_grp_lbl" for="APZCBO__BaseScreens__otp_' + (i + 1) +
	                        '" class="flb" style="" title="Input">Input</label></li><li id="APZCBO__BaseScreens__otp_' + (i + 1) +
	                        '_li" class="eic etw-100"><span class="ecn etw-100" style=""><input id="APZCBO__BaseScreens__otp_' + (i + 1) +
	                        '" class="etw-100 ett-inpt ter cen readonly" type="password" maxlength="1" placeholder="." readonly="readonly" value=""></span></li></ul>'
	                        );
	                }
	                $('input').change(function() {
	                    if ($(this).val().length === $(this).attr("maxlength")) {
	                        var i = $('input').index(this);
	                        $('input').eq(i + 1).focus();
	                    }
	                });
	                $('#APZCBO__BaseScreens__otp_1').attr('type', 'password');
	                apz.stopLoader();
	            }
	        },
	        pad: function(number, length) {
	            var str = '' + number;
	            while (str.length < length) {
	                str = '0' + str;
	            }
	            return str;
	        },
	        currentTimeStamp: function() {
	            var newDt = new Date();
	            var yyyy = newDt.getFullYear().toString();
	            var MM = ApzCOB.pad(newDt.getMonth() + 1, 2);
	            var dd = ApzCOB.pad(newDt.getDate(), 2);
	            var hh = ApzCOB.pad(newDt.getHours(), 2);
	            var mm = ApzCOB.pad(newDt.getMinutes(), 2)
	            var ss = ApzCOB.pad(newDt.getSeconds(), 2)
	            return yyyy + MM + dd + hh + mm + ss;
	        },
	        prepareSingleLoanRequest: function() {
	            var loanRequest = {};
	            var loanMode = "IN BRANCH";
	            var nomineeDtls;
	            var insuranceDtls;
	            var interestRate;
	            if (window.loanProduct === "Emergency Loan") {
	                if ($('#NEWLOA__AddLoanDetails__disbMode').val() == "CASH") {
	                    loanMode = "CASH PAYMENT SUCCESSFUL"
	                } else if ($('#NEWLOA__AddLoanDetails__disbMode').val() == "NEFT") {
	                    loanMode = "IN BRANCH"
	                } else {
	                    loanMode = "ON FIELD"
	                }
	            } else {
	                if (KendraApp.selectedCustomer.addLoanDetailsObj.scrDataStep1.disbMode.idDesc == "CASH") {
	                    loanMode = "ON FIELD"
	                }
	            }
	            if (window.loanProduct === "Emergency Loan") {
	                nomineeDtls = {
	                    "relationWithMemberCode": "",
	                    "relationWithMember": "",
	                    "nomineeName": ""
	                };
	                insuranceDtls = KendraApp.selectedCustomer.addLoanDetailsObj.scrDataStep1.insurDtls;
	                interestRate = KendraApp.selectedCustomer.addLoanDetailsObj.scrDataStep1.interestRate;
	            } else {
	                nomineeDtls = KendraApp.selectedCustomer.addLoanDetailsObj.scrDataStep1.nomineeDtls;
	                insuranceDtls = KendraApp.selectedCustomer.addLoanDetailsObj.scrDataStep1.insurDtls;
	                interestRate = KendraApp.selectedCustomer.addLoanDetailsObj.scrDataStep1.interestRate;
	            }
	            if (window.reIncomeAssessment) {
	                if (KendraApp.selectedCustomer.addLoanDetailsObj.selEligibleLoanDtls.productId != KendraApp.selectedCustomer
	                    .addLoanDetailsObj.scrDataStep1.purpose.productId) {
	                    KendraApp.selectedCustomer.addLoanDetailsObj.scrDataStep1.purpose.productId = KendraApp.selectedCustomer
	                        .addLoanDetailsObj.selEligibleLoanDtls.productId;
	                }
	            }
	            var inputLoanRole = 'KM';
	            if (LoggedInUserDetails.loginResponse.addInfo1 === 'BM') {
	                inputLoanRole = LoggedInUserDetails.loginResponse.addInfo1;
	            } else if (currentUserRole === 'DEO') {
	                inputLoanRole = currentUserRole;
	            }
	            if (isSelfAssigned) {
	                inputLoanRole = 'Self';
	            }
	            var loanDtls = {
	                "caglAmt": KendraApp.selectedCustomer.addLoanDetailsObj.selEligibleLoanDtls.loanAmt,
	                "cbAmt": KendraApp.selectedCustomer.addLoanDetailsObj.selEligibleLoanDtls.amountMax,
	                "custVintageInterestRate": KendraApp.selectedCustomer.addLoanDetailsObj.selEligibleLoanDtls.intRate,
	                "insurancePercentage": KendraApp.selectedCustomer.addLoanDetailsObj.selEligibleLoanDtls.insurancePercentage,
	                "product": KendraApp.selectedCustomer.addLoanDetailsObj.selEligibleLoanDtls.productId,
	                "productId": KendraApp.selectedCustomer.addLoanDetailsObj.selEligibleLoanDtls.productId,
	                "productType": KendraApp.selectedCustomer.addLoanDetailsObj.selEligibleLoanDtls.shortDesc,
	                "shortDesc": KendraApp.selectedCustomer.addLoanDetailsObj.selEligibleLoanDtls.shortDesc,
	                "spouseInsurance": KendraApp.selectedCustomer.addLoanDetailsObj.selEligibleLoanDtls.spouseInsurance,
	                "term": (apz.getElmValue(screenId + "tenure")).split(' ')[0] + 'W',
	                // "term": KendraApp.selectedCustomer.addLoanDetailsObj.selEligibleLoanDtls.term,
	                // "approxWeeklyInstallAmt": KendraApp.selectedCustomer.addLoanDetailsObj.scrDataStep1.approxWeeklyInstallAmt,
	                //"tenure": KendraApp.selectedCustomer.addLoanDetailsObj.scrDataStep1.tenure,
	                "chargeAndBreakupDtls": KendraApp.selectedCustomer.addLoanDetailsObj.scrDataStep1.chargeAndBreakupDtls,
	                "insurDtls": insuranceDtls,
	                "disburseMode": KendraApp.selectedCustomer.addLoanDetailsObj.scrDataStep1.disbMode,
	                "nomineeDtls": nomineeDtls,
	                "purpose": KendraApp.selectedCustomer.addLoanDetailsObj.scrDataStep1.purpose,
	                "repayFrequency": KendraApp.selectedCustomer.addLoanDetailsObj.scrDataStep1.repayFrequency,
	                "interestRate": interestRate,
	                "activeLoanDtls": KendraApp.activeLoanDtls,
	                "loanMode": loanMode,
	                "description": KendraApp.selectedCustomer.addLoanDetailsObj.selEligibleLoanDtls.description,
	                "productStatus": KendraApp.selectedCustomer.addLoanDetailsObj.selEligibleLoanDtls.productStatus,
	                "loanProdType": KendraApp.selectedCustomer.addLoanDetailsObj.selEligibleLoanDtls.loanProdType
	            };
	            var bankDtls = {
	                "bankAccNo": KendraApp.selectedCustomer.bankAccNo,
	                "bankAccName": KendraApp.selectedCustomer.bankAccName,
	                "bankBranchName": KendraApp.selectedCustomer.bankBranchName,
	                "bankName": KendraApp.selectedCustomer.bankName,
	                "bankIfscCode": KendraApp.selectedCustomer.bankIfscCode
	            };
	            /*var depDetails = {
	                "customerId": KendraApp.selectedCustomer.customerId,
	                "name": KendraApp.selectedCustomer.depName.split(',')[0],
	                "dob": KendraApp.selectedCustomer.depDob.split(',')[0],
	                "memRelation": KendraApp.selectedCustomer.memRelation.split(',')[0],
	                "legaldocId": KendraApp.selectedCustomer.depDocId.split(',')[0],
	                "legaldocName": KendraApp.selectedCustomer.depDocType.split(',')[0]
	            };*/
	            var addressDtls = [{
	                "addressType": "P",
	                "addLine1": KendraApp.selectedCustomer.permAddLine1,
	                "addLine2": KendraApp.selectedCustomer.permAddLine2,
	                "state": KendraApp.selectedCustomer.permanentState,
	                "district": KendraApp.selectedCustomer.permanentDistrict,
	                "villageLocality": KendraApp.selectedCustomer.permanentVillageLocality,
	                "pincode": KendraApp.selectedCustomer.permanentPincode,
	                "taluk": KendraApp.selectedCustomer.permanentTaluk
	            }, {
	                "addressType": "C",
	                "addLine1": !apz.isNull(KendraApp.selectedCustomer.commAddLIne1) ? KendraApp.selectedCustomer
	                    .commAddLIne1 : KendraApp.selectedCustomer.permAddLine1,
	                "addLine2": !apz.isNull(KendraApp.selectedCustomer.commAddLIne2) ? KendraApp.selectedCustomer
	                    .commAddLIne2 : KendraApp.selectedCustomer.permAddLine2,
	                "state": !apz.isNull(KendraApp.selectedCustomer.commState) ? KendraApp.selectedCustomer.commState : KendraApp
	                    .selectedCustomer.permanentState,
	                "district": !apz.isNull(KendraApp.selectedCustomer.commDistrict) ? KendraApp.selectedCustomer
	                    .commDistrict : KendraApp.selectedCustomer.permanentDistrict,
	                "villageLocality": !apz.isNull(KendraApp.selectedCustomer.commVillageLocality) ? KendraApp.selectedCustomer
	                    .commVillageLocality : KendraApp.selectedCustomer.permanentVillageLocality,
	                "pincode": !apz.isNull(KendraApp.selectedCustomer.commPincode) ? KendraApp.selectedCustomer.commPincode : KendraApp
	                    .selectedCustomer.permanentPincode,
	                "taluk": !apz.isNull(KendraApp.selectedCustomer.commTaluk) ? KendraApp.selectedCustomer.commTaluk : KendraApp
	                    .selectedCustomer.permanentTaluk
	            }];
	            addressDtls[0].state = ApzCOB.fetchStateCode(addressDtls[0].state);
	            addressDtls[1].state = ApzCOB.fetchStateCode(addressDtls[1].state);
	            /*addressDtls[0].permAddLine1 = addressDtls[0].permAddLine1.replace(/[^A-Z0-9]/ig, " ");
	            addressDtls[1].permAddLine1 = addressDtls[1].permAddLine1.replace(/[^A-Z0-9]/ig, " ");
	            addressDtls[0].permAddLine2 = addressDtls[0].permAddLine2.replace(/[^A-Z0-9]/ig, " ");
	            addressDtls[1].permAddLine2 = addressDtls[1].permAddLine2.replace(/[^A-Z0-9]/ig, " ");*/
	            var applid = '';
	            var ver = '';
	            if (!apz.isNull(KendraApp.AppCreateResObj.applicationId)) {
	                applid = KendraApp.AppCreateResObj.applicationId;
	                ver = KendraApp.AppCreateResObj.versionNo;
	            }
	             var activeLoanCount = '0';
	             var outstandingPrincipal = '0';
	             var overduePrincipal = '0';
	             if (KendraApp.activeLoanDtls) {
	                 activeLoanCount = KendraApp.activeLoanDtls.length;
	                 KendraApp.selectedCustomer.loanDtls.forEach((item) => {
	                     overduePrincipal = parseFloat(overduePrincipal) + parseFloat(item.overduePrincipal) || 0;
	                     outstandingPrincipal = parseFloat(outstandingPrincipal) + parseFloat(item.outstandingPrincipal) || 0;
	                 });
	             }
	            loanRequest.applicationdtls = {
	                "refId": KendraApp.selectedCustomer.addLoanDetailsObj.scrDataStep1.appId,
	                "applicationId": applid,
	                //"version_no": "",
	                "versionNo": ver,
	                "createdBy": LoggedInUserDetails.userID,
	                "applicationDate": ApzCOB.dateMMDDYYYYformat(),
	                "approvalLevel": "",
	                "status": 'INITIATE',
	                "kmId": KendraApp.selectedKendra.kmId,
	                "kendraName": KendraApp.selectedKendra.kendraName,
	                "kendraId": KendraApp.selectedKendra.kendraId,
	                "branchId": KendraApp.selectedKendra.branchId,
	                "groupId": KendraApp.selectedCustomer.groupId,
	                "leader": KendraApp.selectedKendra.leader,
	                "productGroupCode": inputLoanRole,
	                "createTs": ApzCOB.currentTimeStamp(),
	                "ModifyTs": ApzCOB.currentTimeStamp(),
	                "updatedBy": LoggedInUserDetails.userID,
	                "customerId": KendraApp.selectedCustomer.customerId,
	                "appVersion":appVersion,
	                "activeLoanCount":activeLoanCount,
	                "outstandingPrincipal":outstandingPrincipal,
	                "outstandingInterest":overduePrincipal,
	                "kendrafrequency":KendraApp.selectedKendra.meetingFrequency,
	                "meetingday":KendraApp.selectedKendra.meetingDay,
	                "loanfrequency":KendraApp.selectedCustomer.addLoanDetailsObj.scrDataStep1.repayFrequency.idDesc,
	                "remarks":"NEW",
	                "customerDtls": {}
	            };
	            var kycDetails = {
	                'activationDate': ApzCOB.plaintoDateformat(KendraApp.selectedCustomer.activationDate, '-'),
	                'dob': KendraApp.selectedCustomer.dob,
	                "maritalStatus": KendraApp.selectedCustomer.maritalStatus,
	                'memRelation': KendraApp.selectedCustomer.memRelation,
	                "mobileNum": KendraApp.selectedCustomer.mobileNum,
	                'primaryId': KendraApp.selectedCustomer.primaryId,
	                "primaryType": KendraApp.selectedCustomer.primaryType,
	                'vintage': KendraApp.selectedCustomer.custVintage,
	                'stateBranch': ApzCOB.fetchStateCode(KendraApp.selectedKendra.officeData.state)
	            };
	            loanRequest.applicationdtls.customerDtls = {
	                'customerId': KendraApp.selectedCustomer.customerId,
	                "customerName": KendraApp.selectedCustomer.customerName,
	                "kycDtls": kycDetails,
	                //"mobileNum": KendraApp.selectedCustomer.mobileNum,
	                "income": KendraApp.selectedCustomer.income,
	                "earnings": KendraApp.selectedCustomer.household,
	                'bankDtls': bankDtls,
	                "addressDtls": addressDtls,
	                "loanDtls": loanDtls
	            }
	            return loanRequest;
	        },
	        filterBusinessDays: function(screenid) {
	            window.newBusinessDays = [];
	            var currentDate = new Date();
	            if (!apz.isNull(collectionServerDate)) {
	                currentDate = new Date(collectionServerDate.substring(0, 4).concat('-').concat(collectionServerDate.substring(4, 6).concat('-').concat(
	                    collectionServerDate.substring(6, 8))));
	            }
	            var myDate = currentDate;
	            for (var i = 0; i <= 6; i++) {
	                businessDays.forEach(function(j, k) {
	                    if ((myDate.getDay() !== 6 && myDate.getDay() !== 0) && myDate.getDay() === j.dayNo) {
	                        var obj = {
	                            "date": myDate.toLocaleDateString('en-GB'),
	                            "formattedDate": myDate.toLocaleDateString('en-GB'),
	                            "dayDesc": j.dayDesc,
	                            "dayShort": j.dayShort
	                        }
	                        window.newBusinessDays.push(obj);
	                    }
	                });
	                myDate = new Date(myDate.setDate(myDate.getDate() + 1));
	            }
	            if (window.newBusinessDays.length > 1) {
	                window.newBusinessDays[0].date = "Today " + window.newBusinessDays[0].date;
	                if (screenid === 'InProgress') {
	                    var selectedformattedDate = ApzCOB.ddmmyyyytoyyyymmdd(window.newBusinessDays[0].formattedDate);
	                    if (apz.isNull(userSelectedDay)) {
	                        if (window.currentUserRole === "DEO") {
	                            apz.app.InProgress.fetchDataDeo(window.newBusinessDays[0].dayShort);
	                        } else {
	                            apz.app.InProgress.fetchData(window.newBusinessDays[0].dayShort);
	                        }
	                    } else {
	                        if (window.currentUserRole === "DEO") {
	                            apz.app.InProgress.fetchDataDeo(userSelectedDay);
	                        } else {
	                            apz.app.InProgress.fetchData(userSelectedDay);
	                        }
	                    }
	                    if (window.newBusinessDays[0].dayDesc !== "Friday") {
	                        window.newBusinessDays[1].date = "Tomorrow " + window.newBusinessDays[1].date;
	                    }
	                    apz.data.scrdata.Dashbo__IPaintDates_Res = {};
	                    apz.data.scrdata.Dashbo__IPaintDates_Res = window.newBusinessDays;
	                    apz.data.loadData("IPaintDates", 'Dashbo');
	                }
	            }
	            if (screenid === 'dashboard') {
	                apz.data.scrdata.Dashbo__IPaintDates_Res = {};
	                apz.data.scrdata.Dashbo__IPaintDates_Res = window.newBusinessDays;
	                apz.data.loadData("IPaintDates", 'Dashbo');
	                ApzCOB.toggleModal(DashboardScrId + "dateSelectModal");
	            }
	        },
	        fetchLoanProduct: function() {
	            var req = {
	                "apiRequest": {
	                    "interfaceName": "FetchLoanProduct",
	                    "requestObj": {}
	                }
	            }
	            if (apz.deviceType !== 'WEB') {
	                apz.app.BaseScreens.UEstartTimer("Fetch Loan Product", req);
	                apz.app.BaseScreens.UElogevent("Fetch Loan Product", req);
	            }
	            ApzCOB.serverBuildParam(gAppId, 'FetchLoanProduct', 'N', 'N', req, 'Y', ApzCOB.fetchLoanProductCB);
	        },
	        fetchLoanProductCB: function(params) {
	            if (apz.deviceType !== 'WEB') {
	                apz.app.BaseScreens.UEstopTimer("Fetch Loan Product", params.req);
	            }
	            // console.log('params', params);
	            //if (ApzCOB.handleServiceCallBacks(params)) {
	            if (!apz.isNull(params.res.APZCBO__FetchLoanProduct_Res.responseObj)) {
	                var prodRes = params.res.APZCBO__FetchLoanProduct_Res.responseObj;
	                ApzCOB.setPref('ProductResponse', prodRes);
	                window.KendraApp.ProductResponse = [];
	                window.KendraApp.InstantProductResponse = [];
	                window.KendraApp.ProductList = [];
	                prodRes.filter(function(m) {
	                    if ((m.productDtls.loanProdType === "normal" || m.productDtls.loanProdType === "instant") && m.productDtls
	                        .productStatus === "Active") {
	                        window.KendraApp.ProductResponse.push(m);
	                    } else if (m.productDtls.loanProdType === "instant" && m.productDtls.productStatus == "Active") {
	                        window.KendraApp.InstantProductResponse.push(m);
	                    }
	                })
	                window.KendraApp.ProductList = prodRes;
	                appStage = 'loanProductList';
	                /*     for (let i = KendraApp.ProductResponse.length - 1; i >= 0; i--) {
	                    if (KendraApp.ProductResponse[i].productDtls && KendraApp.ProductResponse[i].productDtls.description === "Emergency Loan") {
	                        // Delete the product at index i from the ProductResponse array
	                        KendraApp.ProductResponse.splice(i, 1);
	                    }
	                }*/
	            } else {
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E", ApzCOB.ReloadApp);
	            }
	            /*} else {
	                apz.stopLoader();
	                    ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E", ApzCOB.ReloadApp);
	            }*/
	            // ApzCOB.launchMicroApp('Login', 'Login', BaseScrId + 'BaseDIV', '');
	        },
	        fetchKendraDetails: function(pkendraid) {
	            var req = {
	                "apiRequest": {
	                    "interfaceName": "FetchKendraDetails",
	                    "requestObj": {
	                        "KendraUserId": pkendraid
	                    }
	                }
	            }
	            apz.startLoader();
	            if (apz.deviceType !== 'WEB') {
	                apz.app.BaseScreens.UEstartTimer("Fetch Kendra Details List", req);
	                apz.app.BaseScreens.UElogevent("Fetch Kendra Details List", req);
	            }
	            ApzCOB.serverBuildParam(gAppId, 'FetchKendraDetails', 'N', 'N', req, 'Y', ApzCOB.fetchKendraDetailsCB);
	            //ApzCOB.customlogincallback();
	        },
	        fetchKendraDetailsCB: function(params) {
	            if (apz.deviceType !== 'WEB') {
	                apz.app.BaseScreens.UEstopTimer("Fetch Kendra Details List", params.req);
	            }
	            if (ApzCOB.handleServiceCallBacks(params)) {
	                if (!apz.isNull(params.res.APZCBO__FetchKendraDetails_Res.apiResponse.ResponseBody.responseObj)) {
	                    var kendraRes = params.res.APZCBO__FetchKendraDetails_Res.apiResponse.ResponseBody.responseObj;
	                    ApzCOB.setPref('KendraResponse', kendraRes);
	                    window.KendraApp.KendraResponse = kendraRes;
	                    window.KendraApp.KendraResponsenew = JSON.parse(JSON.stringify(window.KendraApp.KendraResponse));
	                    // if (window.userRole === 'BM') {
	                    //     ApzCOB.updateKendraResponse();
	                    // }
	                    //modified by Sathish on 18-02-2025
	                    //commented below and added in FetchCollectionDataCB as data is not loading for Kendra widget data for collections
	                    // ApzCOB.dashboardAppListAPI();
	                    if (userRole === "KM") {
	                        if(window.accessType==='LC' ||window.accessType==='CL'){
	                           ApzCOB.FetchCollectionData(window.LoggedInUserDetails.userID); 
	                        }else{
	                           ApzCOB.dashboardAppListAPI(); 
	                        }
	                    } else {
	                        ApzCOB.dashboardAppListAPI();
	                    }
	                    //commented below call and added in dashboardAppListAPI as we have to hide deceased customers list in dashboardApi list call
	                    //commented on 07-02-2025 by sathish
	                    //for UAT Issue UNAP-1065
	                    // ApzCOB.fetchDeathIntimationBMDetails();
	                    //ApzCOB.customlogincallback();
	                } else {
	                    apz.stopLoader();
	                    //ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E", ApzCOB.ReloadApp);
	                    ApzCOB.fnDisplayMsg('Unable to fetch CDH data. Please retry again.!', "E");
	                    window.isSelfAssigned = false;
	                }
	            } else {
	                apz.stopLoader();
	                window.isSelfAssigned = false;
	                ApzCOB.fnDisplayMsg('Unable to fetch CDH data. Please retry again.!', "E");
	                //ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E", ApzCOB.ReloadApp);
	            }
	            // console.log('params', params);
	        },
	        FetchCollectionData: function(kendraId) {
	            var req = {
	                "apiRequest": {
	                    "interfaceName": "FetchCollectionData",
	                    "requestObj": {
	                        "KendraUserId": kendraId,
	                        "meetingDate": FetchMeetingDtRecord
	                    }
	                }
	            }
	            if (currentUserRole === "DEO") {
	                req.apiRequest.requestObj.KendraRoleId = "DEO";
	            }
	            apz.startLoader();
	            let sessionReq = '';
	            if (isDateSelected) {
	                sessionReq = 'N'
	            } else {
	                sessionReq = 'Y'
	            }
	            ApzCOB.serverBuildParam(gAppId, 'FetchCollectionData', 'N', 'N', req, sessionReq, ApzCOB.FetchCollectionDataCB);
	        },
	        FetchCollectionDataCB: function(params) {
	            if (ApzCOB.handleServiceCallBacks(params)) {
	                var ifaceName = ApzCOB.GetInterfaceResMap(params);
	                if (params.res[ifaceName].apiResponse.ResponseBody.hasOwnProperty('collectionsObj')) {
	                    collectionsRes = [];
	                    collectionsRes = params.res.APZCBO__FetchCollectionData_Res.apiResponse.ResponseBody.collectionsObj;
	                    let collectionResBody = params.res.APZCBO__FetchCollectionData_Res.apiResponse.ResponseBody;
	                    if (collectionResBody.hasOwnProperty("serverDate")) {
	                        collectionServerDate = collectionResBody.serverDate;
	                    }
	                    if (!apz.isNull(collectionsRes) && collectionsRes.length > 0) {
	                        if (apz.deviceType !== 'WEB') {
	                            selectedDay = collectionsRes[0].meetingDay;
	                            collectionKendraData = CollectionsCommon.returnActCollectionKenData(collectionsRes);
	                            //added below function to set kendra death object to use in multiple places
	                            CollectionsCommon.createKendrasDeathIntObj();
	                            // Added for filter of meetingDate records
	                            if (collectionResBody.hasOwnProperty("serverDate")) {
	                                collectionKendraData = collectionKendraData.filter(obj => obj.meetingDate.replaceAll('-', '') === collectionServerDate);
	                            }
	                            parDisplayColData = JSON.parse(JSON.stringify(collectionKendraData));
	                            CollectionsCommon.fetchFromCollectionSQLLite();
	                        }
	                    } else {
	                        collectionKendraData = [];
	                    }
	                    //added on 18-02-2025 by sathish
	                    //to load collections data first time post getting collections response
	                    if (currentUserRole === "DEO") {
	                        ApzCOB.fetchSRRequestList();
	                    } else {
	                       ApzCOB.dashboardAppListAPI();
	                    }
	                } else {
	                    apz.stopLoader();
	                    ApzCOB.fnDisplayMsg('Unable to fetch Collection data. Please retry again.!', "E");
	                }
	            } else {
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg('Unable to fetch Collection data. Please retry again.!', "E");
	            }
	        },
	        fetchCustDetailsDeo: function(kendraID) {
	            var req = {
	                "apiRequest": {
	                    "interfaceName": "kendraCustomerDetails",
	                    "requestObj": {
	                        "latLongFlag": "",
	                        "KendraUserId": "",
	                        "KendraRoleId": "",
	                        "KendraId": [
	                            kendraID
	                        ]
	                    }
	                }
	            }
	            apz.stopLoader();
	            ApzCOB.serverBuildParam(gAppId, 'kendraCustomerDetails', 'N', 'N', req, 'Y', ApzCOB.fetchCustDetailsDeoCB);
	        },
	        fetchCustDetailsDeoCB: function(params) {
	            var custListRespDeo
	            if (ApzCOB.handleServiceCallBacks(params)) {
	                if (!apz.isNull(params.res.APZCBO__kendraCustomerDetails_Res.apiResponse.ResponseBody.responseObj)) {
	                    custListRespDeo = params.res.APZCBO__kendraCustomerDetails_Res.apiResponse.ResponseBody.responseObj;
						if(isCollectionDeo === true){
	                        apz.app.RepeatCollection.fetchcustomerDetailsDeo(custListRespDeo);
	                        isCollectionDeo = false;
	                    } else if (isCollectionCustomerDeo=== true) {
	                        apz.app.KendriyaMeetings.selectKendradeo(custListRespDeo);
	                        isCollectionCustomerDeo = false;
	                    } else if (isCollectionCustomerdataDeo=== true) {
	                        apz.app.ViewKendraDetails.selectKendradeo(custListRespDeo);
	                        isCollectionCustomerdataDeo = false;
	                    } else if (isCustomerDetailEdit=== true) {
	                        apz.app.EditGroupsData.selectKendradeo(custListRespDeo);
	                        isCustomerDetailEdit = false;
	                    } else if (apz.currAppId === 'Widget') {
	                        if(typeof myKendraFlow !== "undefined" && myKendraFlow === true){
                                apz.app.Dashboard.getKendraDetailDeo(custListRespDeo);
							}else{
								apz.app.InProgress.selectKendraDeo(custListRespDeo);
							}
	                    } else if (apz.currAppId === 'NEWLOA') {
	                        apz.app.FabNewLoanApplication.selectKendraDeo(custListRespDeo);
	                    } else if (apz.childScr === 'BMApproval') {
	                        apz.app.BMApproval.paintLoanAmount(custListRespDeo);
	                    } else if (apz.childScr === 'ViewKendraDetails') {
	                        apz.app.ViewKendraDetails.launchMemDetScr(custListRespDeo);
	                    }else if (apz.childScr === 'AllLoanApplication') {
	                        apz.app.AllLoanApplication.selectKendraDeo(custListRespDeo);
	                    }else if (apz.childScr === 'KendraDetails') {
	                        apz.app.KendraDetails.getCustomerDetails(custListRespDeo);
	                    }
	                } else {
	                    custListRespDeo = [];
	                    if (apz.currAppId === 'Widget') {
	                        if(typeof myKendraFlow !== "undefined" && myKendraFlow === true){
                                apz.app.Dashboard.getKendraDetailDeo(custListRespDeo);
							}else{
								apz.app.InProgress.selectKendraDeo(custListRespDeo);
							}
	                    } else if (apz.currAppId === 'NEWLOA') {
	                        apz.app.FabNewLoanApplication.selectKendraDeo(custListRespDeo);
	                    }else if (apz.childScr === 'AllLoanApplication') {
	                        apz.app.AllLoanApplication.selectKendraDeo(custListRespDeo);
	                    }else if (apz.childScr === 'KendraDetails') {
	                        apz.app.KendraDetails.getCustomerDetails(custListRespDeo);
	                    }
	                }
	            } else {
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E", ApzCOB.ReloadApp);
	            }
	        },
	        // Switching UserRoles
	        fetchKendraDetailsDeo: function(branchid) {
	            var req = {
	                "apiRequest": {
	                    "interfaceName": "DashboardAppListAPINew",
	                    "branchId": branchid,
	                    "requestObj": {}
	                }
	            }
	            ApzCOB.serverBuildParam(gAppId, 'DashboardAppListAPINew', 'N', 'N', req, 'Y', ApzCOB.fetchKendraDetailsDeoCB);
	            //ApzCOB.customlogincallback();
	        },
	        fetchKendraDetailsDeoCB: function(params) {
	            if (ApzCOB.handleServiceCallBacks(params)) {
	                if (!apz.isNull(params.res.APZCBO__DashboardAppListAPINew_Res.apiResponse.ResponseBody.responseObj)) {
	                    /*var kendraRes = JSON.parse(params.res.APZCBO__DashboardAppListAPINew_Res.apiResponse.ResponseBody.responseObj);
	                    ApzCOB.setPref('KendraResponse', kendraRes);
	                    window.KendraApp.KendraResponse = kendraRes;
	                    ApzCOB.dashboardAppListAPI();*/
	                    //ApzCOB.customlogincallback();
	                    dashboardAppList.response = JSON.parse(params.res.APZCBO__DashboardAppListAPINew_Res.apiResponse.ResponseBody
	                        .responseObj);
	                    dashboardAppList.response = dashboardAppList.response.sort((a, b) => new Date(b.wfCreateTs) - new Date(a.wfCreateTs));
	                    //ApzCOB.customlogincallback();
	                    //modified for Fetching Collection data for DEO role
	                   // ApzCOB.fetchSRRequestList();
	                    ApzCOB.FetchCollectionData(window.LoggedInUserDetails.userID);
	                } else {
	                    dashboardAppList.response = {};
	                    //ApzCOB.customlogincallback();
	                    ApzCOB.FetchCollectionData(window.LoggedInUserDetails.userID);
	                   // ApzCOB.fetchSRRequestList();
	                }
	            } else {
	                if (params.res.APZCBO__DashboardAppListAPINew_Res.apiResponse.ResponseHeader.ResponseCode === 'NR100') {
	                    dashboardAppList.response = {};
	                    //ApzCOB.customlogincallback();
	                    ApzCOB.FetchCollectionData(window.LoggedInUserDetails.userID);
	                   // ApzCOB.fetchSRRequestList();
	                } else {
	                    dashboardAppList.response = {};
	                    //ApzCOB.customlogincallback();
	                    ApzCOB.FetchCollectionData(window.LoggedInUserDetails.userID);
	                   // ApzCOB.fetchSRRequestList();
	                }
	                //ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E", ApzCOB.ReloadApp);
	            }
	            // console.log('params', params);
	        },
	        fetchUserRoles: function() {
	            var req = {
	                "apiRequest": {
	                    "interfaceName": "UserRoleFetch",
	                    "appId": gAppId,
	                    "userId": LoggedInUserDetails.userID,
	                    "requestObj": {
	                        "userId": LoggedInUserDetails.userID
	                    }
	                }
	            }
	            ApzCOB.serverBuildParam(gAppId, 'UserRoleFetch', 'N', 'N', req, 'Y', ApzCOB.fetchUserRolesCB);
	        },
	        fetchUserRolesCB: function(params) {
	            console.log(params);
	            if (ApzCOB.handleServiceCallBacks(params)) {
	                var FetchUserResp = params.res.APZCBO__UserRoleFetch_Res.apiResponse.ResponseBody.responseObj
	                var responseObj = JSON.parse(FetchUserResp);
	                var userRolesString = responseObj.userRole;
	                var userRolesResp = JSON.parse(userRolesString);
	                if(!apz.isNull(responseObj.user_type)){
	                    window.accessType=responseObj.user_type; 
	                }
	                //added for entry of cashier to the role switch for KM
	                userRolesResp.forEach(res => {
	                    if (!apz.isNull(res.roleId) && res.roleId.toUpperCase() === "CASHIER") {
	                        res.roleId = "CASHIER";
	                    }
	                });
	                /*var isCashierRolePresent = userRolesResp.filter(res => {
	                    if (!apz.isNull(res.roleId) && res.roleId.toUpperCase() === "CASHIER") {
	                        res.roleId = res.roleId.toUpperCase();
	                        return res;
	                    }
	                });
					if (isCashierRolePresent.length === 0 && (userRole !== 'CASHIER' || userRole !== "Cashier")) {
	                    let cashierObj = {
	                        "userId": "GK15661",
	                        "roleId": "CASHIER",
	                        "appId": gAppId,
	                        "createUserId": "admin",
	                        "createTs": 1732531495734,
	                        "versionNum": 1
	                    }
	                    userRolesResp.push(cashierObj);
	                }*/
	                if (userRole === 'CASHIER') {
	                    userRolesResp[0].roleId = 'CASHIER';
	                }
	                window.FetchUserResponse = userRolesResp;
	            } else {
	                //ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E", ApzCOB.ReloadApp);
	            }
	            if (window.FetchUserResponse.length == 1) {
	                if (window.FetchUserResponse[0].roleId == 'KM' && apz.deviceType == 'WEB') {
	                    apz.stopLoader();
	                    ApzCOB.fnDisplayMsg('User is not allowed for web', "E", ApzCOB.ReloadApp);
	                    return;
	                } else if (['AM', 'RM', 'DM', 'ZM','SH'].includes(window.FetchUserResponse[0].roleId) && apz.deviceType !== 'WEB') {
	                    apz.stopLoader();
	                    ApzCOB.fnDisplayMsg('User is not allowed for Phone', "E", ApzCOB.ReloadApp);
	                    return;
	                }
	            }
	        },
	        fetchKendraDetailsDeoRole: function(pkendraid, role) {
	            var reqObj = {
	                "KendraUserId": pkendraid,
	                "KendraRoleId": role
	            }
	            if (!window.isSelfAssigned) {
	                reqObj.latLongFlag = true;
	            }
	            var req = {
	                "apiRequest": {
	                    "interfaceName": "FetchKendraDetails",
	                    "requestObj": reqObj
	                }
	            }
	            apz.startLoader();
	            ApzCOB.serverBuildParam(gAppId, 'FetchKendraDetails', 'N', 'N', req, 'Y', ApzCOB.fetchKendraDetailsDeoRoleCB);
	            //ApzCOB.customlogincallback();
	        },
	        fetchKendraDetailsDeoRoleCB: function(params) {
	            if (ApzCOB.handleServiceCallBacks(params)) {
	                if (!apz.isNull(params.res.APZCBO__FetchKendraDetails_Res.apiResponse.ResponseBody.responseObj)) {
	                    var kendraRes = params.res.APZCBO__FetchKendraDetails_Res.apiResponse.ResponseBody.responseObj;
	                    ApzCOB.setPref('KendraResponse', kendraRes);
	                    if (window.isSelfAssigned) {
	                        if (kendraRes.length !== 0) {
	                            window.KendraApp.KendraResponse = kendraRes;
	                            window.KendraApp.KendraResponsenew = JSON.parse(JSON.stringify(window.KendraApp.KendraResponse));
	                            ApzCOB.dashboardAppListAPI();
	                        } else {
	                            ApzCOB.fnDisplayMsg('No Kendra is available for this user!', "I");
	                            $('#APZCBO__BaseScreens__userRole').val('BM');
	                            window.isSelfAssigned = false;
	                            $('#Dashbo__dashboard__myActivityDashbordDiv').removeClass('sno');
	                            $("#Dashbo__dashboard__sc_col_9_li").parent().addClass('sno');
	                            $("#APZCBO__BaseScreens__sc_col_333_li").parent().removeClass('sno');
	                            $("#Dashbo__dashboard__userRoleList_row_1").prop('checked', false);
	                            $("#Dashbo__dashboard__userRoleList_row_0").prop('checked', true);
	                            apz.stopLoader();
	                        }
	                    } else {
	                        window.KendraApp.KendraResponse = kendraRes;
	                        window.KendraApp.KendraResponsenew = JSON.parse(JSON.stringify(window.KendraApp.KendraResponse))
	                        ApzCOB.fetchKendraDetailsDeo(LoggedInUserDetails.loginResponse.addInfo2);
	                    }
	                    //ApzCOB.customlogincallback();
	                } else {
	                    apz.stopLoader();
	                    //ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E", ApzCOB.ReloadApp);
	                    ApzCOB.fnDisplayMsg('Unable to fetch CDH data. Please retry again.!', "E");
	                    if (window.isSelfAssigned) {
	                        $('#APZCBO__BaseScreens__userRole').val('BM');
	                        window.isSelfAssigned = false;
	                        $("#APZCBO__BaseScreens__sc_col_333_li").parent().removeClass('sno');
	                        $("#Dashbo__dashboard__sc_col_9_li").parent().addClass('sno');
	                        $('#Dashbo__dashboard__myActivityDashbordDiv').removeClass('sno');
	                    }
	                }
	            } else {
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg('Unable to fetch CDH data. Please retry again.!', "E");
	                if (window.isSelfAssigned) {
	                    $('#APZCBO__BaseScreens__userRole').val('BM');
	                    window.isSelfAssigned = false;
	                    $("#APZCBO__BaseScreens__sc_col_333_li").parent().removeClass('sno');
	                    $("#Dashbo__dashboard__sc_col_9_li").parent().addClass('sno');
	                    $('#Dashbo__dashboard__myActivityDashbordDiv').removeClass('sno');
	                }
	                //ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E", ApzCOB.ReloadApp);
	            }
	            // console.log('params', params);
	        },
	        setPref: function(keyName, pjson) {
	            var jsonStr = {};
	            jsonStr.id = "SET_PREF";
	            jsonStr.key = keyName;
	            jsonStr.value = pjson;
	            jsonStr.callBack = ApzCOB.setPrefCB;
	            if (apz.deviceType !== 'WEB') {
	                apz.ns.setPref(jsonStr);
	            }
	        },
	        setPrefCB: function(params) {
	            //  console.log('params', params);
	            //ApzCOB.getPref('KendraResponse');
	        },
	        getPref: function(keyName) {
	            var cbObj = {};
	            cbObj.keyName = keyName;
	            var json = {};
	            json.id = "GET_PREF";
	            json.callBackObj = cbObj;
	            json.callBack = ApzCOB.getPrefCB;
	            json.key = keyName;
	            if (apz.deviceType !== 'WEB') {
	                apz.ns.getPref(json);
	            }
	        },
	        getPrefCB: function(params) {
	            if (params.status) {
	                switch (params.callBackObj.keyName) {
	                    case "CommonCodes":
	                        if (apz.isNull(params.value)) {
	                            ApzCOB.fnDisplayMsg(
	                                "To ensure optimal functionality, please launch the application while connected to the internet. Thank you!",
	                                "E");
	                        } else {
	                            CommonCodes = params.value;
	                            if (!window.isNwAvailable) {
	                                ApzCOB.getPref('ProductResponse');
	                            }
	                        }
	                        break;
	                    case "ProductResponse":
	                        if (apz.isNull(params.value)) {
	                            ApzCOB.fnDisplayMsg(
	                                "To ensure optimal functionality, please launch the application while connected to the internet. Thank you!",
	                                "E");
	                        } else {
	                            window.KendraApp.ProductResponse = params.value;
	                            if (!window.isNwAvailable) {
	                                //ApzCOB.getPref('KendraResponse');
	                                ApzCOB.getPref('LoggedInUserDetails');
	                            }
	                        }
	                        break;
	                    case "LoggedInUserDetails":
	                        if (apz.isNull(params.value)) {
	                            ApzCOB.fnDisplayMsg(
	                                "To ensure optimal functionality, please login the application while connected to the internet. Thank you!",
	                                "E");
	                        } else {
	                            window.LoggedInUserDetails = params.value;
	                        }
	                        break;
	                    case "KendraResponse":
	                        if (apz.isNull(params.value)) {
	                            ApzCOB.fnDisplayMsg(
	                                "To ensure optimal functionality, please launch the application while connected to the internet. Thank you!",
	                                "E");
	                        } else {
	                            //window.KendraApp.KendraResponse = params.value;
	                        }
	                        break;
	                    case "WidgetConf":
	                        if (apz.isNull(params.value)) {
	                            ApzCOB.fnDisplayMsg(
	                                "To ensure optimal functionality, please launch the application while connected to the internet. Thank you!",
	                                "E");
	                        } else {
	                            WidgetConf = params.value;
	                        }
	                        break;
	                    default:
	                        CommonCodes = params.value;
	                }
	            }
	            //console.log('params', params);
	            //dashboardObj[keyName]=
	        },
	        isNetworkAvailable: function(requestObj) {
	            if (apz.deviceType !== 'WEB') {
	                var json = {};
	                json.id = "NTW_AVIL_ID";
	                json.callBack = ApzCOB.isNetworkAvailableCB;
	                apz.ns.isNetworkAvailable(json);
	            } else {
	                window.isNwAvailable = true;
	            }
	        },
	        isNetworkAvailableCB: function(params) {
	            //console.log(params);
	            let isNetworkAvailable = params.isNetworkAvailable;
	            window.isNwAvailable = isNetworkAvailable === "Y" ? true : false;
	            if (window.isNwAvailable) {
	                apz.dispMsgCleanup();
	                //ApzCOB.fnDisplayMsg("App is Online", "S");
	                //apz.app.Login.sqlite();
	            } else {
	                ApzCOB.fnDisplayMsg("Looks like your're not connected to a network. Check your settings and try again.", "E", ApzCOB
	                    .ReloadApp);
	                //ApzCOB.fnDisplayMsg("App is running in offline mode", "E");
	            }
	        },
	        prepareCommonCode: function() {
	            gApzCOB.CommonCodes.forEach(function(e,
	            i) { //Convert all keys to uppercase since keys from common code are in upper case, keys from property file are in lower case
	                e.paramName = e.paramName.toUpperCase();
	            })
	            window.demoMode = ApzCOB.GetCommonCodes("DEMOMODE");
	            window.createapplnworkflowConf = ApzCOB.GetCommonCodes("WORKFLOWDEFINITIONMAPPER");
	            gApzCOB.demoMode = window.demoMode;
	            gApzCOB.CobCallCBS = ApzCOB.GetCommonCodes("COBCALLCBSFLAG");
	            gApzCOB.DepCallCBS = ApzCOB.GetCommonCodes("DEPCALLCBSFLAG");
	            gApzCOB.fundAccount = ApzCOB.GetCommonCodes("FUNDACCOUNT");
	            window.WidgetConf = ApzCOB.GetCommonCodes("WIDGETSBO").WIDGETSBO;
	            window.Ocr_Required = ApzCOB.GetCommonCodes("KYCVERIFICATION")["KYCVERIFICATION"]["OCR_Required"] === "Y" ? true : false;
	            window.inSessionStoreMasterEnabled = ApzCOB.GetCommonCodes("APPCONTROL")["LOCALSAVE"][0].split('~')[1] === 'Y' ? true :
	            false; //master variable to check if store unsaved data feature is enabled
	            /**SelfAssisted related Changes Starts***/
	            // apz.app.BaseScreens.getCommomCodeBasedOnProduct();
	        },
	        dashboardAppListAPI: function() {
	            apz.startLoader();
	            var keyValue = '';
	            var kendra = [];
	            var role = '';
	            if (window.userRole == 'BM' || window.userRole == 'CASHIER') {
	                keyValue = LoggedInUserDetails.loginResponse.addInfo2;
	            } else if (['AM', 'RM', 'DM', 'ZM','SH'].includes(window.userRole)) {
	                role = window.userRole;
	            } else {
	                keyValue = LoggedInUserDetails.userID;
	                window.KendraApp.KendraResponsenew.forEach(function(index, i) {
	                    // console.log(index.kendraDtls.kendraId)
	                    kendra.push(index.kendraDtls.kendraId);
	                });
	            }
	            if (window.isSelfAssigned) {
	                role = '';
	                keyValue = LoggedInUserDetails.userID;
	                window.KendraApp.KendraResponsenew.forEach(function(index, i) {
	                    // console.log(index.kendraDtls.kendraId)
	                    kendra.push(index.kendraDtls.kendraId);
	                });
	            }
	            var req = {
	                "apiRequest": {
	                    "appId": gAppId,
	                    "interfaceName": "DashboardAppListAPI",
	                    // "kmId": window.LoggedInUserDetails.kmId,
	                    "kmId": keyValue,
	                    "role": role,
	                    "requestObj": {
	                        "kendra": kendra,
	                        "kmId": keyValue,
	                        "role": role,
	                        "areaId": LoggedInUserDetails.loginResponse.addInfo2
	                    }
	                }
	            }
	            if (window.userRole == 'AM') {
	                req.apiRequest.requestObj.areaId = LoggedInUserDetails.loginResponse.addInfo2;
	            }
	            /*var req = {
	                "apiRequest": {
	                    "appId": gAppId,
	                    "interfaceName": "DashboardAppListAPI",
	                    // "kmId": window.LoggedInUserDetails.kmId,
	                    "kmId": keyValue,
	                    "requestObj": {}
	                }
	            }*/
	            if (window.userRole == 'AM' || window.userRole == 'RM' | window.userRole == 'ZM' || window.userRole == 'DM' || window.userRole == 'SH') {
	                req.apiRequest.requestObj.areaId = LoggedInUserDetails.loginResponse.addInfo2;
	                req.apiRequest.requestObj.kmId = LoggedInUserDetails.userID;
	            }
	            ApzCOB.serverBuildParam(gAppId, 'DashboardAppListAPI1', 'N', 'N', req, 'Y', ApzCOB.dashboardAppListAPICB);
	        },
	        dashboardAppListAPICB: function(params) {
	            if (ApzCOB.handleServiceCallBacks(params)) {
	                if (window.userRole == 'AM' || window.userRole == 'RM' | window.userRole == 'ZM' || window.userRole == 'DM' || window.userRole == 'SH') {
	                    if (!apz.isNull(params.res.APZCBO__DashboardAppListAPI1_Res.apiResponse.ResponseBody.responseObj)) {
	                        dashboardAppList.response = JSON.parse(params.res.APZCBO__DashboardAppListAPI1_Res.apiResponse.ResponseBody.responseObj);
	                        dashboardAppList.response = dashboardAppList.response.sort((a, b) => new Date(b.wfCreateTs) - new Date(a.wfCreateTs));
	                    } else {
	                        dashboardAppList.response = {};
	                    }
	                    ApzCOB.customlogincallback();
	                } else {
	                    if (!apz.isNull(params.res.APZCBO__DashboardAppListAPI1_Res.apiResponse.ResponseBody.responseObj)) {
	                        // to-do 
	                        dashboardAppList.response = JSON.parse(params.res.APZCBO__DashboardAppListAPI1_Res.apiResponse.ResponseBody.responseObj);
	                        dashboardAppList.response = dashboardAppList.response.sort((a, b) => new Date(b.wfCreateTs) - new Date(a.wfCreateTs));
	                        //ApzCOB.customlogincallback();
	                        ApzCOB.fetchSRRequestList();
	                    } else {
	                        dashboardAppList.response = {};
	                        //ApzCOB.customlogincallback();
	                        ApzCOB.fetchSRRequestList();
	                        // ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E", ApzCOB.ReloadApp);
	                    }
	                    if (window.accessType === 'LC' || window.accessType === 'CL') {
	                        ApzCOB.fetchDeathIntimationBMDetails();
	                    }
	                }
	            } else {
	                dashboardAppList.response = {};
	                //ApzCOB.customlogincallback();
	                if (window.userRole == 'AM' || window.userRole == 'RM' | window.userRole == 'ZM' || window.userRole == 'DM' || window.userRole == 'SH') {
	                    ApzCOB.customlogincallback();
	                } else {
	                    ApzCOB.fetchSRRequestList();
	                    if (window.accessType === 'LC' || window.accessType === 'CL') {
	                        ApzCOB.fetchDeathIntimationBMDetails();
	                    }
	                }
	                //ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E", ApzCOB.ReloadApp);
	            }
	            apz.stopLoader();
	        },
	        kmActionPostCBCheck: function() {
	            if (!rpcLoanapplication) {
	                apz.startLoader();
	            }
	            if (userRole === 'CRT' || userRole === 'KM' && window.crtRejectKM === true || isSelfAssigned && window.crtRejectKM) {
	                workflow = window.cbApproveManual === 'N' ? window.CRTworkflow : {};
	            } else if ((userRoleIfDeoAvailable.includes("DEO") || userRoleIfDeoAvailable.includes("KM") || isSelfAssigned) && window
	                .loanProduct === 'Emergency Loan') {
	                workflow = workflow = {
	                    "currentRole": "KM",
	                    "action": "NEXT",
	                    "workflowId": "SANCTION",
	                    "stage": "SANCTIONED",
	                    "remarks": ""
	                };
	            } else {
	                workflow = {};
	            }
	            var applicationDetails = [];
	            if (userRole === 'CRT') {
	                for (var i = 0; i < KendraApp.crtObj.length; i++) {
	                    applicationDetails.push({
	                        "applicationId": KendraApp.crtObj[i].applicationId,
	                        "versionNum": KendraApp.crtObj[i].versionNo
	                    });
	                }
	            } else if (rpcLoanapplication) {
	                workflow = {}
	                applicationDetails.push({
	                    "applicationId": KendraApp.currentLoanAppRequest.applicationdtls.applicationId,
	                    "versionNum": KendraApp.currentLoanAppRequest.applicationdtls.versionNo
	                });
	            } else {
	                applicationDetails.push({
	                    "applicationId": KendraApp.AppCreateResObj.applicationId,
	                    "versionNum": KendraApp.AppCreateResObj.versionNo
	                });
	            }
	            var req = {
	                "apiRequest": {
	                    "appId": gAppId,
	                    "interfaceName": "KMActionPostCBCheck",
	                    "requestObj": {
	                        "workflow": workflow,
	                        "createdBy": userRole === 'CRT' || userRole === 'RPC' ? LoggedInUserDetails.userID : KendraApp.selectedKendra
	                            .createdBy,
	                        // "applicationId": userRole === 'CRT' ? KendraApp.crtObj.applicationId : KendraApp.AppCreateResObj.applicationId,
	                        "applicationId": "",
	                        "applicationStatus": 'Move to BM',
	                        "appId": gAppId,
	                        "cbApproveManual": window.cbApproveManual,
	                        // "versionNum": userRole === 'CRT' ? KendraApp.crtObj.versionNo : KendraApp.AppCreateResObj.versionNo,
	                        "versionNum": "",
	                        "applicationDetailList": applicationDetails
	                    }
	                }
	            }
	            req.apiRequest.requestObj.userRole = currentUserRole;
	            req.apiRequest.requestObj.appVersion = appVersion;
	            req.apiRequest.requestObj.userName = LoggedInUserDetails.loginResponse.userDet.name;
	            req.apiRequest.requestObj.userId = LoggedInUserDetails.userID;
	            if(!apz.isNull(req.apiRequest.requestObj.workflow.remarks)){
	               req.apiRequest.requestObj.remarks = req.apiRequest.requestObj.workflow.remarks; 
	            }
	            if (apz.deviceType !== 'WEB') {
	                apz.app.BaseScreens.UEstartTimer("WorkflowUpdate", req);
	                apz.app.BaseScreens.UElogevent("WorkflowUpdate", req);
	            }
	            ApzCOB.serverBuildParam(gAppId, 'KMActionPostCBCheck', 'N', 'N', req, 'Y', ApzCOB.kmActionPostCBCheckCB);
	        },
	        kmActionPostCBCheckCB: function(params) {
	            if (apz.deviceType !== 'WEB') {
	                apz.app.BaseScreens.UEstopTimer("WorkflowUpdate ", params.req);
	            }
	            //  console.log(params);
	            var DisbValue = $('#NEWLOA__AddLoanDetails__disbMode').val();
	            if (ApzCOB.handleServiceCallBacks(params)) {
	                if (params.res.APZCBO__KMActionPostCBCheck_Res.apiResponse.ResponseHeader.ResponseCode == "0") {
	                    if (rpcLoanapplication) {
	                        // to-do 
	                        var d = new Date();
	                        // console.log('final',d.getHours(),d.getMinutes(),d.getSeconds(),params)
	                        ApzCOB.toggleModal(EarningDetailscrId + "successModal");
	                    } else {
	                        if (userRole === 'CRT') {
	                            if (window.approve) {
	                                apz.app.CrtDetails.onApprove()
	                            } else if (window.reject) {
	                                apz.app.CrtDetails.onReject()
	                            }
	                        } else if ((userRole === 'KM' && window.isClose) || (isSelfAssigned && window.crtRejectKM)) {
	                            ApzCOB.fnDisplayMsg('Application Rejected Successfully', "I", ApzCOB.dashboardAppListAPI);
	                        } else if (userRole === 'KM' && window.crtRejectKM === true) {
	                            apz.app.AddLoanDetails.onCRTReject();
	                        } else if (userRole === 'KM' && window.loanProduct === "Emergency Loan" && DisbValue === "CASH") {
	                            //ApzCOB.fnDisplayMsg("Ensure that the cash is handed over to the customer", "I", apz.app.AddLoanDetails.appSubmit);
	                            ApzCOB.fnDisplayMsg("EL application created successfully.please handover cash to member", "I", apz.app.AddLoanDetails.appSubmit);
	                        } else {
	                            apz.app.AddLoanDetails.appSubmit();
	                        }
	                    }
	                    // to-do 
	                } else {
	                    if (rpcLoanapplication) {
	                        // to-do 
	                        // console.log('final',d.getHours(),d.getMinutes(),d.getSeconds(),params)
	                        ApzCOB.toggleModal(EarningDetailscrId + "successModal");
	                    } else {
	                        apz.stopLoader();
	                        ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                    }
	                }
	            } else {
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E", ApzCOB.ReloadApp);
	            }
	            rpcLoanapplication = false;
	            apz.stopLoader();
	        },
	        sendSMSLink: function() {
	            setTimeout(function() {
	                apz.startLoader();
	                let addInfo = KendraLoans.custFetchLoanAppRes.applicationdtls[0].addInfo;
	                if (typeof addInfo === "string") {
	                    addInfo = JSON.parse(addInfo);
	                }
	                const newBranchId = addInfo.branchId;
	                var req = {
	                    "apiRequest": {
	                        "interfaceName": "SendSMSForSanctionReportLink",
	                        "appId": gAppId,
	                        "requestObj": {
	                            "applicationId": KendraLoans.custFetchLoanAppRes.applicationdtls[0].applicationId,
	                            "actionType": "SANCTION_REPORT_LINK_SEND",
	                            "type": '',
	                            "branchId": newBranchId,
	                            "mobileNo": KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.mobileNum,
	                            "customerName": KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerName,
	                            "workflowId": "SendSMSForSanctionReportLink"
	                        },
	                        "workflowId": "SendSMSForSanctionReportLink"
	                    }
	                };
	                ApzCOB.serverBuildParam(gAppId, 'WorkFlowService', 'N', 'N', req, 'Y', ApzCOB.sendSMSLinkCB);
	            }, 300);
	        },
	        sendSMSLinkCB: function(params) {
	            //  console.log(params);
	            apz.stopLoader();
	            if (ApzCOB.handleServiceCallBacks(params)) {
	                if (!apz.isNull(params.res.APZCBO__WorkFlowService_Res.apiResponse.ResponseHeader) || params.res
	                    .APZCBO__SendSMSForSanctionReportLink_Res.apiResponse.ResponseHeader.ResponseCode == '0') {
	                    if (resendSMSFlag) {
	                        resendSMSFlag = false;
	                        // ApzCOB.fnDisplayMsg(params.res.APZCBO__SendSMSForSanctionReportLink_Res.apiResponse.ResponseBody.msg, "I");
	                        ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_SUCCESS_SMS"), "I");
	                    } else {
	                        ApzCOB.launchMicroApp('LoanSa', 'SuccessScreen', 'APZCBO__BaseScreens__BaseDIV', window.KendraLoans.data);
	                    }
	                } else {
	                    apz.stopLoader();
	                    ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                }
	            } else {
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	            }
	            apz.stopLoader();
	        },
	        updateAppication: function(pworkflowObj) {
	            apz.startLoader();
	            var req = {
	                "apiRequest": {
	                    "appId": gAppId,
	                    "interfaceName": "UpdateApplication",
	                    "requestObj": {
	                        "workflow": pworkflowObj,
	                        "createdBy": LoggedInUserDetails.userID,
	                        "applicationId": KendraLoans.custFetchLoanAppRes.applicationdtls[0].applicationId,
	                        "applicationStatus": pworkflowObj.stage,
	                        "appId": gAppId,
	                        "versionNum": KendraLoans.custFetchLoanAppRes.applicationdtls[0].versionNo,
	                        "remarks":pworkflowObj.remarks
	                    }
	                }
	            }
	            if (pworkflowObj.action == 'REJECT') {
	                req.apiRequest.requestObj.cbApproveManual = "N"
	                if (!apz.isNull(pworkflowObj.remarks)) {
	                    req.apiRequest.requestObj.remarks = pworkflowObj.remarks + '~The Loan Rejected by ' + LoggedInUserDetails.userID + ' (' + currentUserRole +
	                        ').';
	                } else {
	                    req.apiRequest.requestObj.remarks = 'The Loan Rejected by ' + LoggedInUserDetails.userID + ' (' + currentUserRole + ').';
	                }
	            } else {
	                req.apiRequest.requestObj.remarks = pworkflowObj.remarks;
	            }
	            req.apiRequest.requestObj.userRole = currentUserRole;
	            req.apiRequest.requestObj.appVersion = appVersion;
	            req.apiRequest.requestObj.userName = LoggedInUserDetails.loginResponse.userDet.name;
	            req.apiRequest.requestObj.userId = LoggedInUserDetails.userID;
	            ApzCOB.serverBuildParam(gAppId, 'UpdateApplication', 'N', 'N', req, 'Y', ApzCOB.updateAppicationCB);
	        },
	        updateAppicationCB: function(params) {
	            // console.log(params);
	            if (ApzCOB.handleServiceCallBacks(params)) {
	                if (!apz.isNull(params.res.APZCBO__UpdateApplication_Res.apiResponse.ResponseHeader) && params.res
	                    .APZCBO__UpdateApplication_Res.apiResponse.ResponseHeader.ResponseCode == '0') {
	                     var erroMsg = params?.res?.APZCBO__UpdateApplication_Res?.apiResponse?.ResponseBody?.responseObj ?? '';
	                     if (erroMsg === "Something went wrong, Please try again!!") {
	                         apz.stopLoader();
	                         ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                         return;
	                     }
	                    if ((window.KendraLoans.scr === 'dashboardDisbursement' || window.KendraLoans.scr === 'LoanDisbursementList') && (params
	                            .req.apiRequest.requestObj.workflow) && (params.req.apiRequest.requestObj.workflow.action === 'REJECT') && (
	                            (window.userRole == 'BM'||window.userRole == 'KM') && !isSelfAssigned)) {
	                        apz.stopLoader();
	                        if(window.KendraLoans.editRejected){
	                           window.KendraLoans.editRejected=false;
	                          ApzCOB.fnDisplayMsg('Application Rejected Successfully', "I", ApzCOB.dashboardAppListAPI);  
	                        }else{
	                          apz.app.LoanDisbursementList.paintRejectFlowData();  
	                        }
	                    } else if ((window.KendraLoans.scr == 'LoanDisbursementList' && (window.userRole == 'KM' || (window.userRole == 'BM' &&
	                            isSelfAssigned))) || (window.KendraLoans.scr == 'dashboardDisbursement' && (window.userRole == 'KM' || (window
	                            .userRole == 'BM' && isSelfAssigned)))) {
	                        apz.stopLoader();
	                        apz.app.LoanDisbursementList.kmInitiatedToBM();
	                    } else if (window.KendraLoans.scr == 'dashboardDisbursement' && (window.userRole == 'BM' && !isSelfAssigned)) {
	                        apz.stopLoader();
	                        apz.app.LoanDisbursementList.finalSubmitByBM();
	                    }else if (window.KendraLoans.scr == 'dashboard' && window.userRole == 'BM' && !isSelfAssigned) {
	                         apz.stopLoader();
	                         if ((params.req.apiRequest.requestObj.workflow) && params.req.apiRequest.requestObj.workflow.action === 'NEXT') {
	                             window.KendraLoans.data.isSanction = true;
	                             ApzCOB.sendSMSLink();
	                         } else if ((params.req.apiRequest.requestObj.workflow) && params.req.apiRequest.requestObj.workflow.action === 'REJECT') {
	                             if (window.KendraLoans.editRejected) {
	                                 window.KendraLoans.editRejected = false;
	                                 ApzCOB.fnDisplayMsg('Application Rejected Successfully', "I", ApzCOB.dashboardAppListAPI);
	                             } else {
	                                 ApzCOB.launchMicroApp('LoanSa', 'FailureScreen', 'APZCBO__BaseScreens__BaseDIV', window.KendraLoans.data);
	                             }
	                         } else {
	                             window.KendraLoans.data.isSanction = false;
	                             ApzCOB.launchMicroApp('LoanSa', 'SuccessScreen', 'APZCBO__BaseScreens__BaseDIV', window.KendraLoans.data);
	                         }
	                     } else if (window.KendraLoans.scr == 'dashboard' && (window.userRole == 'AM' || window.userRole == 'RM' | window.userRole == 'ZM' || window.userRole ==
	                             'DM' || window.userRole == 'SH')) {
	                         apz.stopLoader();
	                         if ((params.req.apiRequest.requestObj.workflow) && params.req.apiRequest.requestObj.workflow.action === 'NEXT') {
	                             window.KendraLoans.data.isSanction = true;
	                             ApzCOB.sendSMSLink();
	                         } else if ((params.req.apiRequest.requestObj.workflow) && params.req.apiRequest.requestObj.workflow.action === 'REJECT') {
	                             if (window.KendraLoans.editRejected) {
	                                 window.KendraLoans.editRejected = false;
	                                 ApzCOB.fnDisplayMsg('Application Rejected Successfully', "I", ApzCOB.dashboardAppListAPI);
	                             } else {
	                                 ApzCOB.launchMicroApp('LoanSa', 'FailureScreen', 'APZCBO__BaseScreens__BaseDIV', window.KendraLoans.data);
	                             }
	                         } else {
	                             window.KendraLoans.data.isSanction = false;
	                             ApzCOB.launchMicroApp('LoanSa', 'SuccessScreen', 'APZCBO__BaseScreens__BaseDIV', window.KendraLoans.data);
	                         }
	                         //ApzCOB.launchMicroApp('LoanSa', 'SuccessScreen', 'APZCBO__BaseScreens__BaseDIV', window.KendraLoans.data);
	                     } else if (window.KendraLoans.scr == 'LoanSanction' && ((window.userRole == 'BM' && !isSelfAssigned) || window
	                            .userRole == 'AM' || window.userRole == 'RM' | window
	                            .userRole == 'ZM' || window.userRole == 'DM' || window.userRole == 'SH')) {
	                        apz.stopLoader();
	                        if ((params.req.apiRequest.requestObj.workflow) && params.req.apiRequest.requestObj.workflow.action === 'REJECT') {
	                            if (window.KendraLoans.editRejected) {
	                                window.KendraLoans.editRejected = false;
	                                ApzCOB.fnDisplayMsg('Application Rejected Successfully', "I", ApzCOB.dashboardAppListAPI);
	                            } else {
	                                ApzCOB.launchMicroApp('LoanSa', 'FailureScreen', 'APZCBO__BaseScreens__BaseDIV', window.KendraLoans.data);
	                            }
	                        } else if ((params.req.apiRequest.requestObj.workflow) && params.req.apiRequest.requestObj.workflow.action === 'NEXT') {
	                            window.KendraLoans.data.isSanction = true;
	                            ApzCOB.sendSMSLink();
	                        } else {
	                            window.KendraLoans.data.isSanction = false;
	                            ApzCOB.launchMicroApp('LoanSa', 'SuccessScreen', 'APZCBO__BaseScreens__BaseDIV', window.KendraLoans.data);
	                        }
	                    }
	                    else if ((window.KendraLoans.scr == 'AllLoanApplication') && (window.userRole == 'KM' && !isSelfAssigned)) {
	                        apz.stopLoader();
	                        if ((params.req.apiRequest.requestObj.workflow) && params.req.apiRequest.requestObj.workflow.action === 'REJECT') {
	                                ApzCOB.fnDisplayMsg('Application Rejected Successfully', "I", apz.app.AllLoanApplication.backNavigateLoan);
	                            }
	                        else {
	                              apz.stopLoader();
	                               ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                        }
	                    }
	                } else {
	                    apz.stopLoader();
	                    ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                }
	            } else {
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	            }
	            apz.stopLoader();
	        },
	        fetchLoanApplication: function(selectedCust, scr) {
	            window.KendraLoans.scr = scr;
	            window.KendraLoans.selectedCust=selectedCust;
	            apz.startLoader();
	            var req = {
	                "apiRequest": {
	                    "appId": gAppId,
	                    "interfaceName": "FetchLoanApplication",
	                    "userId": LoggedInUserDetails.userID,
	                    "requestObj": {
	                        "applicationId": selectedCust.applicationId,
	                        "versionNum": selectedCust.versionNo ?? selectedCust.latestVersionNo
	                    }
	                }
	            }
	            ApzCOB.serverBuildParam(gAppId, 'FetchLoanApplication', 'N', 'N', req, 'Y', ApzCOB.fetchLoanApplicationCB);
	        },
	        fetchLoanApplicationCB: function(params) {
	            try {
	                //  console.log(params);
	                if (ApzCOB.handleServiceCallBacks(params)) {
	                    if (!apz.isNull(params.res.APZCBO__FetchLoanApplication_Res.apiResponse.ResponseBody.responseObj)) {
	                        window.KendraLoans.custFetchLoanAppRes = params.res.APZCBO__FetchLoanApplication_Res.apiResponse.ResponseBody
	                        .responseObj;
	                        window.KendraLoans.custFetchLoanAppRes = JSON.parse(window.KendraLoans.custFetchLoanAppRes);
	                        if(window.KendraLoans.scr === 'AllLoanApplication'|| window.KendraLoans.scr === 'NewLoanApplication'){
	                            let payload = window.KendraLoans?.custFetchLoanAppRes?.cbResponse?.resPayload;
	                            window.KendraLoans.cbResponse = payload ? JSON.parse(payload) : {};
	                        }else{
	                            window.KendraLoans.cbResponse = JSON.parse(KendraLoans.custFetchLoanAppRes.cbResponse.resPayload);
	                        }
	                        window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].createTs = ApzCOB.localDateFormat(window.KendraLoans
	                            .custFetchLoanAppRes.applicationdtls[0].createTs);
	                        if (window.KendraLoans.scr == 'dashboard' || window.KendraLoans.scr == 'LoanSanction') {
	                            /*let data = {
	                                selectedCust: window.KendraLoans.selectedLoanSanctionAccnt,
	                                matchingCustomer: window.KendraLoans.custFetchLoanAppRes 
	                            };
	                            ApzCOB.launchMicroApp('LoanSa', 'DetailedScreen', 'APZCBO__BaseScreens__BaseDIV', data);*/
	                            ApzCOB.FetchCustomerDetails(window.selectedCustomerDetail.customerId);
	                        } else if (window.KendraLoans.scr == 'dashboardDisbursement' || window.KendraLoans.scr == 'LoanDisbursementList') {
	                            /*disbData = {
	                                selectedCust: KendraApp.selectedDisbursement,
	                                matchingCustomer: window.KendraLoans.custFetchLoanAppRes.applicationdtls[0] //matchingCustomers
	                            };
	                            ApzCOB.customerNetoffDtls(KendraLoans.custFetchLoanAppRes.applicationdtls[0].branchId, KendraLoans
	                                .custFetchLoanAppRes.applicationdtls[0].customerId);*/
	                            ApzCOB.FetchCustomerDetails(KendraApp.selectedDisbursement.customerId);
	                            //ApzCOB.launchMicroApp("LoanDi", "LoanDisbursementList", "APZCBO__BaseScreens__BaseDIV", disbData);
	                            //window.KendraLoans.custFetchLoanAppRes = window.KendraLoans.custFetchLoanAppRes.applicationdtls[0]
	                            //apz.app.LoanDisbursementList.paintCustDetails(data)
	                        } else if (window.KendraLoans.scr == 'CRTdtls') {
	                            /*let data = {
	                                selectedCust: window.KendraLoans.custFetchLoanAppRes,
	                                matchingCustomer: window.KendraLoans.custFetchLoanAppRes.applicationdtls[0] //matchingCustomers
	                            };
	                            apz.app.CrtDetails.paintCustDtls(data);*/
	                            ApzCOB.FetchCustomerDetails(selectedCrt.customerId);
	                        } else if (window.KendraLoans.scr == 'AllLoanApplication') {
	                            let data = {
	                                selectedCust: window.KendraLoans.custFetchLoanAppRes,
	                                matchingCustomer: window.KendraLoans.custFetchLoanAppRes.applicationdtls[0] //matchingCustomers
	                            };
	                            apz.app.AllLoanApplication.launchLoanApplicationPending(data);
	                            //ApzCOB.launchMicroApp('Audit', 'LoanApplicationPending', 'APZCBO__BaseScreens__BaseDIV', data);
	                        } else if (window.KendraLoans.scr == 'NewLoanApplication') {
	                            let data = {
	                                selectedCust: window.KendraLoans.custFetchLoanAppRes,
	                                matchingCustomer: window.KendraLoans.custFetchLoanAppRes.applicationdtls[0] //matchingCustomers
	                            };
	                            window.isDraftFromNewLoan = true;
	                            window.isDraft = true;
	                            if (!apz.isNull(JSON.parse(data.matchingCustomer.addInfo).incomeAppId)) {
	                                window.isgetIncome = true;
	                                window.isgetIncomeData = data;
	                                KendraApp.currentLoanAppRequest.applicationdtls = data.matchingCustomer
	                                ApzCOB.fetchCustomerIdDetails(data.matchingCustomer.customerId)
	                            } else {
	                                apz.app.NewLoanApplication.selectLoanContinueFn(data);
	                            }
	                            //apz.app.NewLoanApplication.selectLoanContinueFn(data);
	                        } else {
	                            apz.stopLoader();
	                        }
	                    } else {
	                        apz.stopLoader();
	                        ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                    }
	                } else {
	                    apz.stopLoader();
	                    ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                }
					if(window.isgetIncome){
						apz.startLoader();
					}else{
						apz.stopLoader();
					}
	            } catch (e) {
	                //ApzCOB.UpdateCRTWorkflow(window.KendraLoans.selectedCust.applicationId);
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	            }
	            // console.log('params', params);
	        },
	        loanCreationT24Service: function(reqObj) {
	            apz.startLoader();
	            var req = {
	                "apiRequest": {
	                    "appId": gAppId,
	                    "interfaceName": "PreClosureLoan",
	                    "requestObj": reqObj
	                }
	            }
	            if (apz.deviceType !== 'WEB') {
	                apz.app.BaseScreens.UEstartTimer("Pre Closure Loan", req);
	                apz.app.BaseScreens.UElogevent("Pre Closure Loan", req);
	            }
	            req.apiRequest.requestObj.userRole = currentUserRole;
	            req.apiRequest.requestObj.appVersion = appVersion;
	            req.apiRequest.requestObj.userName = LoggedInUserDetails.loginResponse.userDet.name;
	            req.apiRequest.requestObj.userId = LoggedInUserDetails.userID;
	            ApzCOB.serverBuildParam(gAppId, 'PreClosureLoan', 'N', 'N', req, 'Y', ApzCOB.loanCreationT24ServiceCB);
	        },
	        loanCreationT24ServiceCB: function(params) {
	            if (apz.deviceType !== 'WEB') {
	                apz.app.BaseScreens.UEstopTimer("Pre Closure Loan", params.req);
	            }
	            //  console.log("PreClosureLoan", params);
	            if (ApzCOB.handleServiceCallBacks(params)) {
	                if (!apz.isNull(params.res.APZCBO__PreClosureLoan_Res.apiResponse.ResponseBody.responseObj)) {
	                    var headerRes = JSON.parse(params.res.APZCBO__PreClosureLoan_Res.apiResponse.ResponseBody.responseObj);
	                    if (!apz.isNull(headerRes.header.status) && headerRes.header.status == 'success') {
	                        var workflow = {
	                            "currentRole": "BM",
	                            "action": "NEXT",
	                            "workflowId": "DISBURSE",
	                            "stage": "DISBURSEMENT",
	                            "remarks": ""
	                        }
	                        ApzCOB.updateAppication(workflow);
	                    } else if (!apz.isNull(headerRes.error.errorDetails)) {
	                        ApzCOB.fnDisplayMsg(headerRes.error.errorDetails[0].code + " error : " + headerRes.error.errorDetails[0].fieldName +
	                            " is " + headerRes.error.errorDetails[0].message, "E");
	                    } else {
	                        ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                    }
	                } else {
	                    apz.stopLoader();
	                    ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                }
	            } else {
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	            }
	            //apz.app.AddLoanDetails.paintconfirmDetails();
	            apz.stopLoader();
	        },
	        createLoan: function() {
	            apz.startLoader();
	            var data = [];
	            KendraApp.currentLoanAppRequest.applicationdtls.customerName = KendraApp.currentLoanAppRequest.applicationdtls.customerDtls
	                .customerName;
	            KendraApp.currentLoanAppRequest.applicationdtls.amount = KendraApp.currentLoanAppRequest.applicationdtls.customerDtls.loanDtls
	                .caglAmt;
	            KendraApp.currentLoanAppRequest.applicationdtls.currentScreenId = window.currentApp.currentstage;
	            KendraApp.currentLoanAppRequest.applicationdtls.status = window.currentApp.status;
	            //KendraApp.currentLoanAppRequest.applicationdtls.versionNum='';
	            data.push(KendraApp.currentLoanAppRequest.applicationdtls)
	            var req = {
	                "apiRequest": {
	                    "appId": gAppId,
	                    "interfaceName": "CreateLoanApplication",
	                    "requestObj": {
	                        "applicationdtls": data
	                    }
	                }
	            }
	            ApzCOB.serverBuildParam(gAppId, 'CreateLoanApplication', 'N', 'N', req, 'Y', ApzCOB.createLoanCB);
	        },
	        createLoanCB: function(params) {
	            KendraApp.params = {};
	            KendraApp.params = params;
	            //    console.log("createLoanCB", params);
	            if (ApzCOB.handleServiceCallBacks(params)) {
	                if (!apz.isNull(params.res.APZCBO__CreateLoanApplication_Res.apiResponse.ResponseBody.responseObj)) {
	                    KendraApp.AppCreateResObj = JSON.parse(KendraApp.params.res.APZCBO__CreateLoanApplication_Res.apiResponse.ResponseBody
	                        .responseObj);
	                    IncomeApp.appRefId = KendraApp.AppCreateResObj.applicationId;
	                    //apz.app.AddLoanDetails.paintconfirmDetails();
	                } else {
	                    apz.stopLoader();
	                    ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                }
	            } else {
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	            }
	            apz.app.AddLoanDetails.paintconfirmDetails();
	            apz.stopLoader();
	        },
	        dateMMDDYYYYformat: function() {
	            const today = new Date();
	            const yyyy = today.getFullYear();
	            let mm = today.getMonth() + 1; // Months start at 0!
	            let dd = today.getDate();
	            if (dd < 10) dd = '0' + dd;
	            if (mm < 10) mm = '0' + mm;
	            const formattedToday = mm + '/' + dd + '/' + yyyy;
	            return formattedToday;
	        },
	        dateYYYYMMDDformat: function() {
	            const today = new Date();
	            const yyyy = today.getFullYear();
	            let mm = today.getMonth() + 1; // Months start at 0!
	            let dd = today.getDate();
	            if (dd < 10) dd = '0' + dd;
	            if (mm < 10) mm = '0' + mm;
	            const formattedToday = yyyy + '-' + mm + '-' + dd;
	            return formattedToday;
	        },
	        findOverdueCustomers: function(tempArrayList) {
	            var count = 0;
	            var loanFlag = false;
	            var loanDtlsArray = [];
	            if (tempArrayList.length > 0) {
	                tempArrayList.forEach(function(m, n) {
	                    if (m.hasOwnProperty("loanDtls") && m.loanDtls.length > 0) {
	                        loanFlag = false;
	                        loanDtlsArray = m.loanDtls;
	                        loanDtlsArray.forEach(function(j, k) {
	                            let overduePrincipal = j.overduePrincipal;
	                            let overdueInterest = j.overdueInterest;
	                            if (apz.isNull(overduePrincipal)) {
	                                overduePrincipal = 0;
	                            } else if (typeof overduePrincipal === 'string') {
	                                overduePrincipal = JSON.parse(overduePrincipal);
	                            }
	                            if (apz.isNull(overdueInterest)) {
	                                overdueInterest = 0;
	                            } else if (typeof overdueInterest === 'string') {
	                                overdueInterest = JSON.parse(overdueInterest);
	                            }
	                            if (overduePrincipal > 0 || overdueInterest > 0) {
	                                loanFlag = true;
	                            }
	                        });
	                        if (loanFlag) {
	                            count++;
	                        }
	                    } else {
	                        if (m.loanDtls.length > 0) {
	                            loanFlag = false;
	                            loanDtlsArray = m.loanDtls;
	                            loanDtlsArray.forEach(function(j, k) {
	                                if (j.overDueStatus === "Y") {
	                                    loanFlag = true;
	                                }
	                            });
	                            if (loanFlag) {
	                                count++;
	                            }
	                        }
	                    }
	                });
	            } else {
	                if (tempArrayList.hasOwnProperty("loanDtls") && tempArrayList.loanDtls.length > 0) {
	                    loanFlag = false;
	                    loanDtlsArray = tempArrayList.loanDtls;
	                    loanDtlsArray.forEach(function(j, k) {
	                        let overduePrincipal = j.overduePrincipal;
	                        let overdueInterest = j.overdueInterest;
	                        if (apz.isNull(overduePrincipal)) {
	                            overduePrincipal = 0;
	                        } else if (typeof overduePrincipal === 'string') {
	                            overduePrincipal = JSON.parse(overduePrincipal);
	                        }
	                        if (apz.isNull(overdueInterest)) {
	                            overdueInterest = 0;
	                        } else if (typeof overdueInterest === 'string') {
	                            overdueInterest = JSON.parse(overdueInterest);
	                        }
	                        if (overduePrincipal > 0 || overdueInterest > 0) {
	                            loanFlag = true;
	                        }
	                    });
	                    if (loanFlag) {
	                        count++;
	                    }
	                }
	            }
	            return count;
	        },
	        customeValidateFields: function(pMandatoryFields) {
	            var valid = true;
	            if (window.loanProduct === "Emergency Loan") {
	                pMandatoryFields = pMandatoryFields.filter(field => field !== "NEWLOA__AddLoanDetails__nomineeName" && field !=
	                    "NEWLOA__AddLoanDetails__nomineeReationDpd")
	            }
	            $.map(pMandatoryFields, function(field) {
	                if (apz.getElmValue(field).trim() === "" || apz.getElmValue(field).trim() === "-1") {
	                    valid = false;
	                    $(`#${field}ErrorDiv`).removeClass('sno');
	                    $(`#${field}`).addClass('err');
	                    $('#' + field).addClass('err-line');
	                    $(`#${field}`).parent().addClass('err');
	                    $('#' + field).parent().addClass('err-line');
	                } else if (field === 'NEWLOA__AddLoanDetails__purpAndSubpurp') {
	                    let purpAndSubpurpValue = apz.getElmValue(field).trim().split(':');
	                    let purpose = purpAndSubpurpValue[0].trim();
	                    let subPurpose = purpAndSubpurpValue[1].trim();
	                    if (purpose === "" || subPurpose === "") {
	                        valid = false;
	                        $(`#${field}ErrorDiv`).removeClass('sno');
	                        $(`#${field}`).addClass('err');
	                        $('#' + field).addClass('err-line');
	                        $(`#${field}`).parent().addClass('err');
	                        $('#' + field).parent().addClass('err-line');
	                    }
	                } else {
	                    $(`#${field}ErrorDiv`).addClass('sno');
	                    $(`#${field}`).removeClass('err');
	                    $(`#${field}`).removeClass('err-line');
	                    $(`#${field}`).parent().removeClass('err');
	                    $('#' + field).parent().removeClass('err-line');
	                }
	            })
	            return valid;
	        },
	        LaunchAuthentication: function(InitiationdivId, ModalId, AuthBaseDivId, cancelCB, successCB, AuthenticationRes, Module, failureCB) {
	            gApzCOB.Authenticationtype = 'OTP'
	            if (!apz.isNull(gApzCOB.Authenticationtype)) {
	                if (ModalId !== "" && $("#" + ModalId).is(":visible")) {
	                    ApzCOB.toggleModal(ModalId);
	                }
	                if (InitiationdivId !== "") {
	                    $("#" + InitiationdivId).removeClass("sno");
	                }
	                $("#" + AuthBaseDivId).removeClass("sno");
	                AuthenticationRes.cancelCB = cancelCB;
	                AuthenticationRes.successCB = successCB;
	                AuthenticationRes.failureCB = failureCB;
	                AuthenticationRes.fromScreenId = apz.childScr;
	                AuthenticationRes.Module = Module;
	                if (gApzCOB.Authenticationtype === "OTP") {
	                    ApzCOB.launchMicroAppWithoutAnimation("Authen", "OTPAuthentication", AuthBaseDivId, AuthenticationRes);
	                } else if (gApzCOB.Authenticationtype === "Password") {
	                    ApzCOB.launchMicroAppWithoutAnimation("Authen", "PasswordAuthentication", AuthBaseDivId, AuthenticationRes);
	                } else if (gApzCOB.Authenticationtype === "Pin") {
	                    ApzCOB.launchMicroAppWithoutAnimation("Authen", "PinAuthentication", AuthBaseDivId, AuthenticationRes);
	                } else if (gApzCOB.Authenticationtype === "SecQuestion") {
	                    ApzCOB.launchMicroAppWithoutAnimation("Authen", "SecQuestAuthentication", AuthBaseDivId, AuthenticationRes);
	                } else if (gApzCOB.Authenticationtype === "Captcha") {
	                    ApzCOB.launchMicroAppWithoutAnimation("Authen", "CaptchaAuthentication", AuthBaseDivId, AuthenticationRes);
	                } else if (gApzCOB.Authenticationtype === "OTPTPIN") {
	                    ApzCOB.launchMicroAppWithoutAnimation("Authen", "DualAuth", AuthBaseDivId, AuthenticationRes);
	                } else if (gApzCOB.Authenticationtype === "TOTP") {
	                    ApzCOB.launchMicroAppWithoutAnimation("Authen", "TimerAuthenticator", AuthBaseDivId, AuthenticationRes);
	                }
	            } else {
	                $("#" + InitiationdivId).addClass("sno");
	                if (ModalId !== "") {
	                    ApzCOB.toggleModal(ModalId);
	                }
	                // if (apz.deviceType === "WEB") {
	                $("#" + AuthBaseDivId).removeClass("sno");
	                // }
	                ApzCOB.executeFunByName(successCB);
	                apz.startLoader();
	            }
	        },
	        saveLoan: function() {
	            if (!rpcLoanapplication || !selectedPreclosureApplyLoan || !window.iseditCBsuccess) {
	                apz.startLoader();
	            }
	            var data = [];
	            if (selectedPreclosureApplyLoan ||customselectedPreclosureApplyLoan) {
	                data.push(KendraApp.currentLoanAppRequest.applicationdtls)
	            } else if (selectedPreclosureKMInit) {
	                data.push(KendraLoans.custFetchLoanAppRes.applicationdtls[0])
	            } else if (selectedPreclosureBMSanc) {
	                data.push(KendraLoans.custFetchLoanAppRes.applicationdtls[0])
	            } else if (selectedPreclosureBMFinal) {
	                data.push(KendraLoans.custFetchLoanAppRes.applicationdtls[0])
	            } else if (selectSameLoanBeforeBMSanc || isbulkUploadDocu) {
	                data.push(KendraLoans.custFetchLoanAppRes.applicationdtls[0])
	            } else if (selectedCrtUpdate) {
	                data.push(KendraApp.crtLoanSaveReq.applicationdtls)
	            } else if (selectAllActiveLoans) {
	                data.push(KendraLoans.custFetchLoanAppRes.applicationdtls[0])
	            } else if (window.KendraApp.amountUpdate) {
	                data.push(KendraLoans.custFetchLoanAppRes.applicationdtls[0])
	            }else if (window.mobileNoUpdateAtDisbursement) {
	                data.push(KendraLoans.custFetchLoanAppRes.applicationdtls[0])
	            } else {
	                KendraApp.currentLoanAppRequest.applicationdtls.addInfo.isQuestionComplete='';
	                data.push(KendraApp.currentLoanAppRequest.applicationdtls)
	            }
	            /*if (typeof data[0].addInfo == "string") {
	                data[0].addInfo = JSON.parse(data[0].addInfo);
	            }*/
	            var req = {
	                "apiRequest": {
	                    "appId": gAppId,
	                    "interfaceName": "CreateLoanApplication",
	                    "requestObj": {
	                        "applicationdtls": data
	                    }
	                }
	            }
	            if (apz.deviceType !== 'WEB') {
	                apz.app.BaseScreens.UEstartTimer("UpdateApplication", req);
	                apz.app.BaseScreens.UElogevent("UpdateApplication", req);
	            }
	            req.apiRequest.requestObj.userRole = currentUserRole;
	            req.apiRequest.requestObj.appVersion = appVersion;
	            req.apiRequest.requestObj.userName = LoggedInUserDetails.loginResponse.userDet.name;
	            req.apiRequest.requestObj.userId = LoggedInUserDetails.userID;
	            req.apiRequest.requestObj.remarks = window.KendraApp.remarks;
	            // if(isConfirmCbCheck){/*for now adding this conditon due to CB check is not working 25 june 2025*/
	            //     isConfirmCbCheck = false;
	            // }
	             if (!isConfirmCbCheck) {
	                 isConfirmCbCheck = true;
	                 ApzCOB.serverBuildParam(gAppId, 'CreateLoanApplication', 'N', 'N', req, 'Y', ApzCOB.saveLoanCB);
	                 console.log('Triggered without otp');
	             } else {
	                 apz.stopLoader()
	             }
	        },
	        saveLoanCB: function(params) {
	            window.KendraApp.remarks='NA';
	            if (apz.deviceType !== 'WEB') {
	                apz.app.BaseScreens.UEstopTimer("UpdateApplication ", params.req);
	            }
	            var editFlowFlag = false;
	            isBankDetailsUpdated=false;
	            KendraApp.params = {};
	            KendraApp.params = params;
	            console.log("save LoanCB", params);
	            if (ApzCOB.handleServiceCallBacks(params)) {
	                if (!apz.isNull(params.res.APZCBO__CreateLoanApplication_Res.apiResponse.ResponseBody.responseObj)) {
	                    KendraApp.AppCreateResObj = JSON.parse(KendraApp.params.res.APZCBO__CreateLoanApplication_Res.apiResponse.ResponseBody
	                        .responseObj);
	                     if (KendraApp.AppCreateResObj.messageCode && KendraApp.AppCreateResObj.messageCode === 409) {
	                         apz.stopLoader();
	                         ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                         return;
	                     }
	                     if (!apz.isObjectEmpty(KendraApp.currentLoanAppRequest)) {
	                         KendraApp.currentLoanAppRequest.applicationdtls.applicationId = KendraApp.AppCreateResObj.applicationId;
	                         KendraApp.currentLoanAppRequest.applicationdtls.versionNo = KendraApp.AppCreateResObj.versionNo;
	                     } if(window.isCBpassCases){
	                       // apz.app.AllLoanApplication.proceedWithLoanApp();
	                        //ApzCOB.fnDisplayMsg("Application submitted successfully", "S", apz.app.AllLoanApplication.launchDashb);
	                    }else if (selectedPreclosureApplyLoan) {
	                        selectedPreclosureApplyLoan = false;
	                         apz.app.AddLoanDetails.kmAutoSubmit();
	                        //ApzCOB.kmActionPostCBCheck();
	                    }else if (window.KendraApp.isnotQualifyApp) {
	                        window.KendraApp.isnotQualifyApp = false;
	                        ApzCOB.dashboardAppListAPI();
	                    } else if (customselectedPreclosureApplyLoan) {
	                        customselectedPreclosureApplyLoan = false;
	                        apz.app.AddLoanDetails.appSubmit();
	                    } else if (selectedPreclosureKMInit) {
	                        selectedPreclosureKMInit = false;
	                        if (KendraLoans.custFetchLoanAppRes) {
	                            KendraLoans.custFetchLoanAppRes.applicationdtls[0].applicationId = KendraApp.AppCreateResObj.applicationId;
	                            KendraLoans.custFetchLoanAppRes.applicationdtls[0].versionNo = KendraApp.AppCreateResObj.versionNo;
	                        }
	                        apz.app.LoanDisbursementList.paintReviewDetails();
	                    } else if (selectedPreclosureBMSanc) {
	                        if (KendraLoans.custFetchLoanAppRes) {
	                            KendraLoans.custFetchLoanAppRes.applicationdtls[0].applicationId = KendraApp.AppCreateResObj.applicationId;
	                            KendraLoans.custFetchLoanAppRes.applicationdtls[0].versionNo = KendraApp.AppCreateResObj.versionNo;
	                        }
	                        selectedPreclosureBMSanc = false;
	                        apz.app.DetailedScreen.sanctionByBM();
	                    } else if (selectSameLoanBeforeBMSanc || isbulkUploadDocu) {
	                        if (KendraLoans.custFetchLoanAppRes) {
	                            KendraLoans.custFetchLoanAppRes.applicationdtls[0].applicationId = KendraApp.AppCreateResObj.applicationId;
	                            KendraLoans.custFetchLoanAppRes.applicationdtls[0].versionNo = KendraApp.AppCreateResObj.versionNo;
	                        }
	                        selectSameLoanBeforeBMSanc = false;
	                       // isbulkUploadDocu = false;
	                    } else if (selectedPreclosureBMFinal) {
	                        selectedPreclosureBMFinal = false;
	                        if (KendraLoans.custFetchLoanAppRes) {
	                            KendraLoans.custFetchLoanAppRes.applicationdtls[0].applicationId = KendraApp.AppCreateResObj.applicationId;
	                            KendraLoans.custFetchLoanAppRes.applicationdtls[0].versionNo = KendraApp.AppCreateResObj.versionNo;
	                        }
	                        //apz.app.LoanDisbursementList.preClosureLoan();
	                        apz.app.LoanDisbursementList.moveToBm()
	                    } else if (selectAllActiveLoans) {
	                        selectAllActiveLoans = false;
	                        if (KendraLoans.custFetchLoanAppRes) {
	                            KendraLoans.custFetchLoanAppRes.applicationdtls[0].applicationId = KendraApp.AppCreateResObj.applicationId;
	                            KendraLoans.custFetchLoanAppRes.applicationdtls[0].versionNo = KendraApp.AppCreateResObj.versionNo;
	                        }
	                        let data = {
	                            selectedCust: window.KendraLoans.custFetchLoanAppRes,
	                            matchingCustomer: window.KendraLoans.custFetchLoanAppRes.applicationdtls[0] //matchingCustomers
	                        };
	                        ApzCOB.launchMicroApp("LoanDi", "LoanDisbursementList", "APZCBO__BaseScreens__BaseDIV", data);
	                    } else if (window.KendraApp.amountUpdate) {
	                         window.KendraApp.amountUpdate = false;
	                         if (KendraLoans.custFetchLoanAppRes) {
	                             KendraLoans.custFetchLoanAppRes.applicationdtls[0].applicationId = KendraApp.AppCreateResObj.applicationId;
	                             KendraLoans.custFetchLoanAppRes.applicationdtls[0].versionNo = KendraApp.AppCreateResObj.versionNo;
	                         }
	                         custData = window.KendraLoans.custFetchLoanAppRes.applicationdtls[0]; //matchingCustomers
	                         if (window.KendraApp.disbursementFlow = 'OTP') {
	                             apz.app.LoanDisbursementList.generateOtp();
	                         } else {
	                             apz.app.LoanDisbursementList.loanCreationT24Service();
	                         }
	                     } else if (window.mobileNoUpdateAtDisbursement) {
	                        window.mobileNoUpdateAtDisbursement = false
	                     } else if (selectedCrtUpdate) {
	                        selectedCrtUpdate = false;
	                        let data = {
	                            selectedCust: window.KendraLoans.custFetchLoanAppRes,
	                            matchingCustomer: window.KendraLoans.custFetchLoanAppRes.applicationdtls[0] //matchingCustomers
	                        };
	                        apz.app.CrtDetails.paintCustDtls(data)
	                    } else if (rpcLoanapplication) {
	                        //console.log('ApprovedsaveAppCB', params)
	                        var d = new Date();
	                        //  console.log('ApprovedsaveAppCB',d.getHours(),d.getMinutes(),d.getSeconds(),params);
	                        apz.app.EarningMemberDetails.cbCheck();
	                    } else if (!window.isloanOTP) {
	                        if (IncomeApp.status === 'PENDINGBYRPC') {
	                            apz.app.AddLoanDetails.appSubmit();
	                        } else {
	                            apz.app.AddLoanDetails.creditCheck();
	                        }
	                    } else {
	                        /*let data = {};
	                        var screenId = "",
	                            microappId = "";
	                        if (window.KendraLoans.scr === "LoanSanction" || window.KendraLoans.scr === "dashboard") {
	                            screenId = "DetailedScreen";
	                            microappId = "LoanSa";
	                            data = {
	                                selectedCust: window.KendraLoans.selectedLoanSanctionAccnt,
	                                matchingCustomer: window.KendraLoans.custFetchLoanAppRes
	                            };
	                        } else if (window.KendraLoans.scr === "dashboardDisbursement" || window.KendraLoans.scr == 'LoanDisbursementList') {
	                            screenId = "LoanDisbursementList";
	                            microappId = "LoanDi";
	                            data = {
	                                selectedCust: KendraApp.selectedDisbursement,
	                                matchingCustomer: window.KendraLoans.custFetchLoanAppRes.applicationdtls[0]
	                            };
	                        }
	                        ApzCOB.launchMicroApp(microappId, screenId, 'APZCBO__BaseScreens__BaseDIV', data);*/
	                        if (window.isApprovedCRT) {
	                            apz.stopLoader();
	                            editFlowFlag = true;
	                            ApzCOB.fnDisplayMsg('Application Saved Successfully', "I", ApzCOB.launchDisbursementscreen);
	                        } else if (window.isDraftStage1) {
	                            window.isDraftStage1 = false;
	                            apz.stopLoader();
	                        } else if (window.isDraftStage2) {
	                            window.isDraftStage2 = false;
	                            //ApzCOB.fnDisplayMsg('Application Saved Successfully', "I")
	                            apz.stopLoader();
	                        } else {
	                            var rejectReason = cbResponse?.Rejection_reason??'';
								if( rejectReason === 'Reject - Eligible for NQA, Do Re-income assessment'){
									KendraApp.currentLoanAppRequest.applicationdtls.addInfo.reIncomeAssessment = true;
								}else{
									if (!window.iseditCBsuccess) {
    	                                editFlowFlag = true;
    	                                ApzCOB.cbCheckOnEditFlow();
									} else {
										window.iseditCBsuccess = false;
										editFlowFlag = true;
									}
								}
	                        }
	                    }
	                    if (isbulkUploadDocu) {
							isbulkUploadDocu = false;
							KendraLoans.custFetchLoanAppRes.applicationdtls[0].applicationId = KendraApp.AppCreateResObj.applicationId;
							KendraLoans.custFetchLoanAppRes.applicationdtls[0].versionNo = KendraApp.AppCreateResObj.versionNo;
						} else {
							if (KendraLoans.custFetchLoanAppRes) {
								if ((!apz.isNull(KendraApp?.currentLoanAppRequest?.applicationdtls?.applicationId) && !editFlowFlag)) {
									KendraLoans.custFetchLoanAppRes = KendraApp.currentLoanAppRequest;
								} else {
									KendraLoans.custFetchLoanAppRes.applicationdtls[0].applicationId = KendraApp.AppCreateResObj.applicationId;
									KendraLoans.custFetchLoanAppRes.applicationdtls[0].versionNo = KendraApp.AppCreateResObj.versionNo;
								}
							}
						}
	                } else {
	                    apz.stopLoader();
	                    ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                }
	            } else {
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	            }
	            if (editFlowFlag || rpcLoanapplication) {
	                editFlowFlag = false;
	            } else {
	                if (window.isloanOTP) {
	                    apz.stopLoader();
	                }
	            }
		    console.log('service11');
	            isConfirmCbCheck = false;
	            isCBpassCases=false;
	        },
	        launchDisbursementscreen: function() {
	            if ($('body').hasClass('modal-open')) {
	                $('body').removeClass('modal-open')
	            }
	            if (window.KendraLoans.scr === "LoanSanction" || window.KendraLoans.scr === "dashboard") {
	                screenId = "DetailedScreen";
	                microappId = "LoanSa";
	                data = {
	                    selectedCust: window.KendraLoans.selectedLoanSanctionAccnt,
	                    matchingCustomer: window.KendraLoans.custFetchLoanAppRes,
	                };
	            } else if (window.KendraLoans.scr === "dashboardDisbursement" || window.KendraLoans.scr == 'LoanDisbursementList') {
	                screenId = "LoanDisbursementList";
	                microappId = "LoanDi";
	                data = {
	                    selectedCust: KendraApp.selectedDisbursement,
	                    matchingCustomer: window.KendraLoans.custFetchLoanAppRes.applicationdtls[0]
	                };
	            }
	            ApzCOB.launchMicroApp(microappId, screenId, 'APZCBO__BaseScreens__BaseDIV', data);
	        },
	        fetchStateCode: function(lname) {
	            var code = lname;
	            window.KendraLovs.state.forEach(function(j, k) {
	                if (j.ItemDesc.toUpperCase() === lname.toUpperCase()) {
	                    code = j.ID;
	                }
	            });
	            return code;
	        },
	        fetchStateName: function(lcode) {
	            var stateName = lcode;
	            window.KendraLovs.state.forEach(function(j, k) {
	                if (j.ID === lcode) {
	                    stateName = j.ItemDesc;
	                }
	            });
	            return stateName.toUpperCase();
	        },
	        customerPayoffDtls: function(branchId, customerId) {
	            apz.startLoader();
	            var req = {
	                "apiRequest": {
	                    "interfaceName": "CustomerPayoffDtls",
	                    "appId": gAppId,
	                    "userId": LoggedInUserDetails.userID,
	                    "requestObj": {
	                        "companyId": branchId,
	                        "customerId": customerId
	                    }
	                }
	            }
	            ApzCOB.serverBuildParam(gAppId, 'CustomerPayoffDtls', 'N', 'N', req, 'Y', ApzCOB.customerPayoffDtlsCB);
	        },
	        customerPayoffDtlsCB: function(params) {
	            apz.stopLoader();
	            KendraApp.selectedCustomer.payoffDetails = [];
	            if (ApzCOB.handleServiceCallBacks(params)) {
	                if (!apz.isNull(params.res.APZCBO__CustomerPayoffDtls_Res.apiResponse.ResponseBody.responseObj)) {
	                    var custPayoffrResp = params.res.APZCBO__CustomerPayoffDtls_Res.apiResponse.ResponseBody.responseObj;
	                    custPayoffrResp = JSON.parse(custPayoffrResp);
	                    if (custPayoffrResp.hasOwnProperty("error")) {
	                        ApzCOB.launchMicroApp("NEWLOA", "AddLoanDetails", "APZCBO__BaseScreens__STAGE1", KendraApp.selectedCustomer);
	                    } else {
	                        if (custPayoffrResp.hasOwnProperty("body") && custPayoffrResp.body.length > 0 && custPayoffrResp.body[0]
	                            .hasOwnProperty("result")) {
	                            if (custPayoffrResp.body[0].result.length > 0 && custPayoffrResp.body[0].result[0].hasOwnProperty(
	                                    "payoffDetails")) {
	                                if (custPayoffrResp.body[0].result[0].payoffDetails.length > 0) {
	                                    KendraApp.selectedCustomer.payoffDetails = custPayoffrResp.body[0].result[0].payoffDetails;
	                                    ApzCOB.launchMicroApp("NEWLOA", "AddLoanDetails", "APZCBO__BaseScreens__STAGE1", KendraApp
	                                        .selectedCustomer);
	                                }
	                            }
	                        }
	                    }
	                } else {
	                    ApzCOB.launchMicroApp("NEWLOA", "AddLoanDetails", "APZCBO__BaseScreens__STAGE1", KendraApp.selectedCustomer);
	                }
	            } else {
	                ApzCOB.launchMicroApp("NEWLOA", "AddLoanDetails", "APZCBO__BaseScreens__STAGE1", KendraApp.selectedCustomer);
	            }
	        },
	        customerNetoffDtls: function(branchId, customerId) {
	            apz.startLoader();
	            var req = {
	                "apiRequest": {
	                    "interfaceName": "CustomerPayoffDtls",
	                    "appId": gAppId,
	                    "userId": LoggedInUserDetails.userID,
	                    "requestObj": {
	                        "companyId": branchId,
	                        "customerId": customerId
	                    }
	                }
	            }
	            if (apz.deviceType !== 'WEB') {
	                apz.app.BaseScreens.UEstartTimer("Customer Payoff Details", req);
	                apz.app.BaseScreens.UElogevent("Customer Payoff Details", req);
	            }
	            ApzCOB.serverBuildParam(gAppId, 'CustomerPayoffDtls', 'N', 'N', req, 'Y', ApzCOB.customerNetoffDtlsCB);
	        },
	        customerNetoffDtlsCB: function(params) {
	            if (apz.deviceType !== 'WEB') {
	                apz.app.BaseScreens.UEstopTimer("Customer Payoff Details ", params.req);
	            }
	            apz.stopLoader();
	            KendraLoans.custNetoffDetails = [];
	            if (ApzCOB.handleServiceCallBacks(params)) {
	                if (!apz.isNull(params.res.APZCBO__CustomerPayoffDtls_Res.apiResponse.ResponseBody.responseObj)) {
	                    var custPayoffrResp = params.res.APZCBO__CustomerPayoffDtls_Res.apiResponse.ResponseBody.responseObj;
	                    custPayoffrResp = JSON.parse(custPayoffrResp);
	                    if (custPayoffrResp.hasOwnProperty("error")) {
	                        ApzCOB.fnDisplayMsg('The Payoff Service is down!', "E");
	                        //ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                    } else {
	                        if (custPayoffrResp.hasOwnProperty("body") && custPayoffrResp.body.length > 0 && custPayoffrResp.body[0]
	                            .hasOwnProperty("result")) {
	                            if (custPayoffrResp.body[0].result.length > 0 && custPayoffrResp.body[0].result[0].hasOwnProperty(
	                                    "payoffDetails")) {
	                                if (custPayoffrResp.body[0].result[0].payoffDetails.length > 0) {
	                                    KendraLoans.custNetoffDetails = custPayoffrResp.body[0].result[0].payoffDetails;
	                                    ApzCOB.launchMicroApp("LoanDi", "LoanDisbursementList", "APZCBO__BaseScreens__BaseDIV", disbData);
	                                }
	                            }
	                        } else if (custPayoffrResp.hasOwnProperty("body") && custPayoffrResp.body.length > 0 && !custPayoffrResp.body[0]
	                            .hasOwnProperty("result")) {
	                            ApzCOB.launchMicroApp("LoanDi", "LoanDisbursementList", "APZCBO__BaseScreens__BaseDIV", disbData);
	                        } else {
	                            ApzCOB.fnDisplayMsg('The Payoff Service is down!', "E");
	                            // ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                        }
	                    }
	                } else {
	                    ApzCOB.fnDisplayMsg('The Payoff Service is down!', "E");
	                    //ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                }
	            } else {
	                ApzCOB.fnDisplayMsg('The Payoff Service is down!', "E");
	                // ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	            }
	        },
	        cbCheckOnEditFlow: function() {
	            var req = {
	                "apiRequest": {
	                    "appId": gAppId,
	                    "interfaceName": "loanCBCheck",
	                    "userId": LoggedInUserDetails.userID,
	                    "requestObj": {
	                        "applicationId": KendraLoans.custFetchLoanAppRes.applicationdtls[0].applicationId,
	                        "versionNo": KendraLoans.custFetchLoanAppRes.applicationdtls[0].versionNo,
	                        "crtFlag":false,
	                        "schedulerEnabled": "N",
	                        "custDtlId": KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerId
	                    }
	                }
	            }
	            req.apiRequest.requestObj.cbRecheck='Y';
	            req.apiRequest.requestObj.userRole = currentUserRole;
	            req.apiRequest.requestObj.appVersion = appVersion;
	            req.apiRequest.requestObj.userName = LoggedInUserDetails.loginResponse.userDet.name;
	            req.apiRequest.requestObj.userId = LoggedInUserDetails.userID;
	            req.apiRequest.requestObj.remarks = 'The Loan CB recheck by '+LoggedInUserDetails.userID +' ('+currentUserRole +').';
	            ApzCOB.serverBuildParam(gAppId, 'loanCBCheck', 'N', 'N', req, 'Y', ApzCOB.cbCheckOnEditFlowCB);
	        },
	        cbCheckOnEditFlowCB: function(params) {
	            apz.stopLoader();
	            if (ApzCOB.handleServiceCallBacks(params)) {
	                if (!apz.isNull(params.res.APZCBO__loanCBCheck_Res.apiResponse.ResponseBody.responseObj)) {
	                    cbResponse = JSON.parse(params.res.APZCBO__loanCBCheck_Res.apiResponse.ResponseBody.responseObj);
	                    var approvedAmt = 0;
	                    let loanAmount = $('#' + editLoanAndInsScrId + "editLoanAmt").val();
	                    loanAmount = parseInt(loanAmount.replaceAll(",", ""));
	                    if (!apz.isNull(cbResponse.Approved_Loan_Amount)) {
	                        approvedAmt = cbResponse.Approved_Loan_Amount;
	                    }
	                    if (cbResponse.IRIS_message == 'success' || cbResponse.IRIS_message == 'SUCCESS' || cbResponse.IRIS_message == 'bureau_data_issue_spouse_node_corrected_success') {
	                        //to-do
	                        if (cbResponse.Final_Decision === 'Approved' || cbResponse.Final_Decision === 'Approved with Pre-closure') {
	                            if (loanAmount > approvedAmt) {
	                                //backReject = true;
	                                $('#EDITLA__EditLoanAndInsurance__ct_nav_4').removeClass('sno');
	                                $('#EDITLA__EditLoanAndInsurance__ct_nav_2').addClass('sno');
	                                $('#EDITLA__EditLoanAndInsurance__ct_nav_5').addClass('sno');
	                                $('#EDITLA__EditLoanAndInsurance__ct_nav_3').addClass('sno');
	                                $('#EDITLA__EditLoanAndInsurance__rejectAppBtnRow').removeClass('sno');
	                                $('#EDITLA__EditLoanAndInsurance__proceedAppBtn').text("Proceed with â‚¹" + approvedAmt);
	                                apz.app.EditLoanAndInsurance.CBcheckCB(cbResponse);
	                                $('#EDITLA__EditLoanAndInsurance__backIcon').attr('onclick', 'apz.app.EditLoanAndInsurance.rejectApp();');
	                                if (typeof window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].addInfo == 'string') {
	                                    window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].addInfo = JSON.parse(window.KendraLoans.custFetchLoanAppRes.applicationdtls[0]
	                                        .addInfo)
	                                }
	                                window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].addInfo.isAmountUpdate = true;
	                                window.KendraApp.remarks='The Loan updated by '+LoggedInUserDetails.userID +' ('+currentUserRole +') ~(Edit) BRE fee charges applied.';
	                                iseditCBsuccess = true;
	                                ApzCOB.saveLoan();
	                            } else if (approvedAmt > loanAmount) {
	                                //backReject = false;
	                                $('#EDITLA__EditLoanAndInsurance__ct_nav_2').addClass('sno');
	                                $('#EDITLA__EditLoanAndInsurance__ct_nav_3').removeClass('sno');
	                                $('#EDITLA__EditLoanAndInsurance__ct_nav_4').addClass('sno');
	                                $('#EDITLA__EditLoanAndInsurance__ct_nav_5').addClass('sno');
	                                $('#EDITLA__EditLoanAndInsurance__proceedAppBtnRow').removeClass('sno');
	                                $('#EDITLA__EditLoanAndInsurance__appliedAppBtn').text("Proceed with â‚¹" + loanAmount);
	                                $('#EDITLA__EditLoanAndInsurance__upgradeAppBtn').text("Upgrade & Apply with â‚¹" + approvedAmt);
	                                apz.app.EditLoanAndInsurance.CBcheckCB(cbResponse);
	                                $('#EDITLA__EditLoanAndInsurance__backIcon').attr('onclick', 'apz.app.EditLoanAndInsurance.rejectApp();');
	                                if (typeof window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].addInfo == 'string') {
	                                    window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].addInfo = JSON.parse(window.KendraLoans.custFetchLoanAppRes.applicationdtls[0]
	                                        .addInfo)
	                                }
	                                window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].addInfo.isAmountUpdate = false;
	                                window.KendraApp.remarks='The Loan updated by '+LoggedInUserDetails.userID +' ('+currentUserRole +') ~(Edit) BRE fee charges applied.';
	                                iseditCBsuccess = true;
	                                ApzCOB.saveLoan();} else {
	                                let data = {};
	                                var screenId = "",
	                                    microappId = "";
	                                if (window.KendraLoans.scr === "LoanSanction" || window.KendraLoans.scr === "dashboard") {
	                                    screenId = "DetailedScreen";
	                                    microappId = "LoanSa";
	                                    data = {
	                                        selectedCust: window.KendraLoans.selectedLoanSanctionAccnt,
	                                        matchingCustomer: window.KendraLoans.custFetchLoanAppRes,
	                                        cbResp: cbResponse
	                                    };
	                                } else if (window.KendraLoans.scr === "dashboardDisbursement" || window.KendraLoans.scr ==
	                                    'LoanDisbursementList') {
	                                    screenId = "LoanDisbursementList";
	                                    microappId = "LoanDi";
	                                    data = {
	                                        selectedCust: KendraApp.selectedDisbursement,
	                                        matchingCustomer: window.KendraLoans.custFetchLoanAppRes.applicationdtls[0],
	                                        cbResp: cbResponse
	                                    };
	                                }
	                                ApzCOB.launchMicroApp(microappId, screenId, 'APZCBO__BaseScreens__BaseDIV', data);
	                            }
	                            var insDet = window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.insurDtls;
	                                var insurAmt = 0;
	                                if (insDet.member === 'Y' && insDet.Spouse === 'Y') {
	                                    insurAmt = cbResponse.Insurance_Charge_Spouse + cbResponse.Insurance_Charge_Member;
	                                    insDet.applicant_insurance_amt = cbResponse.Insurance_Charge_Member;
	                                    insDet.spouse_insurance_amt = cbResponse.Insurance_Charge_Spouse;
	                                } else if (insDet.member === 'Y') {
	                                    insurAmt = cbResponse.Insurance_Charge_Member;
	                                    insDet.applicant_insurance_amt = cbResponse.Insurance_Charge_Member;
	                                    insDet.spouse_insurance_amt = "";
	                                } else if (insDet.Spouse === 'Y') {
	                                    insurAmt = cbResponse.Insurance_Charge_Spouse;
	                                    insDet.applicant_insurance_amt = "";
	                                    insDet.spouse_insurance_amt = cbResponse.Insurance_Charge_Spouse;
	                                } else {
	                                    insurAmt = 0;
	                                    insDet.applicant_insurance_amt = "";
	                                    insDet.spouse_insurance_amt = "";
	                                }
	                                insDet.insurCharges = insurAmt;
	                                window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.insurDtls = insDet;
	                                var aprxloancharges = parseInt((cbResponse.GST + cbResponse.Processing_fees_without_GST));
	                                var aprxloanchargeswithins = aprxloancharges + insurAmt;
	                                var aprxloanamount = ((parseInt(approvedAmt)) - parseInt((cbResponse.GST + cbResponse.Processing_fees_without_GST + insurAmt)));
	                                window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.loanAmt = cbResponse.Approved_Loan_Amount;
	                                window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.GST = cbResponse.GST;
	                                window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.addInfo1 = aprxloanchargeswithins;
	                                window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.aprxLoanCharges = aprxloancharges;
	                                window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.loanProcessingFee = cbResponse
	                                    .Processing_fees_without_GST;
	                                window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.aprxLoanAmt = aprxloanamount;
	                                window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.iscbUpdated = true;
	                                window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].amount=approvedAmt;
	                                 if(window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].productType == 'EL'){
										window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.interest_Fee = cbResponse.Interest_Fee;
										window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.upfront_Fee = cbResponse.Upfront_Fee;
									 }else{
										window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.interest_Fee = "";
										window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.upfront_Fee = "";
									 }
									 window.KendraApp.remarks='The Loan updated by '+LoggedInUserDetails.userID +' ('+currentUserRole +') ~(Edit) BRE fee charges applied.';
	                                 iseditCBsuccess=true;
	                                 ApzCOB.saveLoan();
	                        } else {
	                            window.KendraLoans.selectedCust='';
	                            ApzCOB.UpdateCRTWorkflow(KendraLoans.custFetchLoanAppRes.applicationdtls[0].applicationId);
	                            $('#EDITLA__EditLoanAndInsurance__backIcon').attr('onclick','apz.app.EditLoanAndInsurance.closeApp();');
	                            //backReject = false;
	                            var cbRate = '';
	                            if (!apz.isNull(cbResponse.Rejection_reason)) {
	                                cbRate = "Due to " + cbResponse.Rejection_reason;
	                                $('#EDITLA__EditLoanAndInsurance__failedmsg_txtcnt').text(cbRate);
	                                $('#EDITLA__EditLoanAndInsurance__failedmsg').removeClass('sno');
	                            } else {
	                                $('#EDITLA__EditLoanAndInsurance__failedmsg').addClass('sno');
	                            }
	                            $('#EDITLA__EditLoanAndInsurance__failedHeader_txtcnt').text('CB Loan Rejected');
	                            $('#EDITLA__EditLoanAndInsurance__ct_nav_2').addClass('sno');
	                            $('#EDITLA__EditLoanAndInsurance__ct_nav_3').addClass('sno');
	                            $('#EDITLA__EditLoanAndInsurance__ct_nav_4').addClass('sno');
	                            $('#EDITLA__EditLoanAndInsurance__ct_nav_5').removeClass('sno');
	                            apz.app.EditLoanAndInsurance.CBcheckCB(cbResponse);
	                            $('#EDITLA__EditLoanAndInsurance__el_btn_10_ul').removeClass('sno');
	                            $('#EDITLA__EditLoanAndInsurance__el_btn_10').removeClass('sno');
	                        }
	                        apz.setElmValue("EDITLA__EditLoanAndInsurance__sucElAmt", ApzCOB.fn_FormatAmount(approvedAmt));
	                    } else {
	                         window.KendraLoans.selectedCust='';
	                         ApzCOB.UpdateCRTWorkflow(KendraLoans.custFetchLoanAppRes.applicationdtls[0].applicationId);
	                         $('#EDITLA__EditLoanAndInsurance__backIcon').attr('onclick','apz.app.EditLoanAndInsurance.closeApp();');
	                        //to-do
	                        $('#EDITLA__EditLoanAndInsurance__ct_nav_2').addClass('sno');
	                        $('#EDITLA__EditLoanAndInsurance__ct_nav_3').addClass('sno');
	                        $('#EDITLA__EditLoanAndInsurance__ct_nav_4').addClass('sno');
	                        $('#EDITLA__EditLoanAndInsurance__ct_nav_5').removeClass('sno');
	                        $('#EDITLA__EditLoanAndInsurance__failedmsg').addClass('sno');
	                        apz.app.EditLoanAndInsurance.CBcheckCB(cbResponse);
	                        $('#EDITLA__EditLoanAndInsurance__el_btn_10_ul').removeClass('sno');
	                        $('#EDITLA__EditLoanAndInsurance__el_btn_10').removeClass('sno');
	                        apz.setElmValue("EDITLA__EditLoanAndInsurance__sucElAmt", ApzCOB.fn_FormatAmount(approvedAmt));
	                    }
	                } else {
	                    ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                }
	            } else {
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	            }
	            apz.stopLoader();
	        },
	        getTotalDueAmount: function(loanId) {
	            let totalDueAmount = 0;
	            if (KendraApp.selectedCustomer.payoffDetails.length > 0) {
	                KendraApp.selectedCustomer.payoffDetails.forEach(function(m, n) {
	                    if (loanId === m.accountId) {
	                        totalDueAmount = (m.amount !== '') ? parseInt(m.amount) : totalDueAmount;
	                    }
	                });
	            }
	            return totalDueAmount
	        },
	        FetchApplicationList: function() {
	            var Loggeduser = '';
	            if (apz.deviceType === "WEB") {
	                Loggeduser = gApzCOB.LoggedInUserDetails.loginResponse.addInfo1
	            } else {
	                Loggeduser = "RPC";
	            }
	            if (userRole === "AM" || userRole === "RM" || userRole === "DM" || userRole === "ZM" || userRole ==='SH') {
	                var requestObj = {
	                    "userRole": Loggeduser,
	                    "loggedInUserRole": Loggeduser
	                }
	            } else {
	                var requestObj = {
	                    "userRole": Loggeduser
	                }
	            }
	            if (LoggedInUserDetails.loginResponse.addInfo1 == 'KM') {
	                requestObj = {
	                    "userRole": Loggeduser,
	                    "loggedInUserRole": LoggedInUserDetails.loginResponse.addInfo1,
	                    "userId": LoggedInUserDetails.userID
	                }
	            }
	            apz.startLoader();
	            var request = {
	                "apiRequest": {
	                    "appId": gAppId,
	                    "interfaceId": "FetchApplicationList",
	                    "userId": LoggedInUserDetails.userID,
	                    "requestObj": requestObj
	                }
	            }
	            ApzCOB.serverBuildParam(gAppId, 'FetchApplicationList', 'N', 'N', request, 'Y', ApzCOB.FetchApplicationListCB);
	        },
	        FetchApplicationListCB: function(params) {
	            apz.stopLoader();
	            if (ApzCOB.handleServiceCallBacks(params)) {
	                if (!apz.isNull(params.res.APZCBO__FetchApplicationList_Res.apiResponse.ResponseBody.responseObj)) {
	                    applicationResp = JSON.parse(params.res.APZCBO__FetchApplicationList_Res.apiResponse.ResponseBody.responseObj);
	                    if (apz.deviceType === "WEB") {
	                        ApzCOB.customlogincallback();
	                    } else {
	                        ApzCOB.launchMicroApp("Income", "PendingTask", 'APZCBO__BaseScreens__BaseDIV', '');
	                    }
	                } else {
	                    ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                }
	            } else {
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	            }
	        },
	        FetchIncomeApplicationList: function() {
	            var Loggeduser = '';
	            if (apz.deviceType === "WEB") {
	                Loggeduser = gApzCOB.LoggedInUserDetails.loginResponse.addInfo1
	            } else {
	                Loggeduser = "RPC";
	            }
	            var requestObj = {
	                "userRole": Loggeduser
	            }
	            if (LoggedInUserDetails.loginResponse.addInfo1 == 'KM') {
	                requestObj = {
	                    "userRole": Loggeduser,
	                    "loggedInUserRole": LoggedInUserDetails.loginResponse.addInfo1,
	                    "userId": LoggedInUserDetails.userID
	                }
	            }
	            apz.startLoader();
	            var request = {
	                "apiRequest": {
	                    "appId": gAppId,
	                    "interfaceId": "FetchApplicationList1",
	                    "userId": LoggedInUserDetails.userID,
	                    "requestObj": requestObj
	                }
	            }
	            if (apz.deviceType !== 'WEB') {
	                apz.app.BaseScreens.UEstartTimer("FetchApplication List", request);
	                apz.app.BaseScreens.UElogevent("FetchApplication List", request);
	            }
	            ApzCOB.serverBuildParam(gAppId, 'FetchApplicationList1', 'N', 'N', request, 'Y', ApzCOB.FetchIncomeApplicationListCB);
	        },
	        FetchIncomeApplicationListCB: function(params) {
	            apz.stopLoader(params);
	            if (apz.deviceType !== 'WEB') {
	                apz.app.BaseScreens.UEstopTimer("FetchApplication List", params.req);
	            }
	            // console.log();
	            if (ApzCOB.handleServiceCallBacks(params)) {
	                if (!apz.isNull(params.res.APZCBO__FetchApplicationList1_Res.apiResponse.ResponseBody.responseObj)) {
	                    applicationResp = JSON.parse(params.res.APZCBO__FetchApplicationList1_Res.apiResponse.ResponseBody.responseObj);
	                    if (apz.deviceType === "WEB") {
	                        ApzCOB.customlogincallback();
	                    } else {
	                        // ApzCOB.launchMicroApp("Income", "PendingTask", 'APZCBO__BaseScreens__BaseDIV', '');
	                    }
	                } else {
	                    ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                }
	            } else {
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	            }
	        },
	        /*FuncPaginationNext: function() { //function on click of next button in pagiation
	                $(".J-paginationjs-next").trigger("click");
	                // $(".dev-page-input").val(window.pageNo);
	                $(pageInputCSSClass).val(window.pageNo);
	            },
	            FuncPaginationPrev: function() { //function on click of previous button in pagiation
	                $(".J-paginationjs-previous").trigger("click");
	                $(pageInputCSSClass).val(window.pageNo);
	            },*/
	        FuncPaginationGo: function(pthis) { //function on keyup of go button in pagiation
	            pthis.value = pthis.value.replace(gALLOWONLYNUM, '');
	            $(".J-paginationjs-go-pagenumber").val($(pageInputCSSClass).val())
	            $(".J-paginationjs-go-pagenumber").trigger("change");
	            $(pageInputCSSClass).trigger("focus");
	            $(pageInputCSSClass).val(window.pageNo);
	        },
	        showDashActivity: function() {
	            apz.startLoader();
	            var request = {
	                "apiRequest": {
	                    "appId":gAppId,
	                    "interfaceName": "FetchMatrixData",
	                    "userId": LoggedInUserDetails.userID,
	                    "requestObj": {
	                        "userRole": LoggedInUserDetails.loginResponse.addInfo1,
	                        "userId": LoggedInUserDetails.userID
	                    }
	                }
	            }
	            ApzCOB.serverBuildParam(gAppId, 'FetchMatrixData', 'N', 'N', request, 'Y', ApzCOB.showDashActivityCB);
	        },
	        showDashActivityCB: function(params) {
	            apz.stopLoader();
	            if (ApzCOB.handleServiceCallBacks(params)) {
	                if (!apz.isNull(params.res.APZCBO__FetchMatrixData_Res.apiResponse.ResponseBody.responseObj)) {
	                    var dashCountResp = JSON.parse(params.res.APZCBO__FetchMatrixData_Res.apiResponse.ResponseBody.responseObj);
	                    if (dashCountResp) {
	                        let cbSuccessCnt = dashCountResp.cbSuccessCnt,
	                            cbFailureCnt = dashCountResp.cbFailureCnt,
	                            cbPendingCnt = dashCountResp.cbPendingCnt,
	                            cbHoldCnt = dashCountResp.cbHoldCnt;
	                        apz.setElmValue(DashboardScrId + "totalLoanApplications", parseInt(cbSuccessCnt) + parseInt(cbFailureCnt) + parseInt(
	                            cbPendingCnt) + parseInt(cbHoldCnt));
	                        apz.setElmValue(DashboardScrId + "cbPassedApplications", parseInt(cbSuccessCnt));
	                        apz.setElmValue(DashboardScrId + "cbFailedApplications", parseInt(cbFailureCnt));
	                        apz.setElmValue(DashboardScrId + "cbPendingApplications", parseInt(cbPendingCnt));
	                        apz.setElmValue(DashboardScrId + "newLoanApplications", dashCountResp.sanctionApplnCnt);
	                        apz.setElmValue(DashboardScrId + "totalDisbLoanAmount", dashCountResp.sanctionAmt);
	                        apz.setElmValue(DashboardScrId + "newLoanApplicationsText", dashCountResp.sanctionApplnCnt);
	                        apz.setElmValue(DashboardScrId + "totalDisbLoanAmountText", dashCountResp.sanctionAmt);
	                        $('#Dashbo__dashboard__gr_row_46').css("padding-top", "0px");
	                        $('#Dashbo__dashboard__gr_row_39').removeClass('sno');
	                        $('#APZCBO__BaseScreens__sc_row_171').removeClass('sno');
	                        $('#Dashbo__dashboard__sc_col_50').removeClass('sno');
	                        if (userRole === "KM") {
	                            apz.app.Dashboard.loadCollectionsTarget();
	                        }
	                    }
	                } else {
	                    ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                }
	            } else {
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	            }
	        },
	        createInstantLoanRequest: function() {
	            var instloanRequest = {};
	            var loanDtls = {
	                "loanAmount": "1000",
	                "loanMode": "ON FIELD",
	                "disburseMode": KendraApp.selectedELCustomer.instantLoanDetailsObj.disburseMode,
	                "product": KendraApp.selectedELCustomer.instantLoanDetailsObj.selEligibleLoanDtls.productId,
	                "productId": KendraApp.selectedELCustomer.instantLoanDetailsObj.selEligibleLoanDtls.productId,
	                "productType": KendraApp.selectedELCustomer.instantLoanDetailsObj.selEligibleLoanDtls.productType,
	                "shortDesc": KendraApp.selectedELCustomer.instantLoanDetailsObj.selEligibleLoanDtls.shortDesc,
	                "term": KendraApp.selectedELCustomer.instantLoanDetailsObj.selEligibleLoanDtls.term,
	                "tenure": KendraApp.selectedELCustomer.instantLoanDetailsObj.selEligibleLoanDtls.term,
	                "chargeAndBreakupDtls": KendraApp.selectedELCustomer.instantLoanDetailsObj.chargeAndBreakupDtls,
	                "repayFrequency": KendraApp.selectedELCustomer.instantLoanDetailsObj.repayFrequency,
	                "description": KendraApp.selectedELCustomer.instantLoanDetailsObj.selEligibleLoanDtls.description,
	                "productStatus": KendraApp.selectedELCustomer.instantLoanDetailsObj.selEligibleLoanDtls.productStatus,
	                "loanProdType": KendraApp.selectedELCustomer.instantLoanDetailsObj.selEligibleLoanDtls.loanProdType
	            };
	            instloanRequest.applicationdtls = {
	                "refId": KendraApp.selectedELCustomer.customerId + ApzCOB.generateRandomNumber(),
	                "applicationId": "",
	                "versionNo": "",
	                "applicationDate": ApzCOB.dateMMDDYYYYformat(),
	                "approvalLevel": "",
	                "status": '',
	                "kmId": KendraApp.selectedKendra.kmId,
	                "kendraName": KendraApp.selectedKendra.kendraName,
	                "kendraId": KendraApp.selectedKendra.kendraId,
	                "branchId": KendraApp.selectedKendra.branchId,
	                "groupId": KendraApp.selectedKendra.groupId,
	                "leader": KendraApp.selectedKendra.leader,
	                "createTs": ApzCOB.currentTimeStamp(),
	                "ModifyTs": ApzCOB.currentTimeStamp(),
	                "updatedBy": KendraApp.selectedKendra.kmId,
	                "customerId": KendraApp.selectedELCustomer.customerId,
	                "customerDtls": {}
	            };
	            var kycDetails = {
	                'dob': KendraApp.selectedELCustomer.dob,
	                "maritalStatus": KendraApp.selectedELCustomer.maritalStatus,
	                'memRelation': KendraApp.selectedELCustomer.memRelation,
	                "mobileNum": KendraApp.selectedELCustomer.mobileNum,
	                'primaryId': KendraApp.selectedELCustomer.primaryId,
	                "primaryType": KendraApp.selectedELCustomer.primaryType,
	                'vintage': KendraApp.selectedELCustomer.vintage
	            };
	            instloanRequest.applicationdtls.customerDtls = {
	                'customerId': KendraApp.selectedELCustomer.customerId,
	                "customerName": KendraApp.selectedELCustomer.customerName,
	                "kycDtls": kycDetails,
	                "loanDtls": loanDtls
	            }
	            return instloanRequest;
	        },
	        downloadLoanDBKitReport: function(applicationId) {
	            apz.startLoader();
	            var request = {
	                "apiRequest": {
	                    "appId": gAppId,
	                    "interfaceName": "FetchDBKitReport",
	                    "requestObj": {
	                        "appId": gAppId,
	                        "applicationId": applicationId,
	                        "versionNum": "1"
	                    }
	                }
	            }
	            if (apz.deviceType !== 'WEB') {
	                apz.app.BaseScreens.UEstartTimer("Disbursement Kit Report", request);
	                apz.app.BaseScreens.UElogevent("Disbursement Kit Report", request);
	            }
	            ApzCOB.serverBuildParam(gAppId, 'FetchDBKitReport', 'N', 'N', request, 'Y', ApzCOB.downloadLoanDBKitReportCB);
	        },
	        downloadLoanDBKitReportCB: function(params) {
	            apz.stopLoader();
	            if (apz.deviceType !== 'WEB') {
	                apz.app.BaseScreens.UEstopTimer("Disbursement Kit Report", params.req);
	            }
	            try {
	                //if (ApzCOB.handleServiceCallBacks(params)) {
	                if (!apz.isNull(params.res.APZCBO__FetchDBKitReport_Res.apiResponse.ResponseBody.responseObj)) {
	                    var base64Resp = params.res.APZCBO__FetchDBKitReport_Res.apiResponse.ResponseBody.responseObj;
	                    if (base64Resp !== '') {
	                        if ((userRoleIfDeoAvailable.includes("DEO") && userRoleIfDeoAvailable.includes("KM") || userRole === 'BM') && apz
	                            .deviceType === 'WEB') {
	                            var byteCharacters = atob(base64Resp);
	                            var byteNumbers = new Array(byteCharacters.length);
	                            for (var i = 0; i < byteCharacters.length; i++) {
	                                byteNumbers[i] = byteCharacters.charCodeAt(i);
	                            }
	                            var byteArray = new Uint8Array(byteNumbers);
	                            var blob = new Blob([byteArray], { type: 'text/html' });
	                            var link = document.createElement('a');
	                            link.href = URL.createObjectURL(blob);
	                            // Amit Changes for pdf to html
	                            link.download = "Disbursement_Kit_" + KendraLoans.custFetchLoanAppRes.applicationdtls[0].applicationId + ".html";
	                            //link.download = "Disbursement_Kit_" + KendraLoans.custFetchLoanAppRes.applicationdtls[0].applicationId + ".pdf";
	                            link.click();
	                            URL.revokeObjectURL(link.href);
	                            return;
	                        }
	                        //ApzCOB.convertBase64ToFile(base64Resp, "Loan Disbursement Kit");
	                        ApzCOB.base64toSavefile(base64Resp, "Disbursement_Kit_" + KendraLoans.custFetchLoanAppRes.applicationdtls[0]
	                            .applicationId, "Loan Disbursement Kit");
	                    } else {
	                        ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_INVALID_REPORT_MSG"), "E");
	                    }
	                } else {
	                    ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_INVALID_REPORT_MSG"), "E");
	                }
	            } catch (e) {
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_INVALID_REPORT_MSG"), "E");
	            }
	            /*} else {
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_INVALID_REPORT_MSG"), "E");
	            }*/
	        },
	        downloadSanctionReport: function(applicationId) {
	            apz.startLoader();
	            var request = {
	                "apiRequest": {
	                    "appId": gAppId,
	                    "interfaceName": "FetchSanctionReport",
	                    "requestObj": {
	                        "appId": gAppId,
	                        "applicationId": applicationId,
	                        "versionNum": "1"
	                    }
	                }
	            }
	            if (apz.deviceType !== 'WEB') {
	                apz.app.BaseScreens.UEstartTimer("Sanction Report", request);
	                apz.app.BaseScreens.UElogevent("Sanction Report", request);
	            }
	            ApzCOB.serverBuildParam(gAppId, 'FetchSanctionReport', 'N', 'N', request, 'Y', ApzCOB.downloadSanctionReportCB);
	        },
	        downloadSanctionReportCB: function(params) {
	            if (apz.deviceType !== 'WEB') {
	                apz.app.BaseScreens.UEstopTimer("Sanction Report", params.req);
	            }
	            apz.stopLoader();
	            try {
	                //if (ApzCOB.handleServiceCallBacks(params)) {
	                if (!apz.isNull(params.res.APZCBO__FetchSanctionReport_Res.apiResponse.ResponseBody.responseObj)) {
	                    var base64Resp = params.res.APZCBO__FetchSanctionReport_Res.apiResponse.ResponseBody.responseObj;
	                    if (base64Resp !== '') {
	                        if ((userRoleIfDeoAvailable.includes("DEO") && userRoleIfDeoAvailable.includes("KM") || userRole === 'BM') && apz
	                            .deviceType === 'WEB') {
	                            var byteCharacters = atob(base64Resp);
	                            var byteNumbers = new Array(byteCharacters.length);
	                            for (var i = 0; i < byteCharacters.length; i++) {
	                                byteNumbers[i] = byteCharacters.charCodeAt(i);
	                            }
	                            var byteArray = new Uint8Array(byteNumbers);
	                            var blob = new Blob([byteArray], { type: 'text/html' });
	                            var link = document.createElement('a');
	                            link.href = URL.createObjectURL(blob);
	                            //Amit Changes for HTML To pdf
	                            link.download = "KFS_Document_" + KendraLoans.custFetchLoanAppRes.applicationdtls[0].applicationId + ".html";
	                            // link.download = "Santioned_Report_" + KendraLoans.custFetchLoanAppRes.applicationdtls[0].applicationId + ".pdf";
	                            link.click();
	                            URL.revokeObjectURL(link.href);
	                            return;
	                        }
	                        //ApzCOB.convertBase64ToFile(base64Resp, "Loan Disbursement Kit");
	                        ApzCOB.base64toSavefile(base64Resp, "KFS_Document_" + KendraLoans.custFetchLoanAppRes.applicationdtls[0]
	                            .applicationId, "Loan KFS Report");
	                    } else {
	                        ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_INVALID_REPORT_MSG"), "E");
	                    }
	                } else {
	                    ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_INVALID_REPORT_MSG"), "E");
	                }
	            } catch (e) {
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_INVALID_REPORT_MSG"), "E");
	            }
	            /*} else {
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_INVALID_REPORT_MSG"), "E");
	            }*/
	        },
	        downloadCbReport: function() {
	            apz.startLoader();
	            var request = {
	                "apiRequest": {
	                    "appId": gAppId,
	                    "interfaceName": "CBReportDownload",
	                    "serviceName": "bank",
	                    "userId": LoggedInUserDetails.userID,
	                    "requestObj": {
	                        "loanId": KendraApp.AppCreateResObj.applicationId
	                    }
	                }
	            }
	            if (apz.deviceType !== 'WEB') {
	                apz.app.BaseScreens.UEstartTimer("CBReport Download", request);
	                apz.app.BaseScreens.UElogevent("CBReport Download", request);
	            }
	            ApzCOB.serverBuildParam(gAppId, 'CBReportDownload', 'N', 'N', request, 'Y', ApzCOB.downloadCbReportCB);
	        },
	        downloadCbReportCB: function(params) {
	            if (apz.deviceType !== 'WEB') {
	                apz.app.BaseScreens.UEstopTimer("CBReport Download", params.req);
	            }
	            apz.stopLoader();
	            try {
	                //if (ApzCOB.handleServiceCallBacks(params)) {
	                if (!apz.isNull(params.res.APZCBO__CBReportDownload_Res.apiResponse.ResponseBody.responseObj)) {
	                    var base64Resp = params.res.APZCBO__CBReportDownload_Res.apiResponse.ResponseBody.responseObj;
	                    if (base64Resp !== '') {
	                        if (apz.deviceType === 'WEB') {
	                            var fileName = "CB_Report_" + KendraApp.AppCreateResObj.applicationId + ".pdf";
	                            var byteCharacters = atob(base64Resp);
	                            var byteArray = new Uint8Array(byteCharacters.length);
	                            for (let i = 0; i < byteCharacters.length; i++) {
	                                byteArray[i] = byteCharacters.charCodeAt(i);
	                            }
	                            var blob = new Blob([byteArray], {
	                                type: 'application/pdf'
	                            });
	                            var link = document.createElement('a');
	                            link.href = URL.createObjectURL(blob);
	                            link.download = fileName;
	                            link.click();
	                            URL.revokeObjectURL(link.href);
	                            return;
	                        } else {
	                            //ApzCOB.convertBase64ToFile(base64Resp, "Loan Disbursement Kit");
	                            ApzCOB.base64toSavefile(base64Resp, "CB_Report_" + KendraApp.AppCreateResObj.applicationId, "CB Report");
	                        }
	                    } else {
	                        ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_INVALID_REPORT_MSG"), "E");
	                    }
	                }
	            } catch (e) {
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_INVALID_REPORT_MSG"), "E");
	            }
	        },
	        downloadBase64ToPdf: function(base64) {
	            var applicationId = "Loan Sanction Letter";
	            const linkSource = `data:application/pdf;base64,${base64}`;
	            const downloadLink = document.createElement("a");
	            const fileName = applicationId + ".pdf";
	            downloadLink.href = linkSource;
	            downloadLink.download = fileName;
	            downloadLink.click();
	        },
	        defEarningMemObjFormat: function(details) {
	            gApzCOB.addedFamilyMemberObj = {
	                "customerId": "",
	                "index": 0,
	                "rowNo": 0,
	                "name": "",
	                "dob": "",
	                "memRelation": "",
	                "legaldocName": "",
	                "legaldocId": "",
	                "OCRresponselog": "",
	                "OCRData": {
	                    "name": "",
	                    "dob": "",
	                    "memRelation": "",
	                    "legaldocName": "",
	                    "legaldocId": ""
	                },
	                "InputData": {
	                    "name": "",
	                    "dob": "",
	                    "memRelation": "",
	                    "legaldocName": "",
	                    "legaldocId": ""
	                },
	                "isKycEdited": false,
	                "isEarning": false,
	                "isEdited": false,
	                "forntImg": "",
	                "backImg": ""
	            }
	        },
	        viewDocument: function(base64) {
	            if (window.innerWidth >= 768 || screen.width >= 768) {
	                ApzCOB.pdfPreviewer(base64, '');
	            } else {
	                ApzCOB.viewPDF(base64, '');
	            }
	            return;
	        },
	        pdfPreviewer: function(b64Data, _title) {
	            var dialog =
	                `<div id="pdfDialog" title="${_title}"><canvas id="pdfview" style=" height: 0; width: 0; "></canvas><div id='pdfControls'><iframe style="margin: auto; display: block; width: 60vw; height: 70vh;" id="iframe-preview"></iframe><div class="pdf-cntrls-hldr"><p><label></label><label id="pageNum"></label><label></label><label id="pageLength"></label></p></div></div></div>`;
	            $("div[id=pdfDialog]").remove();
	            $(document.body).append(dialog);
	            $("#pdfDialog").dialog({
	                open: function(event, ui) {
	                    $("#pdfControls p").after($(this).parent().find(".ui-dialog-buttonpane"));
	                    const pdfViewModal = $("div[aria-describedby=pdfDialog]");
	                    pdfViewModal.length > 0 && pdfViewModal[0].classList.add("pdfViewerModal");
	                    $(".pdf-cntrls-hldr button").removeClass("ui-button ui-corner-all ui-widget");
	                    $(".pdfViewerModal canvas ").before($(".pdfViewerModal .ui-dialog-titlebar"));
	                    $(".pdfViewerModal .ui-dialog-titlebar button").attr("class", "ett-bttn tsp med icl pdfCloseBtn").empty()
	                        .append(
	                            '<svg id="btn_icon_icon-remove" aria-hidden="true" role="presentation" class="ett-icon icon-remove  px24 "><use xlink:href="#icon-remove"></use></svg>'
	                            )
	                },
	                width: $(window).width() / 2,
	                modal: true,
	                position: {
	                    my: "top",
	                    at: "top",
	                    of : window,
	                    collision: "none"
	                }
	            });
	            const sliceSize = 512;
	            const contentType = 'application/pdf';
	            const byteCharacters = atob(b64Data);
	            const byteArrays = [];
	            for (let offset = 0; offset < byteCharacters.length; offset += sliceSize) {
	                const slice = byteCharacters.slice(offset, offset + sliceSize);
	                const byteNumbers = new Array(slice.length);
	                for (let i = 0; i < slice.length; i++) {
	                    byteNumbers[i] = slice.charCodeAt(i);
	                }
	                const byteArray = new Uint8Array(byteNumbers);
	                byteArrays.push(byteArray);
	            }
	            const blob = new Blob(byteArrays, {
	                type: contentType
	            });
	            const blobUrl = URL.createObjectURL(blob);
	            const img = document.getElementById('iframe-preview');
	            img.src = blobUrl + "#zoom=fitW";
	        },
	        viewPDF: function(_base64, _title) {
	            // HTML definition of dialog elements
	            var dialog =
	                `<div id="pdfDialog" title="${_title}"><canvas id="pdfview"></canvas><div id='pdfControls'><div class="pdf-cntrls-hldr"><p><label>Page: </label><label id="pageNum"></label><label> of </label><label id="pageLength"></label></p></div></div></div>`;
	            $("div[id=pdfDialog]").remove();
	            $(document.body).append(dialog);
	            // We need the javascript object of the canvas, not the jQuery reference
	            var canvas = document.getElementById('pdfview');
	            // Init page count
	            var page = 1;
	            // Dialog definition
	            $("#pdfDialog").dialog({
	                // Moves controls to top of dialog
	                open: function(event, ui) {
	                    $('#pdfControls p').after($(this).parent().find('.ui-dialog-buttonpane'));
	                    const pdfViewModal = $('div[aria-describedby=pdfDialog]');
	                    (pdfViewModal.length > 0) && (pdfViewModal[0].classList.add('pdfViewerModal'));
	                    //$('.pdf-cntrls-hldr button').attr('class','ett-bttn med');
	                    $('.pdf-cntrls-hldr button').removeClass('ui-button ui-corner-all ui-widget');
	                    $('.pdfViewerModal canvas ').before($('.pdfViewerModal .ui-dialog-titlebar'));
	                    $('.pdfViewerModal .ui-dialog-titlebar button').attr('class', 'ett-bttn tsp med icl pdfCloseBtn').empty()
	                        .append(
	                            '<svg id="btn_icon_icon-remove" aria-hidden="true" role="presentation" class="ett-icon icon-remove  px24 "><use xlink:href="#icon-remove"></use></svg>'
	                            );
	                },
	                width: ($(window).width() / 2),
	                modal: true,
	                position: {
	                    my: "top",
	                    at: "top",
	                    of : window,
	                    collision: "none"
	                },
	                buttons: {
	                    "Back": {
	                        class: 'pdfPrevBtn ett-bttn med sec',
	                        click: function() {
	                            RenderPDF(-1)
	                        },
	                        text: 'Previous',
	                    },
	                    "Next": {
	                        class: 'pdfNextBtn ett-bttn med pri',
	                        click: function() {
	                            RenderPDF(1)
	                        },
	                        text: 'Next',
	                    },
	                    // "Confirm": {
	                    //     class:'pdfCloseBtn',
	                    //     click: function() {
	                    //         $(this).dialog("close");
	                    //         $(this).dialog("close");
	                    //         $("#pdfDialog").remove()
	                    //     },
	                    //     text: 'Close',
	                    // }
	                }
	            });
	            // Init page number and the document
	            $('#pageNum').text(page);
	            RenderPDF(0);
	            // PDF.js control
	            function RenderPDF(pageNumber) {
	                var pdfData = atob(_base64);
	                pdfjsLib.disableWorker = true;
	                // Get current global page number, defaults to 1
	                displayNum = parseInt($('#pageNum').html())
	                pageNumber = parseInt(pageNumber)
	                var loadingTask = pdfjsLib.getDocument({
	                    data: pdfData
	                });
	                loadingTask.promise.then(function(pdf) {
	                    // Gets total page length of pdf
	                    size = pdf.numPages;
	                    $('#pageLength').text(size);
	                    // Handling for changing pages
	                    if (pageNumber === 1) {
	                        pageNumber = displayNum + 1;
	                    }
	                    if (pageNumber === -1) {
	                        pageNumber = displayNum - 1;
	                    }
	                    if (pageNumber === 0) {
	                        pageNumber = 1;
	                    }
	                    // If the requested page is outside the document bounds
	                    if (pageNumber > size || pageNumber < 1) {
	                        throw "bad page number";
	                    }
	                    // Changes the cheeky global to our valid new page number
	                    $('#pageNum').text(pageNumber)
	                    pdf.getPage(pageNumber).then(function(page) {
	                        var scale = 2.0;
	                        var viewport = page.getViewport(scale);
	                        var context = canvas.getContext('2d');
	                        canvas.height = viewport.height;
	                        canvas.width = viewport.width;
	                        var renderContext = {
	                            canvasContext: context,
	                            viewport: viewport
	                        };
	                        page.render(renderContext);
	                    });
	                }).catch(e => {});
	            }
	        },
	        plaintoDateformat: function(yyyymmdd, type) {
	            var year = yyyymmdd.substring(0, 4); // Extract year, month, and day from the input dateStr
	            var month = yyyymmdd.substring(4, 6);
	            var day = yyyymmdd.substring(6, 8);
	            var formattedDob = '';
	            if (apz.isNull(type)) {
	                formattedDob = day + '/' + month + '/' + year;
	            } else {
	                formattedDob = year + type + month + type + day;
	            }
	            return formattedDob;
	        },
	        formattedtoPlain: function(formatdate, type) {
	            var datearr = [];
	            if (apz.isNull(type)) {
	                datearr = formatdate.split('/');
	            } else {
	                datearr = formatdate.split(type);
	            }
	            var plainDate = datearr[2] + datearr[1] + datearr[0];
	            return plainDate;
	        },
	        fetchSRRequestList: function() {
	            let UserBranchId = '';
	            let createBy = '';
	            let userRole = '';
	            let amId = '';
	            if (window.userRole === 'BM' || window.userRole == 'CASHIER') {
	                UserBranchId = LoggedInUserDetails.loginResponse.addInfo2;
	            } else if (window.userRole === "AM") {
	                userRole = "AM",
	                    amId = LoggedInUserDetails.userID;
	            } else {
	                createBy = LoggedInUserDetails.loginResponse.userDet.name
	            }
	            var req = {
	                "apiRequest": {
	                    "interfaceName": "FetchAllSROperation",
	                    "appId": gAppId,
	                    "userId": LoggedInUserDetails.userID,
	                    "requestObj": {
	                        "branchId": UserBranchId,
	                        "createdBy": createBy,
	                        "userRole": userRole,
	                        "amId": amId,
	                    }
	                }
	            }
	            if (apz.deviceType !== 'WEB') {
	                apz.app.BaseScreens.UEstartTimer("Fetch SR Application List", req);
	                apz.app.BaseScreens.UElogevent("Fetch SR Application List", req);
	            }
	            ApzCOB.serverBuildParam(gAppId, "FetchAllSROperation", "N", "N", req, false, ApzCOB.fetchSRRequestListCB);
	        },
	        fetchSRRequestListCB: function(params) {
	            if (apz.deviceType !== 'WEB') {
	                apz.app.BaseScreens.UEstopTimer("Fetch SR Application List", params.req);
	            }
	            try {
	                if (ApzCOB.handleServiceCallBacks(params)) {
	                    if (!apz.isNull(params.res.APZCBO__FetchAllSROperation_Res.apiResponse.ResponseBody.responseObj)) {
	                        if (params.res.APZCBO__FetchAllSROperation_Res.apiResponse.ResponseHeader.ResponseCode === '0') {
	                            let fetchResponse = params.res.APZCBO__FetchAllSROperation_Res.apiResponse.ResponseBody.responseObj;
	                            let listRes = JSON.parse(fetchResponse);
	                            if (userRole === "AM" || userRole === "RM" || userRole === "DM" || userRole === "ZM", userRole==='SH') {
	                                window.srList = JSON.parse(listRes.apiResponse);
	                                // if (apz.app.AMApproval.loadAMData) {
	                                //     apz.app.AMApproval.loadAMData();
	                                // }
	                                window.accessType = 'L';
	                                ApzCOB.customlogincallback();
	                            } else if (listRes.hasOwnProperty('apiResponse')) {
	                                window.srList = listRes.apiResponse;
	                                ApzCOB.updateKendraResponse();
	                            }
	                            //apz.app.Dashboard.updatedActivityCount();
	                        } else {
	                            // window.srList = [];
	                            ApzCOB.customlogincallback();
	                        }
	                    }
	                } else {
	                    //window.srList = [];
	                    ApzCOB.customlogincallback();
	                }
	            } catch (e) {
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	            }
	        },
	        verifyUserId: function(userId, otpCB) {
	            apz.startLoader();
	            ApzCOB.fnOTPCB = otpCB;
	            var req = {
	                "apiRequest": {
	                    "interfaceName": "FetchUserDetails",
	                    "appId": gAppId,
	                    "requestObj": {
	                        "userId": userId
	                    }
	                }
	            }
	            ApzCOB.serverBuildParam(gAppId, "FetchUserDetails", "N", "N", req, false, ApzCOB.verifyUserIdCB);
	        },
	        verifyUserIdCB: function(params) {
	            try {
	                if (ApzCOB.handleServiceCallBacks(params)) {
	                    if (params.res.APZCBO__FetchUserDetails_Res.apiResponse.ResponseHeader.ResponseCode === '0') {
	                        if (!apz.isNull(params.res.APZCBO__FetchUserDetails_Res.apiResponse.ResponseBody.responseObj)) {
	                            apz.stopLoader();
	                            let userDtlResp = "";
	                            let userResp = params.res.APZCBO__FetchUserDetails_Res.apiResponse.ResponseBody.responseObj;
	                            if (typeof userResp === "string") {
	                                userResp = JSON.parse(userResp);
	                            }
	                            if (userResp.hasOwnProperty("userDetail")) {
	                                if (typeof userResp.userDetail === "string") {
	                                    userDtlResp = JSON.parse(userResp.userDetail);
	                                } else {
	                                    userDtlResp = userResp.userDetail;
	                                }
	                            }
	                            if (userDtlResp.hasOwnProperty("userId")) {
	                                window.LoggedInUserDetails = userDtlResp;
	                                gApzCOB.LoggedInUserDetails = window.LoggedInUserDetails;
	                                window.LoggedInUserDetails.userID = gApzCOB.LoggedInUserDetails.userId;
	                                if (!apz.isNull(userDtlResp.userPhone1)) {
	                                    ApzCOB.generateOtp(window.LoggedInUserDetails.userID, userDtlResp.userPhone1);
	                                } else {
	                                    ApzCOB.fnDisplayMsg("User Mobile Number is not present. Kindly contact helpdesk.", "E");
	                                }
	                            } else {
	                                ApzCOB.fnDisplayMsg("Unable to find User Id.", "E");
	                            }
	                        } else {
	                            apz.stopLoader();
	                            ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_FETCH_USR_DTL_FAIL_MSG"), "E");
	                        }
	                    } else {
	                        apz.stopLoader();
	                        ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_FETCH_USR_DTL_FAIL_MSG"), "E");
	                    }
	                } else {
	                    apz.stopLoader();
	                    ApzCOB.fnDisplayMsg("User does not Exist.", "E");
	                }
	            } catch (e) {
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	            }
	        },
	        generateOtp: function(userID, userPhone) {
	            apz.startLoader();
	            var req = {
	                "apiRequest": {
	                    "interfaceName": "GenerateOTPAndSendSMS",
	                    "workflowId": "GenerateOTPAndSendSMS",
	                    "appId": apz.appId,
	                    "userId": userID !== "" ? userID : LoggedInUserDetails.userID,
	                    "requestObj": {
	                        "payload": {},
	                        "actionType": "OTP_SEND",
	                        "mobileNo": userPhone,
	                        "workflowId": "GenerateOTPAndSendSMS",
	                        "interfaceName": "GenerateOTPAndSendSMS",
	                        "type": "PRE_LOGIN"
	                    }
	                }
	            }
	            ApzCOB.serverBuildParam(gAppId, "WorkFlowService", "N", "N", req, true, ApzCOB.generateOtpCB);
	        },
	        generateOtpCB: function(params) {
	            apz.stopLoader();
	            try {
	                if (ApzCOB.handleServiceCallBacks(params)) {
	                    if (!apz.isNull(params.res.APZCBO__WorkFlowService_Res.apiResponse.ResponseBody.responseObj)) {
	                        var otpRes = JSON.parse(params.res.APZCBO__WorkFlowService_Res.apiResponse.ResponseBody.responseObj);
	                        otpRes = JSON.parse(otpRes.apiResponse.ResponseBody.responseObj).GenerateOTP;
	                        if (!apz.isNull(otpRes)) {
	                            ApzCOB.fnOTPCB(otpRes);
	                            //apz.app.Registration.displayOtp(otpRes);
	                        } else {
	                            ApzCOB.fnDisplayMsg("Otp generation failed, please try again later..", "E");
	                        }
	                    }
	                }
	            } catch (e) {
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	            }
	        },
	        startTimer: function(count, scrId) {
	            var counter;
	            counter = new TimerCounter();
	            counter.init("" + scrId + "otptimertext", 30);
	        },
	        timerEnd: function() {
	            var postLoginScrn = apz.currScr.split("_")[0];
	            var screenID = apz.currAppId + "__" + apz.childScr + "__";
	            window.otpRegenCount = 3;
	            if (apz.getElmValue(screenID + "otptimertext") === "0:00") {
	                clearInterval(selInterval);
	            }
	            if (apz.childScr === 'OTPAuthentication') {
	                if (window.otpRegenCount !== RegenCount) {
	                    $("#" + screenID + "Regenerateotp").removeClass("sno");
	                    $("#" + screenID + "Regenerateotp_ul").removeClass("sno");
	                    $("#" + screenID + "otpExpiredMsg").removeClass("sno");
	                    $("#" + screenID + "otpSecText_ul").removeClass("sno");
	                    $("#" + screenID + "otptimertext_ul").removeClass("sno");
	                    $("#" + screenID + "otpExpiredErrDiv").addClass("sno");
	                    $("#" + screenID + "expiryDIV").addClass("sno");
	                    $("#" + screenID + "dummyotptxt").removeClass("sno");
	                    $("#" + screenID + "otpSubmitBtn").attr('disabled', false);
	                } else if (!ShowError) {
	                    window.ShowError = true;
	                    if (postLoginScrn === 'PostLogin') {
	                        $("#" + screenID + "otpSecText_ul").addClass("sno");
	                        $("#" + screenID + "otptimertext_ul").addClass("sno");
	                        $("#" + screenID + "otpExpiredErrDiv").removeClass("sno");
	                        $("#" + screenID + "otpSubmitBtn").attr('disabled', true);
	                        $("#" + screenID + "otpExpiredMsg").addClass("sno");
	                    } else {
	                        $("#" + screenID + "otpSecText_ul").addClass("sno");
	                        $("#" + screenID + "otptimertext_ul").addClass("sno");
	                        $("#" + screenID + "dummyotptxt").addClass("sno");
	                        $("#" + screenID + "otpExpiredErrDiv").removeClass("sno");
	                        $("#" + screenID + "otpSubmitBtn").attr('disabled', true);
	                        $("#" + screenID + "otpExpiredMsg").addClass("sno");
	                    }
	                }
	            } else if (apz.childScr === 'Registration') {
	                if (window.otpRegenCount !== RegenCount) {
	                    $('#' + registrationScrId + 'resendText').attr("disabled", false);
	                    $('#' + registrationScrId + 'resendText').addClass("clr068");
	                    $("#" + registrationScrId + "otpExpiredMsgRow").removeClass('sno');
	                    //$("#" + screenID + "otpExpiredMsg").removeClass("sno");
	                    //$("#" + screenID + "otpSecText_ul").removeClass("sno");
	                    //$("#" + screenID + "otptimertext_ul").removeClass("sno");
	                    //$("#" + screenID + "otpExpiredErrDiv").addClass("sno");
	                    //$("#" + screenID + "dummyotptxt").removeClass("sno");
	                    //$("#" + screenID + "otpSubmitBtn").attr('disabled', false);
	                } else if (!ShowError) {
	                    window.ShowError = true;
	                    if (postLoginScrn === 'PostLogin') {
	                        //$("#" + screenID + "otpSecText_ul").addClass("sno");
	                        //$("#" + screenID + "otptimertext_ul").addClass("sno");
	                        //$("#" + screenID + "otpExpiredErrDiv").removeClass("sno");
	                        //$("#" + screenID + "otpSubmitBtn").attr('disabled', true);
	                        //$("#" + screenID + "otpExpiredMsg").addClass("sno");
	                    } else {
	                        //$("#" + screenID + "otpSecText_ul").addClass("sno");
	                        //$("#" + screenID + "otptimertext_ul").addClass("sno");
	                        //$("#" + screenID + "dummyotptxt").addClass("sno");
	                        //$("#" + screenID + "otpExpiredErrDiv").removeClass("sno");
	                        //$("#" + screenID + "otpSubmitBtn").attr('disabled', true);
	                        //$("#" + screenID + "otpExpiredMsg").addClass("sno");
	                    }
	                }
	            } else if (apz.childScr === 'ForgotPassword') {
	                if (window.otpRegenCount !== RegenCount) {
	                    $('#' + ForgotScrId + 'resendText').attr("disabled", false);
	                    $('#' + ForgotScrId + 'resendText').addClass("clr068");
	                    $("#" + ForgotScrId + "otpExpiredMsgRow").removeClass('sno');
	                    //$("#" + screenID + "otpExpiredMsg").removeClass("sno");
	                    //$("#" + screenID + "otpSecText_ul").removeClass("sno");
	                    //$("#" + screenID + "otptimertext_ul").removeClass("sno");
	                    //$("#" + screenID + "otpExpiredErrDiv").addClass("sno");
	                    //$("#" + screenID + "dummyotptxt").removeClass("sno");
	                    //$("#" + screenID + "otpSubmitBtn").attr('disabled', false);
	                }
	            } else if (apz.childScr === "GroupsData") {
	                apz.app.GroupsData.timerEnd();
	            } else if (apz.childScr === "EditGroupsData") {
	                apz.app.EditGroupsData.timerEnd();
	            } else if (apz.childScr === "RepeatCollScreen") {
	                apz.app.RepeatCollScreen.timerEnd();
	            } else {
	                if (window.otpRegenCount !== RegenCount) {
	                    $("#" + screenID + "Regenerateotp").removeClass("sno");
	                    $("#" + screenID + "Regenerateotp_ul").removeClass("sno");
	                    $("#" + screenID + "otpSecText_ul").removeClass("sno");
	                    $("#" + screenID + "otptimertext_ul").removeClass("sno");
	                    $("#" + screenID + "otpExpiredErrDiv").addClass("sno");
	                    $("#" + screenID + "expiryDIV").addClass("sno");
	                    $("#" + screenID + "dummyotptxt").removeClass("sno");
	                    $("#" + screenID + "otpSubmitBtn").attr('disabled', false);
	                    $("#" + screenID + "otpExpiredMsg").removeClass("sno");
	                } else if (!ShowError) {
	                    window.ShowError = true;
	                    if (postLoginScrn === 'PostLogin') {
	                        $("#" + screenID + "otpSecText_ul").addClass("sno");
	                        $("#" + screenID + "otptimertext_ul").addClass("sno");
	                        $("#" + screenID + "otpExpiredErrDiv").removeClass("sno");
	                        $("#" + screenID + "dummyotptxt").addClass("sno");
	                        $("#" + screenID + "otpSubmitBtn").attr('disabled', true);
	                        $("#" + screenID + "otpExpiredMsg").addClass("sno");
	                    } else {
	                        $("#" + screenID + "otpSecText_ul").addClass("sno");
	                        $("#" + screenID + "otptimertext_ul").addClass("sno");
	                        $("#" + screenID + "otpExpiredErrDiv").removeClass("sno");
	                        $("#" + screenID + "dummyotptxt").addClass("sno");
	                        $("#" + screenID + "otpSubmitBtn").attr('disabled', true);
	                        $("#" + screenID + "otpExpiredMsg").addClass("sno");
	                    }
	                }
	            }
	        },
	        HideShowPassword: function(eyeOpen, eyeClose, fieldId) {
	            if ($("#" + eyeClose).hasClass('sno')) {
	                $("#" + LoginScrId + "password").addClass("mask");
	                document.getElementById(fieldId).type = "password";
	                $("#" + eyeClose).removeClass('sno')
	                $("#" + eyeOpen).addClass('sno');
	            } else {
	                $("#" + LoginScrId + "password").removeClass("mask");
	                document.getElementById(fieldId).type = "text";
	                $("#" + eyeClose).addClass('sno')
	                $("#" + eyeOpen).removeClass('sno');
	            }
	        },
	        fetchCustomerIdDetails: function(customerId) {
	            apz.startLoader();
	            var req = {
	                "apiRequest": {
	                    "appId": gAppId,
	                    "interfaceName": "FetchLoanApplication",
	                    "userId": LoggedInUserDetails.userID,
	                    "requestObj": {
	                        "customerId": customerId,
	                        "versionNum": ""
	                    }
	                }
	            }
	            ApzCOB.serverBuildParam(gAppId, 'FetchLoanApplication', 'N', 'N', req, 'Y', ApzCOB.fetchCustomerIdDetailsCB);
	        },
	        fetchCustomerIdDetailsCB: function(params) {
	            var disburesedApp=[];
	            IncomeApp.completedAppList = [];
	            if (ApzCOB.handleServiceCallBacks(params)) {
	                if (!apz.isNull(params.res.APZCBO__FetchLoanApplication_Res.apiResponse.ResponseBody.responseObj)) {
	                    let custResp = params.res.APZCBO__FetchLoanApplication_Res.apiResponse.ResponseBody.responseObj;
	                    custResp = JSON.parse(custResp);
	                    if (Array.isArray(custResp.applicationdtls) && custResp.applicationdtls.length > 0) {
	                        let tempArray = custResp.applicationdtls.filter(val => (val.applicationType !== "INCOMEASSESSMENT"));
	                        disburesedApp = tempArray.filter(val => (val.status.toUpperCase() == "DISBURSED"))
	                        if (viewCustomer) {
	                            tempArray = tempArray.filter(val => (val.status.toUpperCase() !== "REJECTED" && val.status.toUpperCase() !== "CANCELLED"));
	                        }else {
	                            tempArray = tempArray.filter(val => (val.status.toUpperCase() !== "DISBURSED" && val.status.toUpperCase() !== "REJECTED" && val.status
	                                .toUpperCase() !== "CANCELLED"))
	                           /*var configDays=2;
	                            if (disburesedApp.length > 0) {
	                                disburesedApp.sort((a, b) => {
	                                    const dateA = new Date(a.disbApiRes?.apiResTs || 0);
	                                    const dateB = new Date(b.disbApiRes?.apiResTs || 0);
	                                    return dateB - dateA; // latest first
	                                });
	                                if (Array.isArray(disburesedApp) && disburesedApp.length > 0) {
	                                    var first = disburesedApp[0];
	                                    var apiResTs = first.disbApiRes && first.disbApiRes.apiResTs;
	                                    if (apiResTs) {
	                                        var disbursedDate = new Date(apiResTs);
	                                        var today = new Date();
	                                        // Difference in days
	                                        var diffTime = today.getTime() - disbursedDate.getTime();
	                                        var diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
	                                        if (diffDays >= 0 && diffDays <= configDays) {
	                                            var seleProdArray = [];
	                                            if (KendraApp && KendraApp.ProductList && first && first.productCode) {
	                                                seleProdArray = KendraApp.ProductList.filter(function(val) {
	                                                    return val.productDtls && val.productDtls.shortDesc === first.productCode;
	                                                });
	                                            }
	                                            var loanType = (seleProdArray.length > 0 && seleProdArray[0].description) ? seleProdArray[0].description : first.productCode;
	                                            var loanAmt=first.amount;
	                                            // Format date as 10-Sep
	                                            var months = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
	                                            var disbDateFormatted = (("0" + disbursedDate.getDate()).slice(-2)) + "-" + months[disbursedDate.getMonth()];
	                                            var after2Days = new Date(disbursedDate.getTime() + (configDays * 24 * 60 * 60 * 1000));
	                                            var after2DaysFormatted = ("0" + after2Days.getDate()).slice(-2) + "-" + months[after2Days.getMonth()];
	                                            apz.stopLoader();
	                                            ApzCOB.fnDisplayMsg(loanType + " loan of Rs " + loanAmt + " is disbursed on " + disbDateFormatted + ". Please apply new loan application on " +
	                                                after2DaysFormatted + ".", "E");
	                                            return false;
	                                        }
	                                    }
	                                }
	                            }
	                            var activeLoan=KendraApp.selectedCustomer.loanDtls;
	                            if (Array.isArray(activeLoan) && activeLoan.length > 0) {
	                                var months = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
	                                var today = new Date();
	                                for (var i = 0; i < activeLoan.length; i++) {
	                                    var loan = activeLoan[i];
	                                    if (loan.lnValueDate) {
	                                        // lnValueDate format is "YYYYMMDD"
	                                        var year = parseInt(loan.lnValueDate.substring(0, 4), 10);
	                                        var month = parseInt(loan.lnValueDate.substring(4, 6), 10) - 1; // 0-based
	                                        var day = parseInt(loan.lnValueDate.substring(6, 8), 10);
	                                        var disbursedDate = new Date(year, month, day);
	                                        // Difference in days
	                                        var diffTime = today.getTime() - disbursedDate.getTime();
	                                        var diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
	                                        if (diffDays >= 0 && diffDays <= configDays) {
	                                            var disbDateFormatted = ("0" + disbursedDate.getDate()).slice(-2) + "-" + months[disbursedDate.getMonth()];
	                                            var after2Days = new Date(disbursedDate.getTime() + (configDays * 24 * 60 * 60 * 1000));
	                                            var after2DaysFormatted = ("0" + after2Days.getDate()).slice(-2) + "-" + months[after2Days.getMonth()];
	                                            var seleProdArray = [];
	                                            if (KendraApp && KendraApp.ProductList && loan && loan.product) {
	                                                seleProdArray = KendraApp.ProductList.filter(function(val) {
	                                                    return val.productDtls && val.productDtls.productId === loan.product;
	                                                });
	                                            }
	                                            var loanType = (seleProdArray.length > 0 && seleProdArray[0].description) ? seleProdArray[0].description : first.productCode;
	                                            var loanAmt = loan.amount;
	                                            ApzCOB.fnDisplayMsg(loanType + " loan of Rs " + loanAmt + " is disbursed on " + disbDateFormatted + ". Please apply new loan application on " +
	                                                after2DaysFormatted + ".", "E");
	                                        }
	                                    }
	                                }
	                            }*/
	                            
	                           if (LOANLIMIT?.Disbursed?.isCheck === true) {
	                               var configDays = LOANLIMIT?.Disbursed?.configDays;
	                               var months = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
	                               var today = new Date();
	                               // 1 First disbursed loan
	                               if (Array.isArray(disburesedApp) && disburesedApp.length > 0) {
	                                   var firstLoan = disburesedApp[0];
	                                   if (firstLoan.disbApiRes && firstLoan.disbApiRes.apiResTs) {
	                                       var disbDate = new Date(firstLoan.disbApiRes.apiResTs);
	                                       var diffDays = Math.floor((today - disbDate) / (1000 * 60 * 60 * 24));
	                                       if (diffDays >= 0 && diffDays < configDays) {
	                                           var disbDateFormatted = ("0" + disbDate.getDate()).slice(-2) + "-" + months[disbDate.getMonth()];
	                                           var afterDate = new Date(disbDate.getTime() + configDays * 24 * 60 * 60 * 1000);
	                                           var afterDateFormatted = ("0" + afterDate.getDate()).slice(-2) + "-" + months[afterDate.getMonth()];
	                                           var selectedloanType = (KendraApp.ProductList || []).filter(function(p) {
	                                               return p.productDtls && p.productDtls.shortDesc === firstLoan.productCode;
	                                           })[0];
	                                           var loanType = selectedloanType.productDtls
	                                           loanType = loanType ? loanType.description : firstLoan.productCode;
	                                           var loanAmt = ApzCOB.fn_FormatAmount(firstLoan.amount);
	                                           apz.stopLoader();
	                                           ApzCOB.fnDisplayMsg(loanType + " of Rs " + loanAmt + " is disbursed on " + disbDateFormatted +
	                                               ". Please apply new loan application on " + afterDateFormatted + ".", "E");
	                                           return false;
	                                       }
	                                   }
	                               }
	                               // 2 All active loans
	                               var activeLoans = KendraApp.selectedCustomer.loanDtls || [];
	                               for (var i = 0; i < activeLoans.length; i++) {
	                                   var loan = activeLoans[i];
	                                   if (!loan.lnValueDate) continue;
	                                   var year = parseInt(loan.lnValueDate.substr(0, 4), 10);
	                                   var month = parseInt(loan.lnValueDate.substr(4, 2), 10) - 1;
	                                   var day = parseInt(loan.lnValueDate.substr(6, 2), 10);
	                                   var disbDate = new Date(year, month, day);
	                                   var diffDays = Math.floor((today - disbDate) / (1000 * 60 * 60 * 24));
	                                   if (diffDays >= 0 && diffDays < configDays) {
	                                       var disbDateFormatted = ("0" + disbDate.getDate()).slice(-2) + "-" + months[disbDate.getMonth()];
	                                       var afterDate = new Date(disbDate.getTime() + configDays * 24 * 60 * 60 * 1000);
	                                       var afterDateFormatted = ("0" + afterDate.getDate()).slice(-2) + "-" + months[afterDate.getMonth()];
	                                       var selectedloanType = (KendraApp.ProductList || []).filter(function(p) {
	                                           return p.productDtls && p.productDtls.productId === loan.product;
	                                       })[0];
	                                       var loanType = selectedloanType.productDtls
	                                       loanType = loanType ? loanType.description : loan.product;
	                                       var loanAmt = ApzCOB.fn_FormatAmount(loan.amount);
	                                       apz.stopLoader();
	                                       ApzCOB.fnDisplayMsg(loanType + " of Rs " + loanAmt + " is disbursed on " + disbDateFormatted + ". Please apply new loan application on " +
	                                           afterDateFormatted + ".", "E");
	                                       return false;
	                                   }
	                               }
	                           }
	                           
	                        }
	                         
	                        IncomeApp.assessmentStage = '';
	                        IncomeApp.existingAppList = custResp.applicationdtls.filter(val => (val.applicationType == "INCOMEASSESSMENT"));
	                        if (IncomeApp.existingAppList.length > 0) {
	                            IncomeApp.completedAppList = IncomeApp.existingAppList.filter(val => (val.status.toUpperCase() == "APPROVED" ||
	                                val.status.toUpperCase() == "PENDINGBYRPC" || val.status.toUpperCase() == "MOVE TO CHECKER" || val
	                                .status.toUpperCase() == "ON HOLD"));
	                            if (IncomeApp.completedAppList.length > 0) {
	                                if (IncomeApp.completedAppList[0].status === "APPROVED") {
	                                    IncomeApp.assessmentStage = 'APPROVED';
	                                } else {
	                                    IncomeApp.assessmentStage = 'PENDINGBYRPC';
	                                }
	                            } else {
	                                IncomeApp.assessmentStage = 'PENDING';
	                                //apz.app.NewLoanApplication.selectLoanContinueFn();
	                            }
	                        } else {
	                            IncomeApp.assessmentStage = 'NEW';
	                            IncomeApp.isUpdaterequired = true;
	                        }
	                        IncomeApp.incompleteExistingList = [];
	                        if (IncomeApp.completedAppList.length > 0 && tempArray.length > 0) {
	                            IncomeApp.incompleteExistingList = IncomeApp.completedAppList.filter(val => (val.status !== "APPROVED"));
	                            /*if (IncomeApp.incompleteExistingList.length > 0) {
	                                apz.stopLoader();
	                                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_PENDINGBYRPC_ERROR_MSG"), "E");
	                                return false;
	                            }*/
	                        }
	                        if (tempArray.length > 0) {
	                            if (viewCustomer) {
	                                tempArray = tempArray.filter(val => (val.status.toUpperCase() !== "REJECTED"));
	                            } else {
	                                tempArray = tempArray.filter(val => (val.status.toUpperCase() !== "DISBURSED" && val.status.toUpperCase() !== "REJECTED"));
	                            }
	                            if (tempArray.length > 0) {
	                                let loanArray = KendraApp.ProductList.filter(val => (val.productDtls.shortDesc === tempArray[tempArray
	                                    .length - 1].productType));
	                                // if (tempArray[0] && tempArray[0].status === 'INITIATE') {
	                                //     ApzCOB.fnDisplayMsg("Loan application of " + loanArray[0].productDtls.description + " of amount " +
	                                //         tempArray[tempArray.length - 1].amount +
	                                //         " is pending in CRT screen. Kindly process from pending stage", "E");
	                                //     return false;
	                                // }
	                                /*if (loanArray.length > 0) {
	                                    //var stage= tempArray[tempArray.length - 1].currentStage;
	                                    let msgBuild = "Loan application of " + loanArray[0].productDtls.description + " of amount " + tempArray[
	                                            tempArray.length - 1].amount + " already existed  in " + "Sanction/Disbursed stage" +
	                                        ". Kindly process the existed loan.";
	                                    ApzCOB.fnDisplayMsg(msgBuild, "E");
	                                } else {
	                                    apz.app.NewLoanApplication.selectLoanContinueFn();
	                                }*/
	                                if (window.isgetIncome) {
	                                    var incomeAppData = '';
	                                    window.isgetIncome = false;
	                                    IncomeApp.completedAppList.forEach(function(k, i) {
	                                        if (window.isDraftFromAllLoan) {
							var incomeAppId
							if (typeof custData.addInfo === "string") {
								incomeAppId = JSON.parse(custData.addInfo).incomeAppId
							}else{
								incomeAppId = custData.addInfo.incomeAppId
							}
	                                            if (k.applicationId === incomeAppId) {
	                                                incomeAppData = k
	                                            }
	                                        } else {
	                                            if (k.applicationId === JSON.parse(window.isgetIncomeData.matchingCustomer.addInfo)
	                                                .incomeAppId) {
	                                                incomeAppData = k
	                                                //window.isgetIncomeData
	                                            }
	                                        }
	                                    })
	                                    IncomeApp = {};
	                                    IncomeApp.flow = 'fromDraft'
	                                    window.IncomeApp.payLoad = incomeAppData;
	                                    IncomeApp.status = incomeAppData.status;
	                                    IncomeApp.applicationId = incomeAppData.applicationId;
	                                    IncomeApp.payLoad.earnings = KendraApp.currentLoanAppRequest.applicationdtls.customerDtls.earnings;
	                                    IncomeApp.payLoad.income = KendraApp.currentLoanAppRequest.applicationdtls.customerDtls.income;
	                                    //IncomeApp = incomeAppData
	                                    if (isDraftFromNewLoan) {
											if(isApplyingLoanFromKendraDetails){
												isApplyingLoanFromKendraDetails = false;
												apz.app.KendraDetails.selectLoanContinueFn(window.isgetIncomeData);
											}else{
												apz.app.NewLoanApplication.selectLoanContinueFn(window.isgetIncomeData);
											}
	                                    } else if (isDraftFromAllLoan) {
	                                        apz.app.AllLoanApplication.selectLoanContinueFn();
	                                    }
	                                } else {
	                                    ApzCOB.fetchLoanApplicationNew(tempArray);
	                                }
	                                //ApzCOB.fetchLoanApplicationNew(tempArray);
	                            } else {
									if(isApplyingLoanFromKendraDetails || isViewCustomerFromKendraDetails){
										isApplyingLoanFromKendraDetails = false;
										isViewCustomerFromKendraDetails = false;
										apz.app.KendraDetails.selectLoanContinueFn();
									}else{
										apz.app.NewLoanApplication.selectLoanContinueFn();
									}
	                            }
	                        } else {
	                            if(isApplyingLoanFromKendraDetails || isViewCustomerFromKendraDetails){
									isApplyingLoanFromKendraDetails = false;
									isViewCustomerFromKendraDetails = false;
									apz.app.KendraDetails.selectLoanContinueFn();
								}else{
									apz.app.NewLoanApplication.selectLoanContinueFn();
								}
	                        }
	                    } else {
	                        if(isApplyingLoanFromKendraDetails || isViewCustomerFromKendraDetails){
								isApplyingLoanFromKendraDetails = false;
								isViewCustomerFromKendraDetails = false;
								apz.app.KendraDetails.selectLoanContinueFn();
							}else{
								apz.app.NewLoanApplication.selectLoanContinueFn();
							}
	                    }
	                } else {
	                    apz.stopLoader();
	                    ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                }
	            } else {
	                apz.stopLoader();
	                if (params.res.APZCBO__FetchLoanApplication_Res.apiResponse.ResponseHeader.ResponseCode === "NR100") {
	                    if (typeof apz.app.NewLoanApplication.selectLoanContinueFn === 'function' ||typeof apz.app.KendraDetails.selectLoanContinueFn === 'function') {
	                        if(isApplyingLoanFromKendraDetails || isViewCustomerFromKendraDetails){
								isApplyingLoanFromKendraDetails = false;
								isViewCustomerFromKendraDetails = false;
								apz.app.KendraDetails.selectLoanContinueFn();
							}else{
								apz.app.NewLoanApplication.selectLoanContinueFn();
							}
	                    } else {
	                        let selectedData = {};
	                        selectedData.scr = 'DashboardSearch'
	                        selectedData.childScrId = apz.currAppId;
							if(isKendraDtlsToCustomerDtls){
								isKendraDtlsToCustomerDtls = false;
								selectedData.scr = apz.childScr;
								selectedData.childScrId = apz.currAppId;
								ApzCOB.launchMicroApp('Custom', 'CustomerDetails', 'APZCBO__BaseScreens__BaseDIV', selectedData);
							}else{
								ApzCOB.launchMicroApp('Custom', 'CustomerDetails', 'APZCBO__BaseScreens__BaseDIV', selectedData);
							}
	                    }
	                } else {
	                    ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                }
	            }
	        },
	        base64toSavefile: function(base64, fileName, report) {
	            if (base64.length <= 1000) {
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_INVALID_REPORT_MSG"), "E");
	            } else {
	                reportName = report;
	                var json = {};
	                json.id = "BASE64TOFILE";
	                //  json.callBack = apz.app.dashboard.base64tofilecallBack;
	                json.base64 = base64;
	                //AmitChange for PDF to HTML
	                //json.fileName = fileName + ".pdf";
	                if (fileName.includes('CB_Report')) {
	                    json.fileName = fileName + ".pdf";
	                } else {
	                    json.fileName = fileName + ".html";
	                }
	                if (apz.deviceOs === "iOS") {
	                    var json = {};
	                    json.id = "BASE64TOFILE";
	                    json.callBack = ApzCOB.base64toSavefileCB;
	                    json.base64 = base64;
	                    // AMit CHnage for PDF To hTML
	                    json.fileName = fileName + ".html";
	                    //json.fileName = fileName + ".pdf";
	                    json.filePath = "docs";
	                    apz.ns.base64ToFile(json);
	                } else {
	                    json.callBack = ApzCOB.base64toSavefileCB;
	                    json.filePath = "";
	                    json.saveInDownloads = true;
	                }
	                if (apz.deviceOs !== "iOS") {
	                    apz.ns.base64ToFile(json);
	                }
	            }
	        },
	        base64toSavefileCB: function(params) {
	            var msg = "The " + reportName + " has been saved successfully!!";
	            ApzCOB.fnDisplayMsg(msg, "I");
	        },
	        dashboardAppListAPInew: function() {
	            apz.startLoader();
	            var keyValue = '';
	            if (window.userRole == 'BM') {
	                keyValue = LoggedInUserDetails.loginResponse.addInfo2;
	            } else {
	                keyValue = LoggedInUserDetails.userID;
	            }
	            var req = {
	                "apiRequest": {
	                    "appId": gAppId,
	                    "interfaceName": "DashboardAppListAPI1",
	                    // "kmId": window.LoggedInUserDetails.kmId,
	                    "kmId": keyValue,
	                    "requestObj": {}
	                }
	            }
	            ApzCOB.serverBuildParam(gAppId, 'DashboardAppListAPI1', 'N', 'N', req, 'Y', ApzCOB.dashboardAppListAPInewCB);
	        },
	        dashboardAppListAPInewCB: function(params) {
	            if (ApzCOB.handleServiceCallBacks(params)) {
	                if (!apz.isNull(params.res.APZCBO__DashboardAppListAPI1_Res.apiResponse.ResponseBody.responseObj)) {
	                    // to-do 
	                    dashboardAppList.response = JSON.parse(params.res.APZCBO__DashboardAppListAPI1_Res.apiResponse.ResponseBody.responseObj);
	                    ApzCOB.updatewidgetApplications();
	                    //ApzCOB.customlogincallback();
	                    // ApzCOB.fetchSRRequestList();
	                } else {
	                    dashboardAppList.response = {};
	                    //ApzCOB.customlogincallback();
	                    A //pzCOB.fetchSRRequestList();
	                    // ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E", ApzCOB.ReloadApp);
	                }
	            } else {
	                dashboardAppList.response = {};
	                //ApzCOB.customlogincallback();
	                // ApzCOB.fetchSRRequestList();
	                //ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E", ApzCOB.ReloadApp);
	            }
	            apz.stopLoader();
	        },
	        updatewidgetApplications: function(params) {
	            /*loansanctionList = [];
	            if (dashboardAppList.response.length > 0) {
	                var data = JSON.stringify(dashboardAppList.response)
	                var loanData = JSON.parse(data); //data.customerDtls;
	                loanData.forEach(function(k, i) {
	                    //k.loanAmt=k.amount;
	                    if (k.applicationType !== 'INCOMEASSESSMENT') {
	                        k.loanAmt = ApzCOB.fn_FormatAmount(k.amount);
	                        k.productType = k.productCode;
	                        if (k.wfStatus === 'SANCTIONINPROGRESS') {
	                            if ((window.userRole == 'KM') || (window.userRole == 'BM' && isSelfAssigned)) {
	                                k.status = 'Pending By BM';
	                            } else {
	                                k.status = 'Pending';
	                            }
	                            loansanctionList.push(k);
	                        } else if (k.wfStatus === 'INITDISBURSE') {
	                            k.status = 'Sanctioned';
	                            loansanctionList.push(k);
	                        } else if (k.wfStatus === 'SANCTIONREJECT') {
	                            k.status = 'Rejected';
	                            loansanctionList.push(k);
	                        }
	                    }
	                })
	            }
	            disbursementList = [];
	            if (dashboardAppList.response.length > 0) {
	                var data = JSON.stringify(dashboardAppList.response);
	                var disbursementData = JSON.parse(data);
	                disbursementData.forEach(function(k, i) {
	                    if (k.applicationType !== 'INCOMEASSESSMENT') {
	                        k.loanAmt = ApzCOB.fn_FormatAmount(k.amount);
	                        k.productType = k.productCode;
	                        if (k.applicationStatus == "DISBURSED") {
	                            k.status = 'Disbursed';
	                            disbursementList.push(k);
	                        } else {
	                            if (k.wfStatus === 'INITDISBURSE' && (userRole == 'KM' || (window.userRole == 'BM' && isSelfAssigned))) {
	                                k.status = 'Move to BM';
	                                disbursementList.push(k);
	                            } else if (k.wfStatus === 'DISBURSEINPROGRESS') {
	                                if (userRole == 'KM' || (window.userRole == 'BM' && isSelfAssigned)) {
	                                    k.status = 'Pending by BM';
	                                } else {
	                                    k.status = 'Pending';
	                                }
	                                disbursementList.push(k);
	                            } else if (k.wfStatus === 'DISBURSED') {
	                                k.status = 'Disbursed';
	                                disbursementList.push(k);
	                            } else if (k.wfStatus === 'DISBURSEDREJECT') {
	                                k.status = 'DisbursedReject';
	                                disbursementList.push(k);
	                            }
	                        }
	                    }
	                })
	            }
	            ApzCOB.launchMicroApp('LoanSa', 'LoanSanction', 'APZCBO__BaseScreens__BaseDIV', loansanctionList);*/
	            loansanctionList = [];
	            if (dashboardAppList.response.length > 0) {
	                var data = JSON.stringify(dashboardAppList.response)
	                var loanData = JSON.parse(data); //data.customerDtls;
	                loanData.forEach(function(k, i) {
	                    //k.loanAmt=k.amount;
	                    if (k.applicationType !== 'INCOMEASSESSMENT') {
	                        k.loanAmt = ApzCOB.fn_FormatAmount(k.amount);
	                        k.productType = k.productCode;
	                        var selectedApproval=ApzCOB.fetchApprovallevel(k);
	                        k.loanApproval=selectedApproval;
	                        if (k.wfStatus === 'SANCTIONINPROGRESS') {
	                            if (!k.loanApproval.isRecommand) {
	                                if ((window.userRole == 'KM') || (window.userRole == 'BM' && isSelfAssigned)) {
	                                    k.status = 'Pending By BM';
	                                } else {
	                                    k.status = 'Pending';
	                                }
	                            } else {
	                                if (k.loanApproval.RecommandRoleList.length != 0) {
	                                    k.loanApproval.RecommandRoleList.forEach(function(el, i) {
	                                        if ((window.userRole == 'KM') || (window.userRole == 'BM' && isSelfAssigned)) {
	                                            k.status = 'Pending By '+k.loanApproval.SanctionRoleList[0];
	                                        } else if (window.userRole == el) {
	                                            k.status = 'Pending Recommendation';
	                                        }
	                                    });
	                                }
	                            }
	                            loansanctionList.push(k);
	                        } else if (k.wfStatus === 'APPROVALINPROGRESS') {
	                            if (k.loanApproval.SanctionRoleList.length != 0) {
	                                k.loanApproval.SanctionRoleList.forEach(function(ele, i) {
	                                    if ((window.userRole == 'KM') || (window.userRole == 'BM' && isSelfAssigned)) {
	                                        k.status = 'Pending By ' + k.loanApproval.SanctionRoleList[0];
	                                    } else if (window.userRole == el) {
	                                        k.status = 'Pending';
	                                    }
	                                });
	                            }
	                            if (k.loanApproval.RecommandRoleList.length != 0) {
	                                k.loanApproval.RecommandRoleList.forEach(function(el, i) {
	                                    if (window.userRole == el) {
	                                        k.status = 'Recommended';
	                                    }
	                                });
	                            }
	                            loansanctionList.push(k);
	                        }else if (k.wfStatus === 'INITDISBURSE') {
	                            k.status = 'Sanctioned';
	                            loansanctionList.push(k);
	                        } else if (k.wfStatus === 'SANCTIONREJECT') {
	                            k.status = 'Rejected';
	                            loansanctionList.push(k);
	                        }
	                    }
	                })
	            }
	            disbursementList = [];
	            if (dashboardAppList.response.length > 0) {
	                var data = JSON.stringify(dashboardAppList.response);
	                var disbursementData = JSON.parse(data);
	                disbursementData.forEach(function(k, i) {
	                    if (k.applicationType !== 'INCOMEASSESSMENT') {
	                        k.loanAmt = ApzCOB.fn_FormatAmount(k.amount);
	                        k.productType = k.productCode;
	                        if (k.applicationStatus == "DISBURSED") {
	                            k.status = 'Disbursed';
	                            disbursementList.push(k);
	                        } else {
	                            if (k.wfStatus === 'INITDISBURSE' && (userRole == 'KM' || (window.userRole == 'BM' && isSelfAssigned))) {
	                                k.status = 'Move to BM';
	                                disbursementList.push(k);
	                            } else if (k.wfStatus === 'DISBURSEINPROGRESS') {
	                                if (userRole == 'KM' || (window.userRole == 'BM' && isSelfAssigned)) {
	                                    k.status = 'Pending by BM';
	                                } else {
	                                    k.status = 'Pending';
	                                }
	                                disbursementList.push(k);
	                            } else if (k.wfStatus === 'DISBURSED') {
	                                k.status = 'Disbursed';
	                                disbursementList.push(k);
	                            } else if (k.wfStatus === 'DISBURSEDREJECT') {
	                                k.status = 'DisbursedReject';
	                                disbursementList.push(k);
	                            }
	                        }
	                    }
	                })
	            }
	            ApzCOB.launchMicroApp('LoanSa', 'LoanSanction', 'APZCBO__BaseScreens__BaseDIV', loansanctionList);
	        },
	        calculateAge: function(birthDate) {
	            const today = new Date();
	            const birthDateObj = new Date(birthDate);
	            let age = today.getFullYear() - birthDateObj.getFullYear();
	            const monthDifference = today.getMonth() - birthDateObj.getMonth();
	            // Adjust age if birthday has not yet occurred this year
	            if (monthDifference < 0 || (monthDifference === 0 && today.getDate() < birthDateObj.getDate())) {
	                age--;
	            }
	            return age;
	        },
	        sortArrayByKey: function(arr, key, order = 'asc') {
	            return arr.sort(function(a, b) {
	                let valA = a[key];
	                let valB = b[key];
	                if (key === 'incCreateTs') {
	                    valA = new Date(valA);
	                    valB = new Date(valB);
	                }
	                if (valA < valB) {
	                    return order === 'asc' ? -1 : 1;
	                }
	                if (valA > valB) {
	                    return order === 'asc' ? 1 : -1;
	                }
	                return 0;
	            });
	        },
	        formatTableDate: function(inputDate) {
	            // Parse the input date string
	            const [datePart, timePart] = inputDate.split(', ');
	            const [day, month, year] = datePart.split('/').map(Number);
	            const [time, period] = timePart.split(' ');
	            let [hours, minutes, seconds] = time.split(':').map(Number);
	            // Convert to 24-hour format
	            if (period.toLowerCase() === 'pm' && hours < 12) {
	                hours += 12;
	            }
	            if (period.toLowerCase() === 'am' && hours === 12) {
	                hours = 0;
	            }
	            // Format the year to last two digits
	            const shortYear = year.toString().slice(-2);
	            // Format the final output
	            return `${day.toString().padStart(2, '0')}/${month.toString().padStart(2, '0')}/${shortYear} ${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;
	        },
	        fetchIncomeDetails: function(selectedapp) {
	            let applicationId, versionNum;
	            if (window.isUpdateIncome) {
	                applicationId = '';
	                versionNum = '';
	            } else {
	                applicationId = selectedapp.applicationId ?? '';
	                versionNum = selectedapp.versionNo ?? selectedapp.latestVersionNo;
	            }
	            var req = {
	                "apiRequest": {
	                    "appId": gAppId,
	                    "interfaceName": "FetchIncomeDetails",
	                    "userId": LoggedInUserDetails.userID,
	                    "requestObj": {
	                        "applicationId": applicationId,
	                        "versionNum": versionNum,
	                        "memberId": KendraApp.currentLoanAppRequest.applicationdtls.customerId ?? '-'
	                    }
	                }
	            }
	            ApzCOB.serverBuildParam(gAppId, 'FetchIncomeDetails', 'N', 'N', req, 'Y', ApzCOB.fetchIncomeDetailsCB);
	        },
	        fetchIncomeDetailsCB: function(params) {
	            console.log(params);
	            apz.stopLoader();
	            if (ApzCOB.handleServiceCallBacks(params)) {
	                if (!apz.isNull(params.res.APZCBO__FetchIncomeDetails_Res.apiResponse.ResponseBody.responseObj)) {
	                    window.KendraLoans.custFetchLoanAppRes = params.res.APZCBO__FetchIncomeDetails_Res.apiResponse.ResponseBody.responseObj;
	                    //selectedRowDetails = JSON.parse(window.KendraLoans.custFetchLoanAppRes);
	                    if (window.isUpdateIncome) {
	                        if (window.KendraLoans.custFetchLoanAppRes != '[]') {
	                            window.houseHoldDetails = JSON.parse(JSON.parse(window.KendraLoans.custFetchLoanAppRes)[0].payload)
	                                .houseHoldDetails;
	                        }
	                        apz.app.AddLoanDetails.IncomeDetailsUpdate()
	                    } else {
	                        ApzCOB.launchMicroApp("RPCMEM", "EarningMemberDetails", "APZCBO__BaseScreens__BaseDIV", rpcdata);
	                    }
	                } else {
	                    apz.stopLoader();
	                    ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                }
	            } else {
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	            }
	            apz.stopLoader();
	        },
	        deleteApplicationRequest: function() {
	            let reqObj = {
	                "apiRequest": {
	                    "appId": apz.appId,
	                    "interfaceId": "DeleteApplication",
	                    "userId": LoggedInUserDetails.userID,
	                    "requestObj": {
	                        "applicationId": selectedAppList[selectedAppList.length - 1].applicationId
	                    }
	                }
	            }
	            ApzCOB.serverBuildParam(gAppId, "DeleteApplication", "N", "N", reqObj, false, ApzCOB.deleteApplicationRequestCB);
	        },
	        deleteApplicationRequestCB: function(params) {
	            try {
	                if (params.status && apz.isNull(params.errors)) {
	                    if (params.res.APZCBO__DeleteApplication_Res.apiResponse.ResponseHeader.hasOwnProperty("ResponseCode")) {
	                        if (params.res.APZCBO__DeleteApplication_Res.apiResponse.ResponseHeader.ResponseCode === "0") {
	                            apz.app.NewLoanApplication.selectLoanContinueFn();
	                        }
	                    }
	                }
	            } catch (e) {
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	            }
	        },
	        fetchCustomerIdDetailsNew: function(customerId) {
	            apz.startLoader();
	            var req = {
	                "apiRequest": {
	                    "appId": gAppId,
	                    "interfaceName": "FetchLoanApplicationNew",
	                    "userId": LoggedInUserDetails.userID,
	                    "requestObj": {
	                        "customerId": customerId,
	                        "versionNum": ""
	                    }
	                }
	            }
	            ApzCOB.serverBuildParam(gAppId, 'FetchLoanApplicationNew', 'N', 'N', req, 'Y', ApzCOB.fetchCustomerIdDetailsNewCB);
	        },
	        fetchCustomerIdDetailsNewCB: function(params) {
	            apz.stopLoader();
	            if (ApzCOB.handleServiceCallBacks(params)) {
	                if (!apz.isNull(params.res.APZCBO__FetchLoanApplicationNew_Res.apiResponse.ResponseBody.responseObj)) {
	                    let custResp = params.res.APZCBO__FetchLoanApplicationNew_Res.apiResponse.ResponseBody.responseObj;
	                    custResp = JSON.parse(custResp);
	                    if (custResp.hasOwnProperty("applicationdtls") && custResp.applicationdtls.length > 0) {
	                        let tempArray = custResp.applicationdtls.filter(val => (val.applicationType !== "INCOMEASSESSMENT"));
	                        tempArray = tempArray.filter(val => (val.status.toUpperCase() !== "DISBURSED" && val.status.toUpperCase() !==
	                            "REJECTED" && val.status.toUpperCase() !== "CANCELLED"));
	                        IncomeApp.assessmentStage = '';
	                        IncomeApp.existingAppList = custResp.applicationdtls.filter(val => (val.applicationType == "INCOMEASSESSMENT"));
	                        if (IncomeApp.existingAppList.length > 0) {
	                            IncomeApp.completedAppList = tempArray.filter(val => (val.status.toUpperCase() == "APPROVED" || val.status
	                                .toUpperCase() !== "PENDINGBYRPC"));
	                            if (IncomeApp.completedAppList.length > 0) {
	                                if (IncomeApp.completedAppList[0].status === "APPROVED") {
	                                    IncomeApp.assessmentStage = 'APPROVED';
	                                } else {
	                                    IncomeApp.assessmentStage = 'PENDINGBYRPC';
	                                }
	                            } else {
	                                IncomeApp.assessmentStage = 'PENDING';
	                                //apz.app.NewLoanApplication.selectLoanContinueFn();
	                            }
	                        } else {
	                            IncomeApp.assessmentStage = 'NEW';
	                            IncomeApp.isUpdaterequired = true;
	                        }
	                        if (IncomeApp.existingAppList.length > 0 && tempArray.length > 0) {
	                            IncomeApp.incompleteExistingList = IncomeApp.existingAppList.filter(val => (val.status !== "APPROVED"));
	                            if (IncomeApp.incompleteExistingList.length > 0) {
	                                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_PENDINGBYRPC_ERROR_MSG"), "E");
	                                return false;
	                            }
	                        }
	                        if (tempArray.length > 0) {
	                            tempArray = tempArray.filter(val => (val.status.toUpperCase() !== "DISBURSED" && val.status.toUpperCase() !==
	                                "REJECTED"));
	                            if (tempArray.length > 0) {
	                                let loanArray = KendraApp.ProductList.filter(val => (val.productDtls.shortDesc === tempArray[tempArray
	                                    .length - 1].productType));
	                                // if (tempArray[0] && tempArray[0].status === 'INITIATE') {
	                                //     ApzCOB.fnDisplayMsg("Loan application of " + loanArray[0].productDtls.description + " of amount " +
	                                //         tempArray[tempArray.length - 1].amount +
	                                //         " is pending in CRT screen. Kindly process from pending stage", "E");
	                                //     return false;
	                                // }
	                                if (loanArray.length > 0) {
	                                    //var stage= tempArray[tempArray.length - 1].currentStage;
	                                    let msgBuild = "Loan application of " + loanArray[0].productDtls.description + " of amount " + tempArray[
	                                            tempArray.length - 1].amount + " already existed  in " + "Sanction/Disbursed stage" +
	                                        ". Kindly process the existed loan.";
	                                    ApzCOB.fnDisplayMsg(msgBuild, "E");
	                                } else {
	                                    apz.app.NewLoanApplication.selectLoanContinueFn();
	                                }
	                            } else {
	                                apz.app.NewLoanApplication.selectLoanContinueFn();
	                            }
	                        } else {
	                            apz.app.NewLoanApplication.selectLoanContinueFn();
	                        }
	                    } else {
	                        apz.app.NewLoanApplication.selectLoanContinueFn();
	                    }
	                } else {
	                    apz.stopLoader();
	                    ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                }
	            } else {
	                apz.stopLoader();
	                if (params.res.APZCBO__FetchLoanApplication_Res.apiResponse.ResponseHeader.ResponseCode === "NR100") {
	                    apz.app.NewLoanApplication.selectLoanContinueFn();
	                } else {
	                    ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                }
	            }
	        },
	        fetchLoanApplicationNew: function(pselectedList) {
	            selectedAppList = pselectedList;
	            apz.startLoader();
	            var req = {
	                "apiRequest": {
	                    "appId": gAppId,
	                    "interfaceName": "FetchLoanApplication",
	                    "userId": LoggedInUserDetails.userID,
	                    "requestObj": {
	                        "applicationId": selectedAppList[selectedAppList.length - 1].applicationId,
	                        "versionNum": selectedAppList[selectedAppList.length - 1].versionNo ?? selectedAppList[selectedAppList.length -
	                            1].latestVersionNo
	                    }
	                }
	            }
	            ApzCOB.serverBuildParam(gAppId, 'FetchLoanApplication', 'N', 'N', req, 'Y', ApzCOB.fetchLoanApplicationNewCB);
	        },
	        fetchLoanApplicationNewCB: function(params) {
	            //  console.log(params);
	            try {
	                isexsitingApp = false;
	                if (ApzCOB.handleServiceCallBacks(params)) {
	                    if (!apz.isNull(params.res.APZCBO__FetchLoanApplication_Res.apiResponse.ResponseBody.responseObj)) {
	                        var custFetchLoanAppRes = params.res.APZCBO__FetchLoanApplication_Res.apiResponse.ResponseBody.responseObj;
	                        custFetchLoanAppRes = JSON.parse(custFetchLoanAppRes);
	                        //window.KendraLoans.cbResponse = JSON.parse(custFetchLoanAppRes.cbResponse.resPayload);
	                        var currentStage = '';
	                        var isPendingRPC = false;
	                        var addinfoCust = JSON.parse(custFetchLoanAppRes.applicationdtls[0].addInfo)
	                        IncomeApp.completedAppList.forEach(function(m, n) {
	                            if (addinfoCust.incomeAppId == m.applicationId) {
	                                if (m.status == 'PENDINGBYRPC' || m.status == 'MOVE TO CHECKER' || m.status == 'ON HOLD') {
	                                    isPendingRPC = true;
	                                    currentStage = m.status;
	                                    isexsitingApp = false;
	                                }
	                            }
	                        });
	                        if (apz.isNull(custFetchLoanAppRes.applnWfDefinitionList) || custFetchLoanAppRes.applnWfDefinitionList.length == 0) {
	                            custFetchLoanAppRes.applnWfDefinitionList = '';
	                        }
	                        if (apz.isNull(custFetchLoanAppRes.cbResponse) || custFetchLoanAppRes.cbResponse.length == 0) {
	                            custFetchLoanAppRes.cbResponse = '';
	                        }
	                        if (apz.isNull(custFetchLoanAppRes.cbResponse) && !isPendingRPC) {
	                            if (viewCustomer) {
									var obj;
									if(isKendraDtlsToCustomerDtls){
										isKendraDtlsToCustomerDtls = false;
										obj={
											'scr':apz.childScr,
											'childScrId':apz.currAppId
										}
									}else{
										obj=''
									}
	                                ApzCOB.launchMicroApp("Custom", "CustomerDetails", "APZCBO__BaseScreens__BaseDIV", obj);
	                            } else {
	                                //ApzCOB.rejectRequest('INPUT')
	                                //ApzCOB.deleteApplicationRequest()
	                                //ApzCOB.fnDisplayMsg("Application exists in Draft stage. Kindly process the existing draft loan.", "E");
	                                window.isDraftFromNewLoan = true;
	                                ApzCOB.fetchLoanApplication(custFetchLoanAppRes.applicationdtls[0], 'NewLoanApplication')
	                                //apz.app.LoanApplicationPending.resumeDraftApp(custFetchLoanAppRes.applicationdtls[0].customerId)
	                                //apz.stopLoader();
	                                return
	                            }
	                        } else {
	                            let loanArray = KendraApp.ProductList.filter(val => (val.productDtls.shortDesc === selectedAppList[
	                                selectedAppList.length - 1].productType));
	                            if (loanArray.length > 0) {
	                                let msgBuild = "Loan application of " + loanArray[0].productDtls.description + " of amount " +
	                                    selectedAppList[selectedAppList.length - 1].amount + " already existed  in " +
	                                    "Sanction/Disbursed stage" + ". Kindly process the existed loan.";
	                                //var stage= tempArray[tempArray.length - 1].currentStage;
	                                if (!apz.isNull(custFetchLoanAppRes.applnWfDefinitionList)) {
	                                    currentStage = custFetchLoanAppRes.applnWfDefinitionList[0].fromStageId;
	                                    isexsitingApp = true;
	                                }
	                                if (apz.isNull(custFetchLoanAppRes.applnWfDefinitionList) && apz.isNull(custFetchLoanAppRes.cbResponse)) {
	                                    if (!isPendingRPC) {
	                                        currentStage = 'DRAFT';
	                                        isexsitingApp = false;
	                                    }
	                                } else if (apz.isNull(custFetchLoanAppRes.applnWfDefinitionList) && !apz.isNull(custFetchLoanAppRes
	                                        .cbResponse)) {
	                                    var CBRespayload = JSON.parse(custFetchLoanAppRes.cbResponse.resPayload)
	                                    if (custFetchLoanAppRes.cbResponse.cbCheckstatus == 'SUCCESS') {
	                                        currentStage = 'DRAFTCB';
	                                        isexsitingApp = true;
	                                    } else if (custFetchLoanAppRes.cbResponse.cbCheckstatus == 'REJECTED') {
	                                        currentStage = 'PENDINGCB';
	                                    } else if (custFetchLoanAppRes.cbResponse.cbCheckstatus == 'FAILURE') {
	                                        if (CBRespayload.IRIS_message == 'SUCCESS' || CBRespayload.IRIS_message == 'Success' || CBRespayload
	                                            .IRIS_message == 'success' ||CBRespayload.IRIS_message == 'bureau_data_issue_spouse_node_corrected_success') {
	                                            currentStage = 'CRTPENDING';
	                                            isexsitingApp = true;
	                                        } else if (CBRespayload.IRIS_message == 'NULL' || CBRespayload.IRIS_message == 'Null' || CBRespayload
	                                            .IRIS_message == 'null') {
	                                            currentStage = 'PENDINGCB';
	                                        } else {
	                                            currentStage = 'PENDINGCB';
	                                        }
	                                    }
	                                }
	                                window.currentMsg = "Loan application of " + loanArray[0].productDtls.description + " of amount " +
	                                    selectedAppList[selectedAppList.length - 1].amount + " already existed  in " +
	                                    "Sanction/Disbursed stage" + ". Kindly process the existed loan."
	                                switch (currentStage) {
	                                    case "BMQUEUE":
	                                        window.currentMsg = "Loan application of '" + loanArray[0].productDtls.description +
	                                            "' Loan of amount " + selectedAppList[selectedAppList.length - 1].amount +
	                                            " already exist & pending for sanctioning. Kindly process the existing loan.";
	                                        break;
	                                    case "SANCTIONED":
	                                        window.currentMsg = "Loan application of '" + loanArray[0].productDtls.description +
	                                            "' Loan of amount " + selectedAppList[selectedAppList.length - 1].amount +
	                                            " already exist & pending for disbursement initiation. Kindly process the existing loan.";
	                                        break;
	                                    case "DISBURSEMENT":
	                                        window.currentMsg = "Loan application of '" + loanArray[0].productDtls.description +
	                                            "' Loan of amount " + selectedAppList[selectedAppList.length - 1].amount +
	                                            " already exist & pending for disbursement approval. Kindly process the existing loan.";
	                                        break;
	                                    case "DRAFT":
	                                        window.currentMsg = "Application exists in Draft stage";
	                                        break;
	                                    case "DRAFTCB":
	                                        window.currentMsg = "Application exists in Draft stage";
	                                        break;
	                                    case "CRTPENDING":
	                                        window.currentMsg = "Loan application of '" + loanArray[0].productDtls.description +
	                                            "' Loan of amount " + selectedAppList[selectedAppList.length - 1].amount +
	                                            " already exist & currently in CRT review stage. Kindly process the existing loan";
	                                        break;
	                                    case "ON HOLD":
	                                        window.currentMsg = "Loan application of " + loanArray[0].productDtls.description +
	                                            "' Loan of amount " + selectedAppList[selectedAppList.length - 1].amount +
	                                            " already exist. Earning member details are kept On-hold by RPC. Kindly resolve RPC query.";
	                                        break;
	                                    case "PENDINGBYRPC":
	                                        window.currentMsg = "Loan application of '" + loanArray[0].productDtls.description +
	                                            " Loan of amount " + selectedAppList[selectedAppList.length - 1].amount +
	                                            " already exist. Earning member verification pending at RPC maker stage.";
	                                        break;
	                                    case "PENDINGCB":
	                                        window.currentMsg = "Loan application of '" + loanArray[0].productDtls.description +
	                                            " Loan of amount " + selectedAppList[selectedAppList.length - 1].amount +
	                                            " already submitted for CB verification & waiting for response";
	                                        break;
	                                    case "MOVE TO CHECKER":
	                                        window.currentMsg = "Loan application of '" + loanArray[0].productDtls.description +
	                                            "' Loan of amount " + selectedAppList[selectedAppList.length - 1].amount +
	                                            " already existed. Earning member verification pending at RPC checker stage";
	                                        break;
	                                    default:
	                                        window.currentMsg = "Loan application of '" + loanArray[0].productDtls.description + "' of amount " +
	                                            selectedAppList[selectedAppList.length - 1].amount + " already existed  in " +
	                                            "Sanction/Disbursed stage" + ". Kindly process the existed loan.";
	                                        break;
	                                }
	                                //ApzCOB.fnDisplayMsg(msgBuild, "E");
	                                if (viewCustomer) {
	                                    KendraLoans.custFetchLoanAppRes = custFetchLoanAppRes;
	                                    var obj = "";
	                                    if (window.isViewCustFromDisbursemet) {
	                                        obj = selectedDataFromLoanDisbursementList;
	                                    } else if (isKendraDtlsToCustomerDtls) {
	                                        isKendraDtlsToCustomerDtls = false
	                                        obj = {
	                                            'scr': apz.childScr,
	                                            'childScrId': apz.currAppId
	                                        }
	                                    } else {
	                                        obj = selectedDataFromDashboardSearch;
	                                    }
	                                    KendraApp.selectedCustomer.selectedApp = selectedAppList[selectedAppList.length - 1];
	                                    ApzCOB.launchMicroApp("Custom", "CustomerDetails", "APZCBO__BaseScreens__BaseDIV", obj);
	                                } else {
	                                    if (currentStage == "DRAFT") {
	                                       // ApzCOB.rejectRequest("INPUT");
	                                    } else if (currentStage == "DRAFTCB") {
	                                       // ApzCOB.rejectRequest("CBSuccess");
	                                    } else {
	                                        ApzCOB.fnDisplayMsg(window.currentMsg, "E");
	                                        apz.stopLoader();
	                                    }
	                                }
	                                } else {
	                                    apz.app.NewLoanApplication.selectLoanContinueFn();
	                                }
	                            //apz.app.NewLoanApplication.selectLoanContinueFn();
	                        }
	                    } else {
	                        apz.stopLoader();
	                        ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                    }
	                } else {
	                    apz.stopLoader();
	                    ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                }
	            } catch (e) {
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	            }
	        },
	        localDateFormat: function(serverDate) {
	            var dt = new Date(Date.parse(serverDate));
	            var localDate = dt;
	            var gmt = localDate;
	            var min = gmt.getTime() / 1000 / 60; // convert gmt date to minutes
	            var localNow = new Date().getTimezoneOffset(); // get the timezone
	            var localTime = min - localNow; // get the local time
	            var dateStr = new Date(localTime * 1000 * 60);
	            dateStr = dateStr.toString("yyyyMMddHHmmss");
	            return dateStr;
	        },
	        shuffleArr: function(array) {
	            let currentIndex = array.length;
	            while (currentIndex != 0) {
	                let randomIndex = Math.floor(Math.random() * currentIndex);
	                currentIndex--;
	                [array[currentIndex], array[randomIndex]] = [
	                    array[randomIndex], array[currentIndex]
	                ];
	            }
	        },
	        updateKendraResponse: function() {
	            var req = {
	                "apiRequest": {
	                    "interfaceName": "KendraAssignmentFetch",
	                    "appId": gAppId,
	                    "userId": LoggedInUserDetails.userID,
	                    "requestObj": {
	                        "branchId": LoggedInUserDetails.loginResponse.addInfo2
	                    }
	                }
	            }
	            apz.startLoader();
	            ApzCOB.serverBuildParam(gAppId, "KendraAssignmentFetch", "N", "N", req, true, ApzCOB.updateKendraResponseCB);
	        },
	        updateKendraResponseCB: function(params) {
	            try {
	                if (params.status && apz.isNull(params.errors)) {
	                    if (params.res.APZCBO__KendraAssignmentFetch_Res.apiResponse.ResponseHeader.hasOwnProperty("ResponseCode")) {
	                        if (params.res.APZCBO__KendraAssignmentFetch_Res.apiResponse.ResponseHeader.ResponseCode === "0") {
	                            let allRes = params.res.APZCBO__KendraAssignmentFetch_Res.apiResponse.ResponseBody.responseObj;
	                            let allocationHistoryRec = JSON.parse(allRes);
	                            let tempData = allocationHistoryRec.filter((d) => d.assignmentType === "Temporary");
	                            let tempTodayRec = tempData.filter(d => ApzCOB.isTodayInRange(d.startDate, d.endDate));
	                            tempTodayRec.forEach((temp) => {
	                                window.KendraApp.KendraResponse.forEach((kendra, i) => {
	                                    if (kendra.kendraDtls.kendraId == temp.kendraId && temp.kmId && temp.kmName) {
	                                        kendra.kendraDtls.kmId = temp.kmId;
	                                        kendra.kendraDtls.kmName = temp.kmName;
	                                    }
	                                });
	                            });
	                            ApzCOB.customlogincallback();
	                        }
	                    }
	                }
	            } catch (e) {
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	            }
	        },
	        isTodayInRange: function(startDate, endDate) {
	            let today = new Date();
	            let start = new Date(startDate);
	            let end = new Date(endDate);
	            start.setHours(0, 0, 0, 0);
	            end.setHours(23, 59, 59, 999);
	            return today >= start && today <= end;
	        },
	        functionTocompareValues: function(prevValue, currValue) {
	            if (typeof prevValue !== typeof currValue) {
	                return false;
	            }
	            if (typeof prevValue === 'object') {
	                const keys1 = Object.keys(prevValue);
	                const keys2 = Object.keys(currValue);
	                if (keys1.length !== keys2.length) {
	                    return false;
	                }
	                for (const key of keys1) {
	                    if (!ApzCOB.functionTocompareValues(prevValue[key], currValue[key])) {
	                        return false;
	                    }
	                }
	                return true;
	            }
	            if (Array.isArray(prevValue)) {
	                if (prevValue.length !== currValue.length) {
	                    return false;
	                }
	                for (let i = 0; i < prevValue.length; i++) {
	                    if (!ApzCOB.functionTocompareValues(prevValue[i], currValue[i])) {
	                        return false;
	                    }
	                }
	                return true;
	            }
	            return prevValue === currValue;
	        },
	        toogleConformationModel: function(message, proceedBtnFun) {
	            ApzCOB.toggleModal(BaseScrId + 'confirmationModel');
	            apz.setElmValue(BaseScrId + "confirmationMessageTxt", message);
	            let btn = document.getElementById(BaseScrId + 'conformationPrceedBtn_li');
	            const proceedFunction = getFunctionFromString(proceedBtnFun);
	            btn.replaceWith(btn.cloneNode(true));
	            btn = document.getElementById(BaseScrId + 'conformationPrceedBtn_li');
	            if (proceedFunction) {
	                btn.addEventListener('click', proceedFunction);
	            }

	            function getFunctionFromString(funcString) {
	                try {
	                    return funcString.split('.').reduce((obj, key) => obj[key], window);
	                } catch (e) {
	                    return null;
	                }
	            }
	        },
	        customerDetNavigationFunc: function(params) {
	            let data;
	            let selectedCustDet = params;
	            let custD;
	            for (let i = 0; i < KendraApp.KendraResponse.length; i++) {
	                if (KendraApp.KendraResponse[i].kendraDtls.customerDtls) {
	                    for (let j = 0; j < KendraApp.KendraResponse[i].kendraDtls.customerDtls.length; j++) {
	                        let kendraCustData = KendraApp.KendraResponse[i].kendraDtls.customerDtls[j];
	                        if (kendraCustData.customerId == selectedCustDet.selCustId) {
	                            data = kendraCustData;
	                        }
	                    }
	                }
	            }
	            if (window.currentUserRole === 'DEO' && (viewCustomerFlagGroupsData === true || viewCustomerFlagKmdashboard=== true || viewCustomerFlag === true || apz.childScr === 'MarkAttendance' ||apz.childScr === 'TodaysDueData' ||apz.childScr === 'ParCollectionDetails')){
					 if (viewCustomerFlagGroupsData === true) { 
	                    custD = KendraApp.selectedKendra.customerDtls.find(obj => obj.customerId === params.customerDet.id);
	                    KendraApp.selectedCustomer = custD;
	                    viewCustomerFlagGroupsData = false;
	                    ApzCOB.launchMicroApp('Custom', 'CustomerDetails', selectedCustDet.screenId + selectedCustDet.baseDiv, selectedCustDet);
	                } else if (viewCustomerFlagKmdashboard === true) {
	                    custD = KendraApp.selectedKendra.customerDtls.find(obj => obj.customerId === params.selCustId);
	                    KendraApp.selectedCustomer = custD;
	                    viewCustomerFlagKmdashboard = false;
	                    ApzCOB.launchMicroApp('Custom', 'CustomerDetails', selectedCustDet.screenId + selectedCustDet.baseDiv, selectedCustDet);
	                } else if((apz.childScr ==='ViewKendraDetails') && (viewCustomerFlag=== true)){
	                    custD = KendraApp.selectedKendra.customerDtls.find(obj => obj.customerId === params.selCustId);
	                    KendraApp.selectedCustomer = custD;
	                    viewCustomerFlag = false;
	                    ApzCOB.launchMicroApp('Custom', 'CustomerDetails', selectedCustDet.screenId + selectedCustDet.baseDiv, selectedCustDet);
	                }else if(apz.childScr === 'MarkAttendance'){
						custD = KendraApp.selectedKendra.customerDtls.find(obj => obj.customerId === params.selCustId);
	                    KendraApp.selectedCustomer = custD;
	                    ApzCOB.launchMicroApp('Custom', 'CustomerDetails', selectedCustDet.screenId + selectedCustDet.baseDiv, selectedCustDet);
					}
					else if(apz.childScr === 'TodaysDueData' ||apz.childScr === 'ParCollectionDetails' ){
						custD = KendraApp.selectedKendra.customerDtls.find(obj => obj.customerId === params.selCustId);
	                    KendraApp.selectedCustomer = custD;
						custom = false;
	                    ApzCOB.launchMicroApp('Custom', 'CustomerDetails', selectedCustDet.screenId + selectedCustDet.baseDiv, selectedCustDet);
					}
	            } else {
	                if ((apz.isNull(data) || data === undefined) && apz.childScr === "ViewKendraDetails") {
	                    ApzCOB.fetchCustDetailsDeo(params.kendraId);
	                } else {
	                    KendraApp.selectedCustomer = data;
	                    ApzCOB.launchMicroApp('Custom', 'CustomerDetails', selectedCustDet.screenId + selectedCustDet.baseDiv, selectedCustDet);
	                }
	            }
	            switch (params.scr) {
	                case 'GroupsData':
	                    // ApzCOB.launchMicroApp('Custom', 'CustomerDetails', grpDataScrId + 'groupDataBaseDiv', selectedCustDet);
	                    document.getElementById(grpDataScrId + "row_groupsHeader").classList.add('sno');
	                    document.getElementById(grpDataScrId + "row_gorupsDataRow").classList.add('sno');
	                    document.getElementById(grpDataScrId + "groupDataDiv").classList.add('sno');
	                    document.getElementById(grpDataScrId + "row_footerDiv").classList.add('sno');
	                    $("#" + kmDashScrId + 'calculatorIcon').addClass('sno');
	                    break;
	                case 'ViewKendraDetails':
	                    $("#" + ViewKendraScrId + "viewKDetails").addClass('sno');
	                    $("#" + ViewKendraScrId + "viewKheaderRow").addClass('sno');
	                    break;
	                case 'TodaysDueData':
	                    $("#" + TodayDueDataScreenId + "todayDueDetRow").addClass('sno');
	                    $("#" + TodayDueDataScreenId + "todayDueHeaderRow").addClass('sno');
	                    break;
	                case 'ParCollectionDetails':
	                    $("#" + ParCollectScreenId + "parColHeaderRow").addClass('sno');
	                    $("#" + ParCollectScreenId + "parColDetRow").addClass('sno');
	                    break;
	                case 'MarkAttendance':
	                    $("#" + MarkAttendance + "attendance_row").addClass("sno");
	                    $("#" + MarkAttendance + "success_screen").addClass("sno");
	                    break;
	                case 'KMDashboard':
	                    $("#" + kmDashScrId + 'calculatorIcon').addClass('sno');
	                    break;
	                case 'DeathIntimationPendingList':
	                    $("#" + deathIntPenScrId + "deathIntPendingHeader").addClass('sno');
	                    $("#" + deathIntPenScrId + "fabKendraDiv").addClass('sno');
	                    $("#" + deathIntPenScrId + "deathIntimationPendingListHeader").addClass('sno');
	                    break;
	                case 'RepeatCollScreen':
	                    $("#" + RepeatCollScreenId + "repeatColHeader").addClass('sno');
	                    $("#" + RepeatCollScreenId + "repeatColDetails").addClass('sno');
	                    break;
	                case 'RepeatCollection':
	                    //do nothing
	                    break;
	                case 'NonMeetingDayColl':
	                    if (params.nonMetFlow === 'listCust') {
	                        document.getElementById(nonMetColScrId + 'custDetails').classList.add('sno');
	                    } else {
	                        // document.getElementById(grpDataScrId + 'row_groupsHeader').classList.add('sno');
	                        // document.getElementById(grpDataScrId + 'row_gorupsDataRow').classList.add('sno');
	                        // document.getElementById(grpDataScrId + 'row_footerDiv').classList.add('sno');
	                        document.getElementById(nonMetColScrId + "row_gorupsDataRow").classList.add("sno");
	                        document.getElementById(nonMetColScrId + 'row_groupsHeader').classList.add('sno');
	                        document.getElementById(nonMetColScrId + 'launchNextScrDiv').classList.add('sno');
	                    }
	                    break;
	                case 'kenSuccessScreen':
	                    $("#" + kenMetSucScrId + "succScrMainDiv").addClass("sno");
	                    break;
	                default:
	                    //do nothing
	                    break;
	            }
	        },
	        fetchDeathIntimationBMDetails: function(params) {
	            fetchKendraRecFlow = params;
	            var req = {
	                "apiRequest": {
	                    "appId": gAppId,
	                    "interfaceName": "FetchDeathIntimation",
	                    "userId": LoggedInUserDetails.userID,
	                    "requestObj": {
	                        "kmUserRole": window.userRole,
	                        "branchId": window.userRole === 'BM' ? LoggedInUserDetails.loginResponse.addInfo2 : ''
	                    }
	                }
	            }
	            apz.startLoader();
	            ApzCOB.serverBuildParam(gAppId, 'FetchDeathIntimationReq', 'N', 'N', req, 'Y', ApzCOB.fetchDeathIntimationBMDetailsCB);
	        },
	        fetchDeathIntimationBMDetailsCB: function(params) {
	            try {
	                if (params.status && apz.isNull(params.errors)) {
	                    if (params.res.APZCBO__FetchDeathIntimationReq_Res.apiResponse.ResponseHeader.hasOwnProperty("ResponseCode")) {
	                        let response = params.res.APZCBO__FetchDeathIntimationReq_Res.apiResponse;
	                        if (response.ResponseHeader.ResponseCode === '0') {
	                            if (!apz.isNull(response.ResponseBody.responseObj)) {
	                                window.deathIntimationInitatedRec = JSON.parse(response.ResponseBody.responseObj);
	                                // ApzCOB.filterOutDeceasedCustomers();
	                            } else {
	                                apz.stopLoader();
	                                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E", ApzCOB
	                                .dashboardAppListAPI);
	                            }
	                        } else if (response.ResponseHeader.ResponseCode === 'NR100') {
	                            window.deathIntimationInitatedRec = [];
	                            apz.stopLoader();
	                        }
	                    }
	                    if (fetchKendraRecFlow === 'approvalSuccessScr') {
	                        if (apz.childScr === "MarkAttendance") {
	                            apz.app.MarkAttendance.loadGroupsData(selectedKenId);
	                            apz.app.MarkAttendance.iconMap();
	                            apz.app.MarkAttendance.findRowNoUsingKendraId(selectedKenId);
	                        }
	                        //apz.app.MarkAttendance.markAbentForDeathIntimationRec();
	                        apz.stopLoader();
	                    }
	                } else {
	                    apz.stopLoader();
	                    ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E", ApzCOB.dashboardAppListAPI);
	                }
	            } catch (error) {
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E", ApzCOB.dashboardAppListAPI);
	            }
	        },
	        getCurrentTimestamp: function() {
	            const now = new Date();
	            const day = String(now.getDate()).padStart(2, '0');
	            const month = String(now.getMonth() + 1).padStart(2, '0'); // Months are 0-based
	            const year = now.getFullYear();
	            let hours = String(now.getHours()).padStart(2, '0');
	            const minutes = String(now.getMinutes()).padStart(2, '0');
	            const ampm = hours >= 12 ? 'PM' : 'AM';
	            hours = hours % 12;
	            hours = hours ? String(hours).padStart(2, '0') : '12';
	            return `${hours}:${minutes} ${ampm}`;
	        },
	        rejectRequest: function(stage) {
	            window.CRTworkflow = {
	                "currentRole": "KM",
	                "action": "REJECT",
	                "workflowId": "LOANINPUT",
	                "stage": "CBCHECK",
	                "remarks": stage
	            }
	            var applicationDetails = [];
	            applicationDetails.push({
	                "applicationId": selectedAppList[selectedAppList.length - 1].applicationId,
	                "versionNum": selectedAppList[selectedAppList.length - 1].versionNo
	            });
	            var req = {
	                "apiRequest": {
	                    "appId": gAppId,
	                    "interfaceName": "KMActionPostCBCheck",
	                    "requestObj": {
	                        "workflow": window.CRTworkflow,
	                        "createdBy": LoggedInUserDetails.userID,
	                        "applicationId": "",
	                        "applicationStatus": 'Move to BM',
	                        "appId": gAppId,
	                        "cbApproveManual": "N",
	                        "versionNum": "",
	                        "applicationDetailList": applicationDetails
	                    }
	                }
	            }
	            if (apz.deviceType !== 'WEB') {
	                apz.app.BaseScreens.UEstartTimer("WorkflowUpdate", req);
	                apz.app.BaseScreens.UElogevent("WorkflowUpdate", req);
	            }
	            ApzCOB.serverBuildParam(gAppId, 'KMActionPostCBCheck', 'N', 'N', req, 'Y', ApzCOB.rejectRequestCB);
	        },
	        rejectRequestCB: function(params) {
	            if (apz.deviceType !== 'WEB') {
	                apz.app.BaseScreens.UEstopTimer("WorkflowUpdate ", params.req);
	            }
	            if (ApzCOB.handleServiceCallBacks(params)) {
	                if (params.res.APZCBO__KMActionPostCBCheck_Res.apiResponse.ResponseHeader.ResponseCode == "0") {
	                    apz.app.NewLoanApplication.selectLoanContinueFn();
	                } else {
	                    apz.stopLoader();
	                    ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                }
	            } else {
	                apz.stopLoader();
	                ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	            }
	            apz.stopLoader();
	        },
	        FetchCustomerDetails: function(custID) {
	            KendraApp.updatedCustomer={};
	            isBankDetailsUpdated=false;
	            var req = {
	                "apiRequest": {
	                    "interfaceName": "FetchCustomerDetails",
	                    "requestObj": {
	                        "customerId": custID	                        
	                    }
	                }
	            }
	            apz.startLoader();
	            ApzCOB.serverBuildParam(gAppId, 'FetchCustomerDetails', 'N', 'N', req, 'Y', ApzCOB.FetchCustomerDetailsCB);
	        },
	        FetchCustomerDetailsCB: function(params) {
	            try {
	                if (ApzCOB.handleServiceCallBacks(params)) {
	                    if (params.res.APZCBO__FetchCustomerDetails_Res.apiResponse.ResponseHeader.ResponseCode == "0") {
	                        console.log('FetchCustomer', params);
	                        var cusDet = params.res.APZCBO__FetchCustomerDetails_Res.apiResponse.ResponseBody.responseObj[0].kendraDtls.customerDtls[0];
	                        KendraApp.updatedCustomer=cusDet;
	                        if (KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.bankDtls.bankAccNo !== cusDet.bankAccNo ||KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.bankDtls.bankIfscCode !== cusDet.bankIfscCode) {
	                            isBankDetailsUpdated = true;
	                            KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.bankDtls.bankAccName = cusDet.bankAccName;
	                            KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.bankDtls.bankAccNo = cusDet.bankAccNo;
	                            KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.bankDtls.bankBranchName = cusDet.bankBranchName;
	                            KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.bankDtls.bankIfscCode = cusDet.bankIfscCode;
	                            KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.bankDtls.bankName = cusDet.bankName;
	                        }
	                        if (KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.mobileNum != cusDet.mobileNum) {
	                            KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.mobileNum = cusDet.mobileNum;
	                            KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.kycDtls.mobileNum = cusDet.mobileNum;
	                            isBankDetailsUpdated = true;
	                        }
	                    } else {
	                        //apz.stopLoader();
	                        //ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                    }
	                } else {
	                    //apz.stopLoader();
	                    // ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
	                }
	                // apz.stopLoader();
	            } catch (e) {
	                //apz.stopLoader();
	                //ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_INVALID_REPORT_MSG"), "E");
	            }
		    //hyperLink changes
		    if (window.isViewCustFromDisbursemet) {
		        viewDisbursemetCustData = cusDet
		        KendraApp.selectedCustomer = cusDet
		        ApzCOB.fetchCustomerIdDetails(KendraApp.selectedCustomer.customerId);
		        //ApzCOB.launchMicroApp("Custom", "CustomerDetails", "APZCBO__BaseScreens__BaseDIV", selectedDataFromLoanDisbursementList);
		    } else if (window.KendraLoans.scr !== 'CRTdtls') {
		         try {
		             var cbResponse = JSON.parse(window.KendraLoans.custFetchLoanAppRes.cbResponse.resPayload);
		             var addinfo = window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].addInfo;
		             if (typeof addinfo == 'string') {
		                 addinfo = JSON.parse(addinfo)
		             }
		             const iscbUpdated = window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.iscbUpdated;
		             
		             if (addinfo.isAmountUpdate == true) {
		                 ApzCOB.setLoanDetailswithFees(cbResponse);
		             } else if (addinfo.isApprovedCRT) {
		                 if (iscbUpdated === true || iscbUpdated === "true") {
		                     ApzCOB.launchLoanScreen();
		                 } else {
		                     ApzCOB.loanCBCRTCheck();
		                 }
		             } else {
		                 if(addinfo.isAmountUpdate == true){
		                     ApzCOB.setLoanDetailswithFees(cbResponse);
		                 }else if (iscbUpdated === true || iscbUpdated === "true") {
		                     if ((window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.GST == cbResponse.GST && window
		                             .KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.loanProcessingFee == cbResponse
		                             .Processing_fees_without_GST)) {
		                         ApzCOB.launchLoanScreen();
		                     } else {
		                         ApzCOB.setLoanDetailswithFees(cbResponse);
		                     }
		                    // ApzCOB.launchLoanScreen();
		                 }else {
		                     ApzCOB.setLoanDetailswithFees(cbResponse);
		                 }
		             }
		         } catch (e) {
		             apz.stopLoader();
		             ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
		         }
	            } else {
	                ApzCOB.launchLoanScreen();
	            }
	        },
	        FetchOtherKendraDtls: function(pKmId) {
                var req = {
                    "apiRequest": {
                        "interfaceName": "FetchKendraDetails",
                        "requestObj": {
                            "KendraUserId": pKmId
                        }
                    }
                }
                apz.startLoader();
                ApzCOB.serverBuildParam(gAppId, 'FetchKendraDetails', 'N', 'N', req, 'Y', ApzCOB.FetchOtherKendraDtlsCB);
            },
            FetchOtherKendraDtlsCB: function(params) {
                if (ApzCOB.handleServiceCallBacks(params)) {
                    apz.stopLoader();
                    if (!apz.isNull(params.res.APZCBO__FetchKendraDetails_Res.apiResponse.ResponseBody.responseObj)) {
                        var kendraRes = params.res.APZCBO__FetchKendraDetails_Res.apiResponse.ResponseBody.responseObj;
                        if (!apz.isNull(kendraRes) && kendraRes.length > 0) {
                            window.KendraApp.KendraResponse = window.KendraApp.KendraResponse.concat(kendraRes);
                        }
                        apz.app.ViewKendraDetails.paintDetails();
                    }
                } else {
                    apz.stopLoader();
                }
            },
            //added below function for handling Cashier login in WEB if userRole has KM and Cashier as well
            assignUserRoleAsCashier: function() {
                if(!apz.isNull(isCashierRoleAvailable)) {
                    if ((isCashierRoleAvailable.includes('Cashier') || isCashierRoleAvailable.includes('CASHIER')) && isCashierRoleAvailable.includes('KM')) {
                        window.userRole = "CASHIER";
                    }
                }
            },
            FetchUserList: function() {
                    var req = {
                        "apiRequest": {
                            "interfaceName": "FetchUserList",
                            "appId": gAppId,
                            "userId": LoggedInUserDetails.userID,
                            "requestObj": {
                                "branchId": LoggedInUserDetails.loginResponse.addInfo2
                            }
                        }
                    }
                    ApzCOB.serverBuildParam(gAppId, "FetchUserList", "N", "N", req, false, ApzCOB.FetchUserListCB);
            }, FetchUserListCB: function(params) {
                window.KendraApp.userList = [];
                try {
                    if (ApzCOB.handleServiceCallBacks(params)) {
                        if (!apz.isNull(params.res.APZCBO__FetchUserList_Res.apiResponse.ResponseBody.responseObj)) {
                            data = JSON.parse(params.res.APZCBO__FetchUserList_Res.apiResponse.ResponseBody.responseObj).usersDetails;
                            window.KendraApp.userList = data;
                        } else {
                            ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
                        }
                    } else {
                        ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
                    }
                } catch (e) {
                    ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
                }
                /*if (window.KendraApp.userListEmpty) {
                    apz.stopLoader();
                    if (window.KendraApp.userList.length == 0) {
                        //ApzCOB.fnDisplayMsg('No user Found', "E");
                    } else {
                        if (userRole === 'KM') {
                            if (window.KendraApp.userListid === 'APZCBO__BaseScreens__myActivity') {
                                $('#Dashbo__dashboard__gr_row_29').removeClass('sno');
                                $('#APZCBO__BaseScreens__sc_col_199').addClass('active');
                                $('#APZCBO__BaseScreens__sc_col_201').removeClass('active');
                                window.myKendraFlow = false;
                                $('#Dashbo__dashboard__DropDIV').removeClass('sno');
                                $('#Dashbo__dashboard__KMkendra').addClass('sno');
                            } else if (window.KendraApp.userListid === 'APZCBO__BaseScreens__myKendra') {
                                $('#APZCBO__BaseScreens__sc_col_201').addClass('active');
                                $('#APZCBO__BaseScreens__sc_col_199').removeClass('active');
                                window.myKendraFlow = true;
                                $('#Dashbo__dashboard__DropDIV').addClass('sno');
                                $('#Dashbo__dashboard__KMkendra').removeClass('sno');
                                apz.app.Dashboard.kendraDetails();
                            }else if (window.KendraApp.userListid === 'Dashbo__dashboard__myActivityBm' || window.KendraApp.userListid === 'Dashbo__dashboard__el_icn_18') {
                                $('#Dashbo__dashboard__gr_row_78').addClass('sno');
                                $('#Dashbo__dashboard__activeColKendra').removeClass('active');
                                $('#Dashbo__dashboard__activeColActivity').addClass('active');
                                window.myKendraFlow = false;
                                $('#Dashbo__dashboard__BMkendra').addClass('sno');
                                $('#Dashbo__dashboard__gr_row_29').removeClass('sno');
                                $('#Dashbo__dashboard__DropDIV').removeClass('sno');
                                // apz.app.Dashboard.kendraDetails();
                            } else if (window.KendraApp.userListid === 'Dashbo__dashboard__myKendraBm' || window.KendraApp.userListid === 'Dashbo__dashboard__el_icn_19') {
                                $('#Dashbo__dashboard__gr_row_78').removeClass('sno');
                                $("#Dashbo__dashboard__pl_pnl_113_div").addClass("sno");
                                $('#Dashbo__dashboard__activeColActivity').removeClass('active');
                                $('#Dashbo__dashboard__activeColKendra').addClass('active');
                                window.myKendraFlow = true;
                                $('#Dashbo__dashboard__DropDIV').addClass('sno');
                                $('#Dashbo__dashboard__BMkendra').removeClass('sno');
                                $("#" + DashboardScrId + 'LocCaptureSuccessRow').addClass('sno');
                                apz.app.Dashboard.kendraDetails();
                            }
                        } else if (userRole === 'BM') {
                            if (window.KendraApp.userListid === 'APZCBO__BaseScreens__myActivity') {
                                $('#APZCBO__BaseScreens__sc_col_199').addClass('active');
                                $('#APZCBO__BaseScreens__sc_col_201').removeClass('active');
                                window.myKendraFlow = false;
                                $('#Dashbo__dashboard__DropDIV').removeClass('sno');
                                $('#Dashbo__dashboard__BMkendra').addClass('sno');
                                $('#Dashbo__dashboard__gr_row_29').removeClass('sno');
                                apz.app.Dashboard.showDeathIntPendingRecordForMb();
                            } else if (window.KendraApp.userListid === 'APZCBO__BaseScreens__myKendra') {
                                $("#" + 'Dashbo__dashboard__bmActivityRow').addClass('sno');
                                $('#APZCBO__BaseScreens__sc_col_201').addClass('active');
                                $('#APZCBO__BaseScreens__sc_col_199').removeClass('active');
                                window.myKendraFlow = true;
                                $('#Dashbo__dashboard__DropDIV').addClass('sno');
                                $('#Dashbo__dashboard__BMkendra').removeClass('sno');
                                apz.app.Dashboard.kendraDetails();
                            } else if (window.KendraApp.userListid === 'Dashbo__dashboard__myActivityBm' || window.KendraApp.userListid === 'Dashbo__dashboard__el_icn_18') {
                                $('#Dashbo__dashboard__gr_row_78').addClass('sno');
                                $('#Dashbo__dashboard__activeColKendra').removeClass('active');
                                $('#Dashbo__dashboard__activeColActivity').addClass('active');
                                window.myKendraFlow = false;
                                $('#Dashbo__dashboard__BMkendra').addClass('sno');
                                $('#Dashbo__dashboard__gr_row_29').removeClass('sno');
                                $('#Dashbo__dashboard__DropDIV').removeClass('sno');
                                // apz.app.Dashboard.kendraDetails();
                            } else if (window.KendraApp.userListid === 'Dashbo__dashboard__myKendraBm' || window.KendraApp.userListid === 'Dashbo__dashboard__el_icn_19') {
                                $('#Dashbo__dashboard__gr_row_78').removeClass('sno');
                                $("#Dashbo__dashboard__pl_pnl_113_div").addClass("sno");
                                $('#Dashbo__dashboard__activeColActivity').removeClass('active');
                                $('#Dashbo__dashboard__activeColKendra').addClass('active');
                                window.myKendraFlow = true;
                                $('#Dashbo__dashboard__DropDIV').addClass('sno');
                                $('#Dashbo__dashboard__BMkendra').removeClass('sno');
                                $("#" + DashboardScrId + 'LocCaptureSuccessRow').addClass('sno');
                                apz.app.Dashboard.kendraDetails();
                            }
                        }
                    }
                }*/
            }, fetchApprovallevel: function(lappl) {
                var addinfo = lappl.addInfo;
                if (typeof addinfo == 'string') {
                    addinfo = JSON.parse(addinfo)
                }
                var finallnOutstandingAmt=0;
                if (!apz.isNull(addinfo.lnOutstandingAmt)) {
                    finallnOutstandingAmt = parseFloat(addinfo.lnOutstandingAmt) || 0;
                }
                finallnOutstandingAmt = parseFloat(finallnOutstandingAmt).toFixed(2);
                // Use parseFloat again when adding
                KendraApp.selectedapprovalMatrixAmt = parseFloat(finallnOutstandingAmt) + parseFloat(lappl.amount);
                return approvalMatrix.APPROVALMATRIX.find(obj => KendraApp.selectedapprovalMatrixAmt >= parseFloat(obj.MinAmt) && KendraApp
                    .selectedapprovalMatrixAmt <= parseFloat(obj.MaxAmt))
            }, loanCBCRTCheck: function() {
                apz.startLoader();
                var req = {
                    "apiRequest": {
                        "appId": gAppId,
                        "interfaceName": "loanCBCheck",
                        "userId": LoggedInUserDetails.userID,
                        "requestObj": {
                            "applicationId": KendraLoans.custFetchLoanAppRes.applicationdtls[0].applicationId,
                            "versionNo": KendraLoans.custFetchLoanAppRes.applicationdtls[0].versionNo,
                            "crtFlag": true,
                            "schedulerEnabled": "",
                            "custDtlId": KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerId
                        }
                    }
                }
                //req.apiRequest.requestObj.cbRecheck='Y';
                req.apiRequest.requestObj.cbRecheck='Y';
	            req.apiRequest.requestObj.userRole = currentUserRole;
	            req.apiRequest.requestObj.appVersion = appVersion;
	            req.apiRequest.requestObj.userName = LoggedInUserDetails.loginResponse.userDet.name;
	            req.apiRequest.requestObj.userId = LoggedInUserDetails.userID;
	            req.apiRequest.requestObj.remarks = 'The Loan BRE check for fees by '+LoggedInUserDetails.userID +' ('+currentUserRole +').';
                ApzCOB.serverBuildParam(gAppId, 'loanCBCheck', 'N', 'N', req, 'Y', ApzCOB.loanCBCRTCheckCB);
            }, loanCBCRTCheckCB: function(params) {
                cbResponse = {};
                apz.stopLoader();
                if (ApzCOB.handleServiceCallBacks(params)) {
                    if (!apz.isNull(params.res.APZCBO__loanCBCheck_Res.apiResponse.ResponseBody.responseObj)) {
                        cbResponse = JSON.parse(params.res.APZCBO__loanCBCheck_Res.apiResponse.ResponseBody.responseObj);
                        var approvedAmt = 0;
                        if (!apz.isNull(cbResponse.Approved_Loan_Amount)) {
                            approvedAmt = cbResponse.Approved_Loan_Amount;
                        }
                        KendraLoans.cbResponse=cbResponse;
                        if (cbResponse.IRIS_message == 'success' || cbResponse.IRIS_message == 'SUCCESS' || cbResponse.IRIS_message ==
                            'bureau_data_issue_spouse_node_corrected_success') {
                                
                            ApzCOB.setLoanDetailswithFees(cbResponse);    
                            /*var insDet = window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.insurDtls;
                            var selProd = KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.productId;
                            var selProdArray = KendraApp.ProductResponse.filter(val => (val.productDtls.productId === selProd));
                            var selLoanProdDetails = {};
                            if (selProdArray.length > 0) {
                                selLoanProdDetails = selProdArray[0];
                            }
                            if (!apz.isNull(selLoanProdDetails.productDtls.insLnamount)) {
                                if (parseInt(selLoanProdDetails.productDtls.insLnamount) > parseInt(approvedAmt)) {
                                    if (insDet.Spouse == 'Y') {
                                        insDet.Spouse = 'N';
                                    }
                                }
                            }
                            var insurAmt = 0;
                            if (insDet.member === 'Y' && insDet.Spouse === 'Y') {
                                insurAmt = cbResponse.Insurance_Charge_Spouse + cbResponse.Insurance_Charge_Member;
                                insDet.applicant_insurance_amt = cbResponse.Insurance_Charge_Member;
                                insDet.spouse_insurance_amt = cbResponse.Insurance_Charge_Spouse;
                            } else if (insDet.member === 'Y') {
                                insurAmt = cbResponse.Insurance_Charge_Member;
                                insDet.applicant_insurance_amt = cbResponse.Insurance_Charge_Member;
                                insDet.spouse_insurance_amt = "";
                            } else if (insDet.Spouse === 'Y') {
                                insurAmt = cbResponse.Insurance_Charge_Spouse;
                                insDet.applicant_insurance_amt = "";
                                insDet.spouse_insurance_amt = cbResponse.Insurance_Charge_Spouse;
                            } else {
                                insurAmt = 0;
                                insDet.applicant_insurance_amt = "";
                                insDet.spouse_insurance_amt = "";
                            }
                            insDet.insurCharges = insurAmt;
                            window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.insurDtls = insDet;
                            var aprxloancharges = parseInt((cbResponse.GST + cbResponse.Processing_fees_without_GST));
                            var aprxloanchargeswithins = aprxloancharges + insurAmt;
                            var aprxloanamount = ((parseInt(window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].amount)) - parseInt((cbResponse.GST + cbResponse.Processing_fees_without_GST +
                                insurAmt)));
                            window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.loanAmt = cbResponse
                                .Approved_Loan_Amount;
                            window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.GST = cbResponse.GST;
                            window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.addInfo1 = aprxloanchargeswithins;
                            window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.aprxLoanCharges = aprxloancharges;
                            window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.loanProcessingFee = cbResponse
                                .Processing_fees_without_GST;
                            window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.aprxLoanAmt = aprxloanamount;
                            window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.iscbUpdated = true;
                            if (window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].productType == 'EL') {
								window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.interest_Fee = cbResponse.Interest_Fee;
								window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.upfront_Fee = cbResponse.Upfront_Fee;
							} else {
								window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.interest_Fee = "";
								window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.upfront_Fee = "";
							}
                            isBankDetailsUpdated = true;
                            ApzCOB.launchLoanScreen();*/
                        } else {
                            ApzCOB.fnDisplayMsg('The CB Service is down!', "E");
                            return;
                        }
                    } else {
                        ApzCOB.fnDisplayMsg('The CB Service is down!', "E");
                        return;
                    }
                } else {
                    ApzCOB.fnDisplayMsg('The CB Service is down!', "E");
                    return;
                }
                //apz.stopLoader();
            }, launchLoanScreen: function() {
                if (window.KendraLoans.scr == 'dashboard' || window.KendraLoans.scr == 'LoanSanction') {
                    let data = {
                        selectedCust: window.KendraLoans.selectedLoanSanctionAccnt,
                        matchingCustomer: window.KendraLoans.custFetchLoanAppRes //matchingCustomers
                    };
                    ApzCOB.launchMicroApp('LoanSa', 'DetailedScreen', 'APZCBO__BaseScreens__BaseDIV', data);
                } else if (window.KendraLoans.scr == 'dashboardDisbursement' || window.KendraLoans.scr == 'LoanDisbursementList') {
                    disbData = {
                        selectedCust: KendraApp.selectedDisbursement,
                        matchingCustomer: window.KendraLoans.custFetchLoanAppRes.applicationdtls[0] //matchingCustomers
                    };
                    ApzCOB.customerNetoffDtls(KendraLoans.custFetchLoanAppRes.applicationdtls[0].branchId, KendraLoans.custFetchLoanAppRes.applicationdtls[0]
                        .customerId);
                } else if (window.KendraLoans.scr == 'CRTdtls') {
                    let data = {
                        selectedCust: window.KendraLoans.custFetchLoanAppRes,
                        matchingCustomer: window.KendraLoans.custFetchLoanAppRes.applicationdtls[0] //matchingCustomers
                    };
                    apz.app.CrtDetails.paintCustDtls(data);
                }
            }, UpdateCRTWorkflow: function(applicatId) {
                var req = {
                    "apiRequest": {
                        "appId": gAppId,
                        "interfaceName": "UpdateCRTWorkflow",
                        "userId": LoggedInUserDetails.userID,
                        "requestObj": {
                            "applicationId": applicatId
                        }
                    }
                }
                ApzCOB.serverBuildParam(gAppId, 'UpdateCRTWorkflow', 'N', 'N', req, 'Y', ApzCOB.UpdateCRTWorkflowCB);
            },UpdateCRTWorkflowCB: function(params) {
                 console.log(params);
                 apz.stopLoader();
                 try {
                     if (!apz.isNull(params.res.APZCBO__UpdateCRTWorkflow_Res.status)) {
                         if (!apz.isNull(window.KendraLoans.selectedCust)) {
                            ApzCOB.fnDisplayMsg('Application details mismatch. Please re-enter the loan.', "E", ApzCOB.dashboardAppListAPI); 
                         }
                         var UpdateCRTWorkflow = params.res.APZCBO__UpdateCRTWorkflow_Res;
                         console.log('res', UpdateCRTWorkflow);
                     } else {
                         ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
                     }
                 } catch (e) {
                     ApzCOB.fnDisplayMsg(ApzCOB.getDescfromLitCode("LIT_COMM_ERR_TXT_TECHNICAL"), "E");
                 }
                 window.KendraLoans.selectedCust='';
                 //apz.stopLoader();
             },formatAmountInINR: function(amount) {
                 let num = parseFloat(amount);
                 if (num >= 10000000) {
                     return `â‚¹${(num / 10000000).toFixed(2)} CR`;
                 } else if (num >= 100000) {
                     return `â‚¹${(num / 100000).toFixed(2)} L`;
                 } else if (num >= 1000) {
                     return `â‚¹${(num / 1000).toFixed(2)} K`;
                 } else {
                     return `â‚¹${num.toFixed(2)}`;
                 }
             }, setLoanDetailswithFees: function(cResponse) {
                 var insDet = window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.insurDtls;
                 var selProd = KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.productId;
                 var selProdArray = KendraApp.ProductResponse.filter(val => (val.productDtls.productId === selProd));
                 var approvedAmt = 0;
                 if (!apz.isNull(cResponse.Approved_Loan_Amount)) {
                     approvedAmt = cResponse.Approved_Loan_Amount;
                 }
                 var selLoanProdDetails = {};
                 if (selProdArray.length > 0) {
                     selLoanProdDetails = selProdArray[0];
                 }
                 if (!apz.isNull(selLoanProdDetails.productDtls.insLnamount)) {
                     if (parseInt(selLoanProdDetails.productDtls.insLnamount) > parseInt(approvedAmt)) {
                         if (insDet.Spouse == 'Y') {
                             insDet.Spouse = 'N';
                         }
                     }
                 }
                 var insurAmt = 0;
                 if (insDet.member === 'Y' && insDet.Spouse === 'Y') {
                     insurAmt = cResponse.Insurance_Charge_Spouse + cResponse.Insurance_Charge_Member;
                     insDet.applicant_insurance_amt = cResponse.Insurance_Charge_Member;
                     insDet.spouse_insurance_amt = cResponse.Insurance_Charge_Spouse;
                 } else if (insDet.member === 'Y') {
                     insurAmt = cResponse.Insurance_Charge_Member;
                     insDet.applicant_insurance_amt = cResponse.Insurance_Charge_Member;
                     insDet.spouse_insurance_amt = "";
                 } else if (insDet.Spouse === 'Y') {
                     insurAmt = cResponse.Insurance_Charge_Spouse;
                     insDet.applicant_insurance_amt = "";
                     insDet.spouse_insurance_amt = cResponse.Insurance_Charge_Spouse;
                 } else {
                     insurAmt = 0;
                     insDet.applicant_insurance_amt = "";
                     insDet.spouse_insurance_amt = "";
                 }
                 insDet.insurCharges = insurAmt;
                 window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.insurDtls = insDet;
                 var aprxloancharges = parseInt((cResponse.GST + cResponse.Processing_fees_without_GST));
                 var aprxloanchargeswithins = aprxloancharges + insurAmt;
                 var aprxloanamount = ((parseInt(window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].amount)) - parseInt((cResponse.GST + cResponse
                     .Processing_fees_without_GST + insurAmt)));
                 window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.loanAmt = cResponse
                 .Approved_Loan_Amount;
                 window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.GST = cResponse.GST;
                 window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.addInfo1 = aprxloanchargeswithins;
                 window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.aprxLoanCharges = aprxloancharges;
                 window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.loanProcessingFee = cResponse
                     .Processing_fees_without_GST;
                 window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.aprxLoanAmt = aprxloanamount;
                 window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].amount=cResponse
                 .Approved_Loan_Amount;
                 window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.iscbUpdated = true;
                 if (window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].productType == 'EL') {
                     window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.interest_Fee = cResponse
                         .Interest_Fee;
                     window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.upfront_Fee = cResponse.Upfront_Fee;
                 } else {
                     window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.interest_Fee = "";
                     window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].customerDtls.loanDtls.chargeAndBreakupDtls.upfront_Fee = "";
                 }
                if (typeof window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].addInfo == 'string') {
                    window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].addInfo = JSON.parse(window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].addInfo)
                }
                window.KendraLoans.custFetchLoanAppRes.applicationdtls[0].addInfo.isAmountUpdate = false;
                 isBankDetailsUpdated = true;
                 ApzCOB.launchLoanScreen();
             },formatTime: function(str) {
                 if (!str || str.trim() === "") return 'NO DATA';
                 str = str.trim().toLowerCase();
                 // Already in AM/PM format
                 const ampmMatch = str.match(/^(\d{1,2}):?(\d{2})?\s?(am|pm)$/i);
                 if (ampmMatch) {
                     let h = parseInt(ampmMatch[1]);
                     let m = parseInt(ampmMatch[2] || "0");
                     const ampm = ampmMatch[3].toUpperCase();
                     return ApzCOB.format12Hour(h, m, ampm);
                 }
                 // Colon or dot-separated (e.g., "8:30", "7.00")
                 if (str.includes(":") || str.includes(".")) {
                     const [h, m] = str.split(/[:.]/).map(Number);
                     return ApzCOB.format12Hour(h, m);
                 }
                 // Compact format (e.g., 0830, 1045)
                 if (/^\d{3,4}$/.test(str)) {
                     const padded = str.padStart(4, "0");
                     const h = parseInt(padded.slice(0, -2), 10);
                     const m = parseInt(padded.slice(-2), 10);
                     return ApzCOB.format12Hour(h, m);
                 }
                 // Single hour like "7"
                 const hour = parseInt(str);
                 if (!isNaN(hour)) return ApzCOB.format12Hour(hour, 0);
                 return null;
             }, format12Hour: function(h, m, ampm = null) {
                 if (ampm) {
                     return `${String(h).padStart(2, "0")}:${String(m).padStart(2, "0")} ${ampm}`;
                 }
                 const suffix = h >= 12 ? "PM" : "AM";
                 const hour12 = h % 12 || 12;
                 return `${String(hour12).padStart(2, "0")}:${String(m).padStart(2, "0")} ${suffix}`;
             },calculateRemainingInstallments: function (lnValueDate, lnMatDate, frequency, todayStr = null) {
				const startDate = new Date(
					parseInt(lnValueDate.slice(0, 4)),
					parseInt(lnValueDate.slice(4, 6)) - 1,
					parseInt(lnValueDate.slice(6, 8))
				);
				const endDate = new Date(
					parseInt(lnMatDate.slice(0, 4)),
					parseInt(lnMatDate.slice(4, 6)) - 1,
					parseInt(lnMatDate.slice(6, 8))
				);
				const today = todayStr ? new Date(todayStr) : new Date();
				const freqDays = {
					WEEKLY: 7,
					BIWEEKLY: 14,
					FOURWEEKLY: 28
				};
				const intervalDays = freqDays[frequency.toUpperCase()];
				if (!intervalDays) {
					throw new Error("Invalid frequency value.");
				}
				let remainingCount = 0;
				let pointer = new Date(startDate);
				while (pointer <= endDate) {
					// FIXED LINE: includes installments scheduled for today
					if (pointer >= today) remainingCount++;
					pointer.setDate(pointer.getDate() + intervalDays);
				}
				return remainingCount;
			}
             
        }
                
